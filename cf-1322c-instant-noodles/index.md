# [CF 1322C] Instant Noodles

Wu got hungry after an intense training session, and came to a nearby store to buy his favourite instant noodles. After Wu paid for his purchase, the cashier gave him an interesting task.

You are given a bipartite graph with positive integers in all vertices of the right half. For a subset ğ‘† of vertices of the left half we define ğ‘(ğ‘†) as the set of all vertices of the right half adjacent to at least one vertex in ğ‘†, and ğ‘“(ğ‘†) as the sum of all numbers in vertices of ğ‘(ğ‘†). Find the greatest common divisor of ğ‘“(ğ‘†) for all possible non-empty subsets ğ‘† (assume that GCD of empty set is 0).

Wu is too tired after his training to solve this problem. Help him!

## åˆ†æ

è¿™é“é¢˜çš„èŒƒå›´æœ‰500000ä¹‹å¤§ï¼Œæ‰€ä»¥å®åœ¨æ˜¯æ— æ³•ä»å­é›†æœ¬èº«å…¥æ‰‹ï¼Œåªèƒ½è€ƒè™‘ä¸€ä¸‹gcdæ˜¯å¦å­˜åœ¨æ€§è´¨ã€‚

å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªå­é›†$a$ï¼Œå½“æˆ‘ä»¬ä¸ºå…¶åŠ ä¸Šä¸€ä¸ª$\Delta$åï¼Œè¿™ä¸¤ä¸ªç»“æœéƒ½ä¼šå‚ä¸gcdçš„è®¡ç®—ï¼Œæ›´ç›¸å‡æŸåè¡¨ç°ä¸º$\Delta$å‚ä¸gcdè®¡ç®—ã€‚

è¿™ä¸ª$\Delta$çš„å¢é‡ç›´æ¥è´¡çŒ®ç­”æ¡ˆçš„ç‰¹æ€§å¯èƒ½æ˜¯é‡è¦çš„ä¸€ç¯ã€‚æ¯”èµ›æ—¶å› ä¸ºæ—¶é—´ä¹Ÿå¥½ï¼Œåˆ«çš„ä¹Ÿç½¢ï¼Œè¢«å¡åœ¨è¿™è‡ªé—­ä¸ä¼šäº†ã€‚

æ¥ä¸‹æ¥ç¡®å®šå¢é‡æ˜¯ä»€ä¹ˆã€‚

æ˜¯å¦æ˜¯å•ç‹¬çš„ä¸€ä¸ªå…ƒç´ ï¼šå¯¹äºä¸€ä¸ªå³èŠ‚ç‚¹$v$ï¼Œæ˜¯å¦å­˜åœ¨æ·»åŠ ä¸€ä¸ªå·¦èŠ‚ç‚¹ååªå¢åŠ å…¶ä¸€ä¸ªçš„æƒ…å†µã€‚å¹²è„†æŠŠå…¨éƒ¨çš„å·¦èŠ‚ç‚¹å…¨éƒ¨é€‰ä¸­ï¼Œç„¶ååˆ æ‰åŒ…å«$v$çš„ã€‚æ¥ä¸‹æ¥ï¼Œè§‚å¯Ÿæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå·¦èŠ‚ç‚¹åªå¢åŠ $v$ã€‚è¿™æ˜¾ç„¶ä¼šæœ‰ä¸å­˜åœ¨çš„æƒ…å†µã€‚

åœ¨ä¸å­˜åœ¨çš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬æœ‰è¿™äº›ç»“è®ºã€‚å‡è®¾è¿™ä¸ªæ£ä¹±çš„èŠ‚ç‚¹æ˜¯$v'$

* $v'$ç”±äºåˆ é™¤æ‰€æœ‰åŒ…å«$v$çš„èŠ‚ç‚¹è€Œè¢«å…±åŒåˆ é™¤ã€‚
* $v'$æ— æ³•è¢«ä¸åŒ…å«$v$çš„å…¶ä»–èŠ‚ç‚¹å¢åŠ ï¼Œé‚£ä¹ˆèƒ½å¢åŠ $v'$çš„èŠ‚ç‚¹å®šåŒ…å«$v$ã€‚

æ­¤æ—¶æœ‰ä¸¤ç§æƒ…å†µã€‚
* æ‰€æœ‰æ·»åŠ vçš„èŠ‚ç‚¹å‡åŒ…å«$v'$ã€‚é‚£ä¹ˆäºŒè€…å…±è¿›é€€ï¼Œè¡¨ç°ä¸ºæ†ç»‘åœ¨ä¸€èµ·çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚
* å¹¶ä¸æ˜¯æ‰€æœ‰æ·»åŠ vçš„èŠ‚ç‚¹å‡åŒ…å«$v'$ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡æ·»åŠ åˆ«çš„èŠ‚ç‚¹ç‡å…ˆåŠ ä¸Švï¼Œä»è€Œèƒ½å¤Ÿå•ç‹¬æ·»åŠ v'ï¼Œä»è€Œèƒ½å¤Ÿå•ç‹¬æ·»åŠ vã€‚
æ‰€ä»¥ï¼Œè¿™ä¸ªå¢é‡ä¸æ˜¯å•ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼šé‚»åŸŸç›¸åŒçš„å…ƒç´ ã€‚

å¯ä»¥åšäº†ï¼Ÿâ€¦â€¦å¤ªèœï¼Œæä¸æ˜ç™½è¿™æ€ä¹ˆåœ¨æ¯”èµ›æœŸé—´çŸ­æœŸæŠ˜è…¾å‡ºæ¥ã€‚


