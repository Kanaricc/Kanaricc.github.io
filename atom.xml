<?xml version="1.0" encoding="utf-8"?>


<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN">
    <title type="text">Kanari&#39;s Blog</title>
    <subtitle type="html">Kanari's blog.</subtitle>
    <updated>2020-04-13T09:55:05+08:00</updated>
    <id>https://blog.kanari.moe/</id>
    <link rel="alternate" type="text/html" href="https://blog.kanari.moe/" />
    <link rel="self" type="application/atom+xml" href="https://blog.kanari.moe/atom.xml" />
    <author>
            <name>Kanari</name>
            <uri>https://blog.kanari.moe/</uri>
            
                <email>secret@a.b</email>
            </author>
    
    <generator uri="https://gohugo.io/" version="0.66.0">Hugo</generator>
        <entry>
            <title type="text">ICPC2018 Yokohama</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/icpc2018-yokohama/" />
            <id>https://blog.kanari.moe/code/icpc2018-yokohama/</id>
            <updated>2020-04-13T09:53:21+08:00</updated>
            <published>2020-04-12T10:54:57+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[C. Emergency Evacuation å½“æ²¡æœ‰äººç¢°åœ¨ä¸€èµ·æ—¶ï¼Œè€—æ—¶å°±æ˜¯ç¦»é—¨æœ€è¿œçš„äººéœ€è¦çš„è€—æ—¶ã€‚å½“æœ‰äººç¢°åœ¨ä¸€èµ·æ—¶ï¼Œæ‰ä¼šå‘ç”Ÿâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="c-emergency-evacuation">C. Emergency Evacuation</h2>
<p>å½“æ²¡æœ‰äººç¢°åœ¨ä¸€èµ·æ—¶ï¼Œè€—æ—¶å°±æ˜¯ç¦»é—¨æœ€è¿œçš„äººéœ€è¦çš„è€—æ—¶ã€‚å½“æœ‰äººç¢°åœ¨ä¸€èµ·æ—¶ï¼Œæ‰ä¼šå‘ç”Ÿå…¶ä»–æƒ…å†µã€‚</p>
<p>äººç¢°åœ¨ä¸€èµ·çš„æ¡ä»¶æ˜¯ä»–ä»¬è·ç¦»é—¨çš„è·ç¦»ä¸€æ ·ï¼Œå¯ä»¥è®©äººåç€è·‘çœ‹å‡ºæ¥ã€‚å½“ç¢°åœ¨ä¸€èµ·æ—¶ï¼Œå¿…å®šä¼šæœ‰ä¸€ä¸ªäººç­‰å¾…ä¸€ç§’ã€‚è€Œè¿™ä¸ªç­‰çš„äººåˆ°åº•æ˜¯è°å¹¶æ²¡æœ‰åŒºåˆ«ï¼ŒåŸæœ¬ä¼šåœ¨ä¸‹ä¸€ç§’åˆ°è¾¾è¯¥æ ¼å­çš„äººæ€»æ˜¯ä¼šè¢«ç­‰å¾…çš„äººå¡ä½ã€‚ç„¶åå°±ä½ å¡æˆ‘ï¼Œæˆ‘å¡ä»–ï¼Œä»–å†å¡åé¢çš„äººã€‚</p>
<p>å°†é€ƒè·‘éœ€è¦æ—¶é—´ç›¸åŒçš„äººå¾€ååŒ€ã€‚æ—¶é—´çš„å€¼åŸŸä¸å¤§æ‰€ä»¥ç›´æ¥ç”¨æ¡¶ã€‚</p>
<h2 id="d-shortest-common-non-subsequence">D. Shortest Common Non-Subsequence</h2>
<blockquote>
<p>è¡¥</p>
</blockquote>
<p>å…ˆè€ƒè™‘æ€ä¹ˆæ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€å°éå­åºåˆ—ã€‚ç”¨ç±»ä¼¼äºåºåˆ—è‡ªåŠ¨æœºçš„æ–¹æ³•æ„é€ ã€‚</p>
<p>ä¸ºå­—ç¬¦ä¸²æ·»åŠ èµ·å§‹èŠ‚ç‚¹ï¼Œä»¤$f(i,x)$è¡¨ç¤ºåœ¨è¯¥è‡ªåŠ¨æœºä¸Šç¬¬içŠ¶æ€å¡«xå¾—åˆ°çš„æœ€çŸ­éå­åºåˆ—é•¿åº¦ã€‚è½¬ç§»æ˜¯</p>
<div>$$
f(i,x)=\min \{f(\text{next}(i,x),y)|y\}+1
$$</div>
å…¶ä¸­$\text{next}(i,x)$ä¸ºç¬¬iä½åæœ€è¿‘çš„xçš„ä½ç½®ã€‚åªè¦æœ€çŸ­é•¿åº¦æ—¶ï¼Œæ‰”æ‰xä¹Ÿæ— æ‰€è°“
<div>$$
f(i)=min\{f(\text{next}(i,x))|x\}+1
$$</div>
åˆå§‹çŠ¶æ€ä¸º$f(n+1)=0$ã€‚
<p>æ”¹é€ ä¸ºè¯¥é¢˜ï¼Œè®¾çŠ¶æ€$f(i,j)$ä¸ºåœ¨ä¿©è‡ªåŠ¨æœºä¸Šè·‘åˆ°$i,j$çŠ¶æ€çš„æœ€çŸ­XXé•¿åº¦ï¼Œæœ‰</p>
<div>$$
f(i,j)=\min\{f(n_1(i,x),n_2(j,x))|x\}+1
$$</div>
åˆå§‹çŠ¶æ€æœ‰$f(n_1+1,n_2+1)=0$ã€‚
<hr>
<p>æ„Ÿè§‰æœ‰ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜æ˜¯æœ€é•¿å…¬å…±å­ä¸²çš„å†™æ³•â€¦æ¯•ç«Ÿè½¬ç§»æ–¹ç¨‹çœ‹èµ·æ¥å‡ ä¹ä¸€æ ·æ¥ç€â€¦</p>
<div>$$
f(i,j)=\max\{f(n_1(i,x),n_2(j,x))|x\}+1
$$</div>
é‚£é‡ç‚¹å°±åªèƒ½åœ¨äºåˆå§‹çŠ¶æ€äº†ã€‚
<p>çœ‹èµ·æ¥åº”è¯¥æ˜¯$f(n_1+1,n_2+1)=-\infty,f(n_1, * )=f( * ,n_2)=0$ï¼Œä¸»è¦è€ƒè™‘çš„</p>
<ul>
<li>ä¸èƒ½è½¬ç§»åˆ°ä¸å­˜åœ¨n+1çŠ¶æ€ï¼Œè¿™æ„å‘³ç€å¡«å†™çš„å­—æ¯ä¸å­˜åœ¨ã€‚</li>
<li>nçŠ¶æ€æ— å­—ç¬¦ï¼Œ0ã€‚</li>
</ul>
<h2 id="k-sixth-sense">K. Sixth Sense</h2>
<p>ç®—æœ€å¤§å¾—åˆ†å¯ä»¥è´ªå¿ƒã€‚å¯¹æ–¹å’Œè‡ªå·±çš„ç‰Œå‡åºæ’åºåï¼Œæ‹¿æ­£å¥½èƒ½å¯¹æŠ—çš„ç‰Œå»å’Œå¯¹æ–¹ç‰Œä¸€ä¸€æ‰“ã€‚</p>
<p>å‰©ä¸‹çš„æ˜¯æ€ä¹ˆæ±‚å­—å…¸åºæœ€å¤§çš„ç­”æ¡ˆã€‚èƒ½å¤Ÿå‘ç°ï¼Œå½“å½“å‰è¿™å¼ ç‰Œæ‰“å¾—å¤ªå¤§æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´åç»­æŸä¸€è½®ç‰Œè¾“æ‰ï¼Œè®©æ€»æ¯”åˆ†å‡å°‘ã€‚è¿™çœ‹èµ·æ¥å¯ä»¥äºŒåˆ†ã€‚ä¸è¿‡å†™ç€å†™ç€æŠŠæ ·ä¾‹3ç»™waäº†ã€‚</p>
<p>ä¹‹åæ„è¯†åˆ°è¿™ä¸ªä¸œè¥¿å¹¶ä¸æ˜¯æ•´ä¸ªåŒºé—´å•è°ƒï¼Œéœ€è¦åœ¨å¾—åˆ†å’Œè¾“åˆ†çš„ä¸¤ä¸ªå‡ºç‰ŒåŒºé—´åˆ†åˆ«åšä¸¤æ¬¡ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unordered_map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">XN</span><span class="o">=</span><span class="mi">5050</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">my</span><span class="p">[</span><span class="n">XN</span><span class="p">],</span><span class="n">you</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">myrnk</span><span class="p">[</span><span class="n">XN</span><span class="p">],</span><span class="n">yournk</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">used</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">maxans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">//ä»ç¬¬nè½®å¼€å§‹
</span><span class="c1"></span><span class="kt">int</span> <span class="nf">check</span><span class="p">(</span><span class="kt">int</span> <span class="n">round</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;=</span><span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">yournk</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">&lt;</span><span class="n">round</span><span class="p">)</span><span class="n">ptr</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&gt;</span><span class="n">n</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">used</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&gt;</span><span class="n">n</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">my</span><span class="p">[</span><span class="n">myrnk</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">you</span><span class="p">[</span><span class="n">yournk</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]){</span>
            <span class="n">res</span><span class="o">++</span><span class="p">;</span>
            <span class="n">ptr</span><span class="o">++</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;=</span><span class="n">n</span> <span class="o">&amp;&amp;</span><span class="n">yournk</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">&lt;</span><span class="n">round</span><span class="p">)</span><span class="n">ptr</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">rest</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">you</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">my</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">myrnk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">yournk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">myrnk</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">myrnk</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">,[](</span><span class="k">auto</span> <span class="n">a</span><span class="p">,</span><span class="k">auto</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">my</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">&lt;</span><span class="n">my</span><span class="p">[</span><span class="n">b</span><span class="p">];</span>
    <span class="p">});</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">yournk</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">yournk</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">,[](</span><span class="k">auto</span> <span class="n">a</span><span class="p">,</span><span class="k">auto</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">you</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="o">&lt;</span><span class="n">you</span><span class="p">[</span><span class="n">b</span><span class="p">];</span>
    <span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">rest</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

    <span class="n">maxans</span><span class="o">=</span><span class="n">check</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">app</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="c1">//èµ¢çš„
</span><span class="c1"></span>        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">rest</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
            <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">r</span> <span class="o">&amp;&amp;</span> <span class="n">my</span><span class="p">[</span><span class="n">myrnk</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">l</span><span class="p">]]]</span><span class="o">&lt;=</span><span class="n">you</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="n">l</span><span class="o">++</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
                <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">chosen</span><span class="o">=</span><span class="n">rest</span><span class="p">[</span><span class="n">mid</span><span class="p">];</span>
                <span class="n">used</span><span class="p">[</span><span class="n">chosen</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">app</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">maxans</span><span class="p">)</span><span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
                <span class="k">else</span> <span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
                <span class="n">used</span><span class="p">[</span><span class="n">chosen</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
                <span class="n">used</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">app</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">maxans</span><span class="p">){</span>
                    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">my</span><span class="p">[</span><span class="n">myrnk</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">l</span><span class="p">]]]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
                    <span class="n">rest</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">rest</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="n">l</span><span class="p">);</span>
                    <span class="n">app</span><span class="o">++</span><span class="p">;</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">used</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">rest</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">r</span> <span class="o">&amp;&amp;</span> <span class="n">my</span><span class="p">[</span><span class="n">myrnk</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">r</span><span class="p">]]]</span><span class="o">&gt;</span><span class="n">you</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="n">r</span><span class="o">--</span><span class="p">;</span>
            <span class="n">r</span><span class="o">++</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
                <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">chosen</span><span class="o">=</span><span class="n">rest</span><span class="p">[</span><span class="n">mid</span><span class="p">];</span>
                <span class="n">used</span><span class="p">[</span><span class="n">chosen</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">app</span><span class="o">+</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">maxans</span><span class="p">)</span><span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
                <span class="k">else</span> <span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
                <span class="n">used</span><span class="p">[</span><span class="n">chosen</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">used</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">my</span><span class="p">[</span><span class="n">myrnk</span><span class="p">[</span><span class="n">rest</span><span class="p">[</span><span class="n">l</span><span class="p">]]]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
            <span class="n">rest</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">rest</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="n">l</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="extra">Extra</h2>
<p>åœ¨ç¾¤é‡Œçœ‹åˆ°ä¸€é“é¢˜ï¼Œåœ¨$1 \leq x \leq m$çš„nä¸ªæ•°ä¸­æ‰¾åˆ°ä¸€ä¸ªå­—å…¸åºæœ€å°çš„åºåˆ—ä¸”ä¸º1-mçš„ä¸€ä¸ªæ’åˆ—ã€‚</p>
<p>æœ€å¼€å§‹æƒ³ç»´æŠ¤æ¯ä¸ªæ•°å­—å‡ºç°çš„æ¬¡æ•°ï¼Œç„¶åä»ç¬¬ä¸€ä½å¼€å§‹å‘åæ‰«ï¼Œå½“å‰æ•°å­—æ­£å¥½æ˜¯è¿˜ç¼ºå°‘çš„æœ€å°æ•°å­—æˆ–è€…æ­¤åå†ä¹Ÿæ²¡æœ‰è¯¥æ•°å­—å‡ºç°çš„è¯å°±è¾“å‡ºã€‚åé¢çš„æ¡ä»¶æ˜¯å¯¹çš„ï¼Œçš„ç¡®å½“åæ–¹æ²¡æœ‰æ•°å­—æ—¶ï¼Œå°±ä¸å¾—ä¸åœ¨è¯¥ä½è¾“å‡ºï¼Œä½†æ˜¯å‰é¢çš„æ¡ä»¶æœ‰äº›é—®é¢˜ã€‚å¦‚æœä¸€ä¸ªæ›´å¤§çš„æ•°å­—ç»“æŸçš„æ¯”å°æ•°å­—æ›´å¿«ï¼Œä¸”ä¸‹ä¸€ä¸ªç¼ºå°‘çš„æœ€å°æ•°å­—å¹¶éâ€œå°æ•°å­—â€ï¼Œå°±ä¼šç¿»è½¦ã€‚æ­¤æ—¶çš„æƒ…å†µæœ€ä¼˜åº”è¯¥æ˜¯ä»¥ä¸å¾—ä¸è¾“å‡ºçš„ä½ç½®å¼€å§‹ï¼Œåˆ’åˆ†ä¸ºä¸¤ä¸ªé—®é¢˜ï¼Œå‰é¢å°½å¯èƒ½æ‰¾å­—å…¸åºå°çš„ä¸€æ®µã€‚</p>
<p>ç»´æŠ¤å•è°ƒæ ˆï¼Œå½“æ–°åŠ å…¥çš„æ•°å­—æ¯”å‰ä¸€ä¸ªæ›´ä¼˜ï¼ˆå­—å…¸åºå°ï¼‰æ—¶ï¼Œå¦‚æœå‰ä¸€ä¸ªæ•°å­—åœ¨åé¢è¿˜æœ‰ï¼Œå°±å¯ä»¥æŠŠå®ƒè¸¢æ‰ï¼Œå¦åˆ™å‰é¢çš„ç­”æ¡ˆå°±å®šäº†ï¼Œè¾“å‡ºç­”æ¡ˆåå†ä»è¯¥ä½é‡æ–°å¼€å§‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span><span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;unordered_map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;deque&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">XN</span><span class="o">=</span><span class="mi">30</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">cnt</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">used</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="n">deque</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">string</span> <span class="n">inp</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">inp</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">chr</span><span class="p">:</span><span class="n">inp</span><span class="p">)</span><span class="n">cnt</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">chr</span><span class="p">:</span><span class="n">inp</span><span class="p">){</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">used</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="o">&gt;</span><span class="n">chr</span> <span class="o">&amp;&amp;</span> <span class="n">cnt</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">used</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="n">q</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">chr</span><span class="p">);</span>
        <span class="n">used</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
                <span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E4%BA%8C%E5%88%86/" term="äºŒåˆ†" label="äºŒåˆ†" />
                            
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" term="åŠ¨æ€è§„åˆ’" label="åŠ¨æ€è§„åˆ’" />
                            
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E6%80%9D%E7%BB%B4/" term="æ€ç»´" label="æ€ç»´" />
                            
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" term="å•è°ƒæ ˆ" label="å•è°ƒæ ˆ" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF703D] Mishka and Interesting Sum</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf703d-mishka-and-interesting-sum/" />
            <id>https://blog.kanari.moe/code/cf703d-mishka-and-interesting-sum/</id>
            <updated>2020-04-13T09:53:08+08:00</updated>
            <published>2020-04-10T14:08:41+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Little Mishka enjoys programming. Since her birthday has just passed, her friends decided to present her with array of non-negative integers a1, a2, ..., an of n elements! Mishka loved the array and she instantly decided to determine its beauty value, butâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Little Mishka enjoys programming. Since her birthday has just passed, her friends decided to present her with array of non-negative integers a1,â€‰a2,â€‰...,â€‰an of n elements!</p>
<p>Mishka loved the array and she instantly decided to determine its beauty value, but she is too little and can't process large arrays. Right because of that she invited you to visit her and asked you to process m queries.</p>
<p>Each query is processed in the following way:</p>
<p>Two integers l and r (1â€‰â‰¤â€‰lâ€‰â‰¤â€‰râ€‰â‰¤â€‰n) are specified â€” bounds of query segment.
Integers, presented in array segment [l,â€‰â€‰r] (in sequence of integers al,â€‰alâ€‰+â€‰1,â€‰...,â€‰ar) even number of times, are written down.
XOR-sum of written down integers is calculated, and this value is the answer for a query. Formally, if integers written down in point 2 are x1,â€‰x2,â€‰...,â€‰xk, then Mishka wants to know the value , where  â€” operator of exclusive bitwise OR.
Since only the little bears know the definition of array beauty, all you are to do is to answer each of queries presented.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<blockquote>
<p>è¢«å¤§å“¥ä»¬ç§’åˆ‡äº†â€¦éƒ½æ²¡æ¥å¾—åŠæƒ³ğŸ’”</p>
</blockquote>
<p>åˆ©ç”¨äº†å¼‚æˆ–çš„æ€§è´¨ã€‚</p>
<p>æƒ³æ‰¾åˆ°ä¸€ä¸ªåŒºé—´å†…å‡ºç°å¥‡æ•°æ¬¡çš„æ•°çš„å¼‚æˆ–å’Œéå¸¸ç®€å•ï¼Œåªè¦ç»´æŠ¤ä¸€ä¸ªå‰ç¼€å’Œå°±å¯ä»¥äº†ã€‚é‚£ä¹ˆçŸ¥é“äº†å¥‡æ•°æ¬¡çš„æ•°å­—ï¼Œå°±èƒ½ä»æ‰€æœ‰æ•°å­—çš„å¼‚æˆ–ä¸­æ±‚åˆ°è¡¥â€”â€”å‡ºç°å¶æ•°æ¬¡çš„æ•°çš„å¼‚æˆ–ã€‚</p>
<p>å€¼å¾—ä¸€å†™çš„æ˜¯æ±‚æŸåŒºé—´å†…<strong>ä¸åŒå…ƒç´ </strong>ç›¸å…³ä¿¡æ¯çš„ä¸€ä¸ªæ€è·¯ã€‚ä¹‹å‰æœ‰å¥½å‡ é“é¢˜éƒ½æ˜¯è¿™ä¹ˆå¹²çš„ï¼ˆä¸€ä¸ªé’¥åŒ™çš„é¢˜ï¼Œä¸€ä¸ªä¹¦çš„é¢˜ï¼‰ã€‚å³ç»´æŠ¤å…ƒç´ çš„ä¸‹ä¸€æ¬¡å‡ºç°ä½ç½®ï¼Œå°†å·¦åŒºé—´æ’åºåï¼Œä½¿ç”¨æ•°æ®ç»“æ„æŸ¥è¯¢å³ç«¯ç‚¹ã€‚å½“å·¦ç«¯ç‚¹è¶Šè¿‡äº†æŸæ•°åï¼Œå°±å°†å…¶ä¸‹ä¸€æ¬¡å‡ºç°çš„ä½ç½®åŠ å…¥åˆ°ç»“æ„ä¸­ã€‚æ•´ä½“ä¸º$O(n\lg n)$ã€‚</p>
<p>å¦‚æœé¢˜ç›®çš„èŒƒå›´å°ä¸€ç‚¹ï¼Œå¯ä»¥è«é˜Ÿã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>æ²¡ä¸Šå¿«è¯»Täº†å‘ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unordered_map&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">XN</span><span class="o">=</span><span class="mi">1000010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">FTXN</span><span class="o">=</span><span class="mi">4000010</span><span class="p">;</span>
<span class="k">namespace</span> <span class="n">IO</span> <span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">IN</span><span class="o">=</span><span class="mf">1e6</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">in</span><span class="p">[</span><span class="n">IN</span><span class="p">],</span><span class="o">*</span><span class="n">ip</span><span class="o">=</span><span class="n">in</span><span class="p">,</span><span class="o">*</span><span class="n">ie</span><span class="o">=</span><span class="n">in</span><span class="p">;</span>
<span class="cp">#define getchar() (ip==ie &amp;&amp; (ie=(ip=in)+fread(in,1,IN,stdin),ip==ie)?EOF:*ip++)
</span><span class="cp"></span>    <span class="k">struct</span> <span class="nc">Istream</span> <span class="p">{</span>
        <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
        <span class="n">Istream</span> <span class="o">&amp;</span><span class="k">operator</span> <span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">T</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">static</span> <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span><span class="k">static</span> <span class="kt">bool</span> <span class="n">neg</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="n">ch</span><span class="o">=</span><span class="n">neg</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">ch</span><span class="o">&lt;</span><span class="sc">&#39;0&#39;</span> <span class="o">||</span> <span class="sc">&#39;9&#39;</span><span class="o">&lt;</span><span class="n">ch</span><span class="p">;</span><span class="n">neg</span><span class="o">|=</span><span class="n">ch</span><span class="o">==</span><span class="sc">&#39;-&#39;</span><span class="p">,</span><span class="n">ch</span><span class="o">=</span><span class="n">getchar</span><span class="p">());</span>
            <span class="k">for</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="sc">&#39;0&#39;</span><span class="o">&lt;=</span><span class="n">ch</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span><span class="o">&lt;=</span><span class="sc">&#39;9&#39;</span><span class="p">;(</span><span class="n">x</span><span class="o">*=</span><span class="mi">10</span><span class="p">)</span><span class="o">+=</span><span class="n">ch</span><span class="o">-</span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="n">ch</span><span class="o">=</span><span class="n">getchar</span><span class="p">());</span>
            <span class="n">x</span><span class="o">=</span><span class="n">neg</span><span class="o">?-</span><span class="nl">x</span><span class="p">:</span><span class="n">x</span><span class="p">;</span>
            <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span><span class="n">fin</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">int</span> <span class="n">OUT</span><span class="o">=</span><span class="mf">1e6</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">out</span><span class="p">[</span><span class="n">OUT</span><span class="p">],</span><span class="o">*</span><span class="n">op</span><span class="o">=</span><span class="n">out</span><span class="p">,</span><span class="o">*</span><span class="n">oe</span><span class="o">=</span><span class="n">out</span><span class="o">+</span><span class="n">OUT</span><span class="p">;</span>
<span class="cp">#define flush() fwrite(out,1,op-out,stdout)
</span><span class="cp">#define putchar(x) ((op==oe?(flush(),op=out,*op++):*op++)=(x))
</span><span class="cp"></span>    <span class="k">struct</span> <span class="nc">Ostream</span> <span class="p">{</span>
        <span class="o">~</span><span class="n">Ostream</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">flush</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
        <span class="n">Ostream</span> <span class="o">&amp;</span><span class="k">operator</span> <span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">T</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="p">),</span><span class="n">x</span><span class="o">=-</span><span class="n">x</span><span class="p">);</span>
            <span class="k">static</span> <span class="kt">char</span> <span class="n">stack</span><span class="p">[</span><span class="mi">233</span><span class="p">];</span><span class="k">static</span> <span class="kt">int</span> <span class="n">top</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">x</span><span class="p">;</span><span class="n">stack</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="o">%</span><span class="mi">10</span><span class="o">+</span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">/=</span><span class="mi">10</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="n">top</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">stack</span><span class="p">[</span><span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;0&#39;</span><span class="p">);</span><span class="n">top</span><span class="p">;</span><span class="n">putchar</span><span class="p">(</span><span class="n">stack</span><span class="p">[</span><span class="n">top</span><span class="o">--</span><span class="p">]));</span>
            <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">Ostream</span> <span class="o">&amp;</span><span class="k">operator</span> <span class="o">&lt;&lt;</span><span class="p">(</span><span class="kt">char</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">putchar</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
            <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span><span class="n">fout</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">using</span> <span class="n">IO</span><span class="o">::</span><span class="n">fin</span><span class="p">;</span>
<span class="k">using</span> <span class="n">IO</span><span class="o">::</span><span class="n">fout</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">ft</span><span class="p">[</span><span class="n">FTXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">lowbit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">ftadd</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">pos</span><span class="o">&lt;</span><span class="n">FTXN</span><span class="p">;</span><span class="n">pos</span><span class="o">+=</span><span class="n">lowbit</span><span class="p">(</span><span class="n">pos</span><span class="p">)){</span>
        <span class="n">ft</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">^=</span><span class="n">x</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">ftget</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">pos</span><span class="p">;</span><span class="n">pos</span><span class="o">-=</span><span class="n">lowbit</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="n">res</span><span class="o">^=</span><span class="n">ft</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">xo</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="k">struct</span> <span class="nc">Q</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="p">}</span> <span class="n">qs</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">ans</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="n">unordered_map</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">curpos</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nxt</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span><span class="n">fin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
    <span class="c1">//cout&lt;&lt;&#34;st&#34;&lt;&lt;endl;
</span><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">fin</span><span class="o">&gt;&gt;</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">xo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">xo</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="c1">//cout&lt;&lt;&#34;done&#34;&lt;&lt;endl;
</span><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="n">nxt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">curpos</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
        <span class="n">curpos</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
<span class="c1">//    for(int i=1;i&lt;=n;i++){
</span><span class="c1">//        cout&lt;&lt;nxt[i]&lt;&lt;&#34; &#34;;
</span><span class="c1">//    }
</span><span class="c1">//    cout&lt;&lt;endl;
</span><span class="c1"></span>
    <span class="kt">int</span> <span class="n">qlen</span><span class="p">;</span><span class="n">fin</span><span class="o">&gt;&gt;</span><span class="n">qlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">fin</span><span class="o">&gt;&gt;</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">;</span>
        <span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="p">]</span><span class="o">:</span><span class="n">curpos</span><span class="p">){</span>
        <span class="n">ftadd</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">sort</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span><span class="n">qs</span><span class="o">+</span><span class="n">qlen</span><span class="p">,[](</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">l</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="kt">int</span> <span class="n">la</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

    <span class="c1">//cout&lt;&lt;&#34;done&#34;&lt;&lt;endl;
</span><span class="c1"></span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Q</span> <span class="o">&amp;</span><span class="n">q</span><span class="o">=</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">l</span><span class="o">&gt;</span><span class="n">la</span><span class="p">){</span>
            <span class="n">ftadd</span><span class="p">(</span><span class="n">la</span><span class="p">,</span><span class="n">num</span><span class="p">[</span><span class="n">la</span><span class="p">]);</span>
            <span class="c1">//cout&lt;&lt;&#34;remove &#34;&lt;&lt;la&lt;&lt;endl;
</span><span class="c1"></span>            <span class="k">if</span><span class="p">(</span><span class="n">nxt</span><span class="p">[</span><span class="n">la</span><span class="p">]){</span>
                <span class="n">ftadd</span><span class="p">(</span><span class="n">nxt</span><span class="p">[</span><span class="n">la</span><span class="p">],</span><span class="n">num</span><span class="p">[</span><span class="n">la</span><span class="p">]);</span>
                <span class="c1">//cout&lt;&lt;&#34;add &#34;&lt;&lt;nxt[la]&lt;&lt;endl;
</span><span class="c1"></span>            <span class="p">}</span>
            <span class="n">la</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">ftget</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">r</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">xo</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">r</span><span class="p">]</span><span class="o">^</span><span class="n">xo</span><span class="p">[</span><span class="n">q</span><span class="p">.</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">fout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" term="æ ‘çŠ¶æ•°ç»„" label="æ ‘çŠ¶æ•°ç»„" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Prolonged Password</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/kattis-prolonged-password/" />
            <id>https://blog.kanari.moe/code/kattis-prolonged-password/</id>
            <updated>2020-04-09T09:26:39+08:00</updated>
            <published>2020-04-08T20:20:43+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç°æœ‰è¿™ä¹ˆä¸€ç§æ“ä½œï¼Œå°†å­—ç¬¦ä¸²å†…æ¯ä¸€ä¸ªå­—æ¯æ›¿æ¢æˆä¸€ç»™å®šå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚$T_aâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ç»™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç°æœ‰è¿™ä¹ˆä¸€ç§æ“ä½œï¼Œå°†å­—ç¬¦ä¸²å†…æ¯ä¸€ä¸ªå­—æ¯æ›¿æ¢æˆä¸€ç»™å®šå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚$T_a=abc,T_b=ee$ï¼Œé‚£ä¹ˆ$ab$å°±ä¼šè¢«æ›¿æ¢æˆ$abcee$ã€‚</p>
<p>ç»™å‡ºåˆå§‹çš„å­—ç¬¦ä¸²$S$ï¼Œå’Œ26ä¸ªå­—æ¯æ‰€å¯¹åº”çš„å­—ç¬¦ä¸²$T_i$ï¼Œåº”ç”¨æ“ä½œ$K$æ¬¡ï¼Œè¯¢é—®ç¬¬$i$ä¸ªä½ç½®çš„å­—ç¬¦ã€‚</p>
<p>$$|S| \leq 1000000$$</p>
<p>$$2 \leq |T_i| \leq 50,K \leq 10^{15}$$</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å¤´ç§ƒã€‚å¼€å§‹ä»¥ä¸ºå…³é”®æ˜¯åœ¨äºæ•°å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ç»è¿‡Kæ¬¡æ“ä½œåè¾¾åˆ°çš„é•¿åº¦ï¼Œç„¶åç„¶åç”¨ç±»ä¼¼äºäºŒåˆ†çš„æ–¹æ³•å»é€’å½’åœ°åˆ†å±‚æ‰¾åˆ°éœ€è¦çš„ä½ç½®ã€‚äºæ˜¯å°±ç»Ÿè®¡æ¯ä¸ªå­—æ¯çš„æ•°ç›®ï¼Œç”¨çŸ©é˜µå¿«é€Ÿå¹‚æ‹¿åˆ°é•¿åº¦â€¦â€¦</p>
<p>ç°åœ¨çœ‹ç€è¿‡äºæ™ºéšœã€‚è¿™1e15çš„æŒ‡æ•°å’Œ1e15çš„ä¸‹æ ‡ï¼Œä½ æ€ä¹ˆæ•¢å¿«é€Ÿå¹‚ã€‚</p>
<p>ç”±æ›¿æ¢å­—ç¬¦ä¸²çš„é•¿åº¦å¯ä»¥å¾—åˆ°ï¼Œè¿™ç§æ“ä½œé¡¶å¤šæ‰§è¡Œ50æ¬¡ï¼ˆ$2^{50}$ï¼‰ã€‚å› æ­¤å­—ç¬¦ä¸²çš„é•¿åº¦éƒ¨åˆ†è®¡ç®—å®é™…ä¸Šä¸å å¤§å¤´ï¼Œç”¨ä¸ªå€å¢å°±èƒ½å¤„ç†å‡ºæ¥ã€‚</p>
<p>ç°åœ¨å‰©ä¸‹çš„é—®é¢˜æ˜¯æ“ä½œæ¬¡æ•°$K$è¿‡å¤§ã€‚æ–¹æ³•ä»ç„¶æ˜¯åŸºäº50æ¬¡ã€‚ä¸€ä¸ªå­—ç¬¦æ‰©å±•50æ¬¡ï¼Œå°±è¶³å¤ŸæŠŠæ‰€æœ‰çš„è¯¢é—®åŒ…å«åœ¨å†…ã€‚å› æ­¤è¦è®¡ç®—å‡ºç¬¬ä¸€ä¸ªå­—ç¬¦æ›¿æ¢çš„å¾ªç¯èŠ‚ï¼Œå°†æ“ä½œæ¬¡æ•°é™åˆ°æ¥è¿‘50ã€‚æ­¤åé€šè¿‡å€å¢æ³•å»ä¸€å±‚å±‚å®šä½è¯¢é—®ä¸‹æ ‡æ‰€å¤„çš„ä½ç½®ã€‚</p>
<p>æœ€å¼€å§‹æ–¹å‘é”™äº†æ˜¯ä¸€ç äº‹â€¦æ„Ÿè§‰Kçš„èŒƒå›´ä¹ŸæŒºæ— èŠçš„â€¦ä»£ç ç­‰åˆ°ä¹‹åå†è¡¥ä¸Šã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>å®é™…å®ç°æ—¶ï¼Œé™Kå¯èƒ½æµ®åŠ¨26å·¦å³ï¼Œæ‰€ä»¥å¤šå¤„ç†è¿™ä¹ˆä¸€ç‚¹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cassert&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">30</span><span class="p">;</span>

<span class="n">string</span> <span class="n">inp</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">K</span><span class="p">;</span>
<span class="n">string</span> <span class="n">rep</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="mi">26</span><span class="p">][</span><span class="mi">81</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">upd</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">a</span><span class="o">+=</span><span class="n">b</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mf">1e15</span><span class="p">)</span><span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">char</span> <span class="nf">reduceK</span><span class="p">(){</span>
    <span class="c1">//æ‰¾åˆ°å¾ªç¯èŠ‚
</span><span class="c1"></span>    <span class="kt">char</span> <span class="n">chr</span><span class="o">=</span><span class="n">inp</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>
    <span class="n">stack</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">vis</span><span class="p">));</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]){</span>
        <span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">chr</span><span class="p">);</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">chr</span><span class="o">=</span><span class="n">rep</span><span class="p">[</span><span class="n">chr</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">cycle</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">()</span><span class="o">!=</span><span class="n">chr</span><span class="p">){</span>
        <span class="n">cycle</span><span class="o">++</span><span class="p">;</span>
        <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

    <span class="kt">int</span> <span class="n">pre</span><span class="o">=</span><span class="n">st</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

    <span class="c1">//å°†Kå‰Šåˆ°54-80
</span><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="n">K</span><span class="o">&lt;=</span><span class="mi">54</span><span class="p">)</span><span class="k">return</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">pre</span><span class="o">&lt;=</span><span class="mi">54</span><span class="p">)</span><span class="k">return</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
    <span class="n">K</span><span class="o">-=</span><span class="n">pre</span><span class="p">;</span>
    <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="o">-</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">54</span><span class="p">)</span><span class="o">/</span><span class="n">cycle</span><span class="o">*</span><span class="n">cycle</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">chr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">char</span> <span class="nf">solve</span><span class="p">(</span><span class="n">ll</span> <span class="n">idx</span><span class="p">,</span><span class="n">string</span> <span class="n">str</span><span class="p">,</span><span class="kt">int</span> <span class="n">p</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">str</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">f</span><span class="p">[</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">idx</span><span class="p">)</span><span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">rep</span><span class="p">[</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">],</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">idx</span><span class="o">-=</span><span class="n">f</span><span class="p">[</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="c1">//ä¸è¯¥å‡ºç°è¿™ç§æƒ…å†µ
</span><span class="c1"></span>    <span class="n">assert</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">inp</span><span class="p">;</span><span class="c1">//
</span><span class="c1"></span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">26</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">rep</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">rep</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">26</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">K</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;=</span><span class="mi">80</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">26</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">rep</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
                <span class="n">upd</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">p</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">rep</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">][</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">char</span> <span class="n">start</span><span class="o">=</span><span class="n">reduceK</span><span class="p">();</span>

    <span class="kt">int</span> <span class="n">qlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">qlen</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">qlen</span><span class="o">--</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">idx</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">idx</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">start</span><span class="o">==</span><span class="sc">&#39;\0&#39;</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">solve</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="n">K</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="k">else</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">solve</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">rep</span><span class="p">[</span><span class="n">start</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">],</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="c1">//-1
</span><span class="c1"></span>    <span class="p">}</span>

<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E5%80%8D%E5%A2%9E/" term="å€å¢" label="å€å¢" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ç”±Tiddywikiè¯´èµ·</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/info-dependence/" />
            <id>https://blog.kanari.moe/gossip/info-dependence/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-04-07T21:50:59+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[æˆ‘å†æ¢blogçš„åç«¯æˆ‘å°±æ˜¯ç‹—ã€‚ Tiddlywikiæ˜¯æˆ‘åœ¨å¯»æ‰¾Mediawikiçš„æ›¿ä»£â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<blockquote>
<p>æˆ‘å†æ¢blogçš„åç«¯æˆ‘å°±æ˜¯ç‹—ã€‚</p>
</blockquote>
<p>Tiddlywikiæ˜¯æˆ‘åœ¨å¯»æ‰¾Mediawikiçš„æ›¿ä»£å“æ—¶æ„å¤–å‘ç°çš„ä¸œè¥¿ã€‚èµ·åˆæˆ‘è¿˜æ˜¯åªæƒŠè‰³äºå®ƒçš„ç‰¹æ®Šçš„ç»„ç»‡æ–¹å¼å’Œé½å…¨çš„åŠŸèƒ½ï¼Œæ•´ä¸ªè½¯ä»¶åªæœ‰ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œé€»è¾‘ã€æ•°æ®å…¨éƒ¨ä¿å­˜åœ¨é‡Œé¢ã€‚åæ¥ï¼Œåœ¨æˆ‘æ·±å…¥è¿™å¥—è½¯ä»¶çš„æ¨¡æ¿åŠŸèƒ½æ—¶ï¼Œäº†è§£åˆ°äº†å®ƒçš„å“²å­¦ã€‚</p>
<p>Tiddlywikiä»æœ€åˆå°±æ‰“ç®—ä¸ºç”¨æˆ·å‡†å¤‡ä¸€ä¸ªæç«¯<strong>ç¨³å®š</strong>ä¸”<strong>ç‹¬ç«‹</strong>çš„éçº¿æ€§æ–‡å­—ç¬”è®°ç³»ç»Ÿã€‚å…¶ç¬¬ä¸€ä¸ªç‰ˆæœ¬åœ¨2004å¹´å‘å¸ƒï¼Œç›´åˆ°ç°åœ¨ä»ç„¶åœ¨ç¨³å®šçš„è¿è¡Œã€‚ä¸ºäº†åšåˆ°ä¸Šé¢çš„è¦æ±‚ï¼Œwikiæ‰é‡‡ç”¨äº†å•æ–‡ä»¶æ–¹å¼ï¼Œä¸è¿½æ±‚ä»»ä½•æ—¶é«¦æŠ€æœ¯ï¼Œå°½å¯èƒ½ä¸ä¾èµ–ä»»ä½•ç°å­˜çš„å…¶ä»–è½¯ä»¶ï¼Œå°½å¯èƒ½åšåˆ°å…¼å®¹ï¼Œç”šè‡³ä»£ç ä¹Ÿå®Œå…¨åŸºäºvanillaå’Œhtml5ã€‚è€Œè¿™ä¹ˆåšçš„åŸå› å¤§æ¦‚å°±æ˜¯è¦è¾¾åˆ°ä¸€ç‚¹è¦æ±‚ï¼šåœ¨æä¾›è¶³å¤ŸåŠŸèƒ½çš„å‰æä¸‹ï¼Œä¿è¯ç³»ç»Ÿçš„ç‹¬ç«‹å’Œåœ¨<em>å¾ˆé•¿</em>ä¸€æ®µæ—¶é—´å†…çš„å¯é ï¼Œä»è€Œç»´æŒæ•°æ®çš„ç‹¬ç«‹ã€‚</p>
<p>ä¸ºä½•è¿™ä¹ˆå¼ºè°ƒæ•°æ®çš„ç‹¬ç«‹ï¼Ÿå› ä¸ºæ•°æ®æ˜¾ç„¶æ¯”å‡­ä¾çš„è®°å½•æ‰‹æ®µæ›´æœ‰ä»·å€¼ã€‚è¯•æƒ³å¦‚æœï¼ˆå¦‚æœï¼ï¼‰æœ‰ä¸€å¤©OneNoteè¢«ç æ‰äº†ï¼Œæˆ‘è§‰å¾—ä¸ä¼šæœ‰ç”¨æˆ·ä¼šå…ˆäºè‡ªå·±çš„ç¬”è®°å»æ‹…å¿§å·¨ç¡¬çš„æ˜å¤©ï¼Œç”¨æˆ·ç¬¬ä¸€è€ƒè™‘çš„è¯¥æ˜¯å¦‚ä½•å°†è‡ªå·±æ²‰ç§¯å¤šå¹´çš„ç¬”è®°ç»Ÿç»Ÿè½¬ç§»å‡ºæ¥ã€‚è¿™å¾ˆéš¾ï¼Œå³ä½¿è½¬ç§»å‡ºæ¥ï¼Œææ€•ä¹Ÿæ— æ³•è·å¾—åŒæ ·çš„ç¼–è¾‘ä½“éªŒã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œç¼…æ€€ä¸€ä¸‹è¢«è°·å§ç æ‰çš„readerâ€¦</p>
<p>æ•°æ®å…·æœ‰æ›´é«˜çš„ä»·å€¼ï¼Œæ•°æ®åº”è¯¥å°½å¯èƒ½é¿å…å¯¹ç‰¹å®šç³»ç»Ÿçš„ä¾èµ–ã€‚</p>
<p>åœ¨è¿‡å»çš„ä¸€æ®µæ—¶é—´é‡Œï¼Œæˆ‘åˆå¤šæ¬¡çœ‹åˆ°äº†è¿™ç§æ„è§ã€‚æœ‰äººåœ¨è®¨è®ºNASæ—¶æŒæœ‰è¿™ç§è§‚ç‚¹ï¼Œè®¤ä¸ºè¦è¿œç¦»ä¸é è°±çš„ç½‘ç›˜ï¼Œæ•°æ®å’Œå¤„ç†æ•°æ®çš„å·¥å…·åº”è¯¥åˆ†ç¦»ï¼›åœ¨vnoteçš„issueä¸­çœ‹åˆ°ä½œè€…å¦å®šä½¿ç”¨sqliteä¿å­˜æ•°æ®æ—¶ä¹Ÿå¦‚æ˜¯è¯´ï¼Œä¸ä½¿ç”¨ç§æœ‰æ ¼å¼ï¼Œè¦ä¸ºç”¨æˆ·ç•™è¶³è½¬ç§»ç¬”è®°çš„ç©ºé—´ã€‚</p>
<p>ä¸è¿‡ï¼Œä¿æŒæ•°æ®æ›´é«˜çš„ç‹¬ç«‹æ€§ä¹Ÿå¹¶éå¥½äº‹ï¼Œè¿™ä¸€èˆ¬æ„å‘³ç€æ— æ³•å¾—åˆ°æ›´å¤šçš„åŠŸèƒ½ã€‚æƒ³è¦è§£å†³ä¹Ÿæœ‰ç‚¹æ€è·¯ï¼Œè¦ä¹ˆæŠŠç³»ç»Ÿç¨³å®šæ€§åšåˆ°æè‡´ï¼Œåˆ«æœ‰äº‹æ²¡äº‹å¨èƒæ•°æ®å®‰å…¨ï¼Œè¦ä¹ˆæŠŠæ ¼å¼åšæˆæ ‡å‡†ï¼Œå¤§å®¶é€šç”¨ï¼Œç»™æ•°æ®ç•™è¶³åè·¯ã€‚</p>
<p>æ‰€ä»¥æ‰¯äº†è¿™ä¹ˆå¤šåºŸè¯ï¼Œç»“è®ºå°±æ˜¯æˆ‘åˆå›åˆ°é™æ€åšå®¢äº†ï¼Œé¡ºä¾¿ä½“éªŒäº†ä¸€éä»æ•°æ®åº“è½¬ç§»åˆ°æ–‡ä»¶çš„ç—›è‹¦ã€‚å…ˆæŠŠæ•°æ®åº“å¯¼å‡ºjsonï¼Œå†æ‹¿pythonè½¬æ¢æ ¼å¼ï¼Œè¿˜è¦è«åå…¶å¦™å†è½¬ä¹‰ä¸€éæ–‡ä»¶é‡Œçš„dosæ¢è¡Œç¬¦ã€‚å•§ï¼Œå³ä½¿æ˜¯æœ€é€šç”¨çš„æ–‡æœ¬æ–‡ä»¶ï¼Œç…§æ ·ä¸åŒå¹³å°é—´ç§»æ¤ä¼šæœ‰ä»£ä»·ã€‚Â¯\<em>(ãƒ„)</em>/Â¯</p>
<p>æˆ‘å†ä¹Ÿä¸æŠ˜è…¾äº†ï¼Œå†æŠ˜è…¾æˆ‘å°±æ˜¯ç‹—ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä¸€ç‚¹ç‚¹äºŒç»´å‚…ç«‹å¶å˜æ¢</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/a-little-2d-fft/" />
            <id>https://blog.kanari.moe/gossip/a-little-2d-fft/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-27T21:49:59+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[ç›®å‰ï¼Œé’ˆå¯¹å›¾ç‰‡ï¼Œè§†é¢‘ï¼Œæˆ‘ä»¬æœ‰é€šè¿‡åœ¨é¢‘åŸŸä¸Šä¹±æçš„æ–¹å¼ä¸ºå…¶æ·»åŠ ä¸å¯è§æ°´å°ã€‚è¿™ç§æŠ€æœ¯ä¸»è¦ä¾â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ç›®å‰ï¼Œé’ˆå¯¹å›¾ç‰‡ï¼Œè§†é¢‘ï¼Œæˆ‘ä»¬æœ‰é€šè¿‡åœ¨é¢‘åŸŸä¸Šä¹±æçš„æ–¹å¼ä¸ºå…¶æ·»åŠ ä¸å¯è§æ°´å°ã€‚è¿™ç§æŠ€æœ¯ä¸»è¦ä¾é çš„å°±æ˜¯äºŒç»´å‚…ç«‹å¶å˜æ¢ã€‚</p>
<div>$$
\hat g(f)=\int{g(t)e^{-2\pi i ft}dt}
$$</div>
<p>è¿™ä¸ªæ˜¯ä¸€ç»´çš„å‚…ç«‹å¶å˜æ¢ã€‚é‚£ä¹ˆï¼Œå¦‚æœç°åœ¨æœ‰ä¸€ä¸ªäºŒç»´ä¿¡å·$g(t_1,t_2)$ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç®€å•çš„æŠŠä¸Šå¼æ”¹ä¸º</p>
<div>$$
\hat g(f_1,f_2)=\int\int{g(t_1,t_2)e^{-2\pi i (f_1t_1+f_2t_2)}dt_1dt_2}
$$</div>
<p>äº‹å®ä¸Šæ˜¯çš„ã€‚è€Œé€†å˜æ¢ä¸º</p>
<div>$$
g(t_1,t_2)=\frac{1}{4 \pi^2}\int\int\hat g(f_1,f_2)e^{2\pi i (t_1f_1+t_2f_2)}df_1df_2
$$</div>
<p>å¦‚æœå†™æˆç¦»æ•£å½¢å¼ï¼Œä¹Ÿæ˜¯ä¸€ç§å¥—è·¯ã€‚</p>
<div>$$
\hat g(f_1,f_2)=\sum\sum{g(t_1,t_2)e^{-2\pi i (f_1t_1+f_2t_2)}}
$$</div>
<div>$$
g(t_1,t_2)=\frac{1}{4 \pi^2}\sum\sum\hat g(f_1,f_2)e^{2\pi i (t_1f_1+t_2f_2)}
$$</div>
<p>äºŒç»´çš„å‚…ç«‹å¶å˜æ¢ä»ç„¶æ˜¯å°†ä¿¡å·åˆ†è§£ä¸ºå¤šä¸ªæˆåˆ†ï¼Œåªä¸è¿‡è¿™é‡Œæˆäº†å¹³é¢æ„ä¹‰ä¸Šçš„æ³¢ï¼Œè€Œä¸”å¤šäº†ä¸€ä¸ªæ–¹å‘ã€‚è¿™é‡Œçš„æ–¹å‘æˆ‘ä»¬ç›´æ¥æŠŠ$f_1,f_2$ç»˜åˆ¶åˆ°ä¸­å¿ƒç‚¹ä¸º$(0,0)$çš„åæ ‡ç³»ä¸Šï¼Œä»è€Œèƒ½å¤Ÿå½¢æˆä¸€å¼ é™„å¸¦å…¨éƒ¨ä¿¡æ¯çš„é¢‘åŸŸå›¾ã€‚</p>
<p>å¯¹äºäºŒç»´å‚…ç«‹å¶å˜æ¢çš„ç»“æœï¼Œä¹Ÿå’Œä¸€ç»´çš„ç»“æœåˆç±»ä¼¼å«ä¹‰ã€‚ä¸€ä¸ªä¸€å…ƒå‡½æ•°çš„é«˜é¢‘ä½é¢‘æ„å‘³ç€å…¶å˜åŒ–å¿«ä¸æ…¢çš„æˆåˆ†ï¼Œä¸€ä¸ªå£°éŸ³çš„é«˜é¢‘ä½é¢‘æ„å‘³ç€å…¶é«˜éŸ³å’Œä½éŸ³éƒ¨åˆ†ï¼Œè€Œä¸€ä¸ªäºŒç»´å˜æ¢çš„ç»“æœé«˜é¢‘ä½é¢‘ä¹Ÿæ„å‘³ç€è¯¥æ•°æ®å˜åŒ–å¿«ä¸æ…¢çš„éƒ¨åˆ†ã€‚</p>
<p>æ—¢ç„¶èƒ½å¤Ÿä»éŸ³é¢‘é¢‘åŸŸä¸Šæ‘˜æ‰å¯¹å£°éŸ³æœ‰æ„ä¹‰çš„é¢‘ç‡ï¼ˆä¾‹å¦‚åˆ æ‰ä¸äººå£°ç›¸å…³çš„é¢‘ç‡ï¼‰ï¼Œé‚£å°±ä¹Ÿå¯ä»¥åœ¨å›¾ç‰‡é¢‘åŸŸä¸­å åŠ å¯¹äººæœ‰æ„ä¹‰çš„é¢‘ç‡ã€‚æ‰€è°“å›¾ç‰‡ä¸è§†é¢‘çš„éšå†™æœ¯å°±æ˜¯å°†å¯¹äººçœ¼æœ‰æ„ä¹‰çš„é¢‘ç‡å åŠ åˆ°é¢‘åŸŸä¸­å†è¿›è¡Œé€†å˜æ¢çš„ç»“æœã€‚åŒ…æ‹¬éŸ³é¢‘ä¹Ÿå¯ä»¥è¿™ä¹ˆå¹²ï¼Œåˆ©ç”¨çŸ­æ—¶è·å‚…ç«‹å¶å˜æ¢åœ¨é¢‘åŸŸä¸Šç”»ä¸€ç‚¹æœ‰æ„ä¹‰çš„å›¾åƒå†é€†å˜æ¢å›å»ï¼Œå°±èƒ½å½“ä½œæ›´é«˜çº§ä¸€ç‚¹çš„éŸ³é¢‘æ°´å°ã€‚ä¸è¿‡å®é™…æµ‹è¯•èµ·æ¥ï¼Œåœ¨éŸ³é¢‘é¢‘åŸŸä¸Šæå¾—å¤ªè¿‡å¤´çš„è¯å¬æ„Ÿå½±å“æŒºå¤§çš„ã€‚</p>
<p>è¿™ç§æŠ€æœ¯ç›¸æ¯”ç›´æ¥æ‰“æ°´å°æœ‰å¾ˆå¤šå¥½å¤„ï¼Œåˆ©ç”¨é¢‘ç‡çš„ç‰¹æ€§æ„å‘³ç€å®ƒå¯ä»¥å¯¹æŠ—å¾ˆå¤šä¸€èˆ¬çš„æ”»å‡»æ–¹å¼ã€‚ä¸è¿‡ä¸€æ—¦æ”»å‡»èƒ½å¤Ÿå½±å“é¢‘ç‡ï¼Œä¾‹å¦‚å†æ¬¡æ‹æ‘„/å½•éŸ³è¿™ç§ï¼Œè‡³å°‘æœ´ç´ çš„éšå†™å°±åŸºæœ¬ä¸Šggäº†ã€‚</p>
<p>æ‰€ä»¥çœ‹åˆ°æœ‰äººæ‹¿è¿™ä¸ªç©æ„å»æ°´å¤§åˆ›å°±æœ‰ç‚¹å¥½å¥‡ï¼Œé—®äº†é—®èƒ½å¦è¯†åˆ«æˆ‘ç°æ‹çš„ç…§ç‰‡ï¼Œå¾—åˆ°çš„ç­”å¤æ˜¯ä¸è¡Œâ€¦â€¦è¿˜ä»¥ä¸ºä¼šæœ‰å¹²è´§ï¼Œç¨å¾®æœ‰äº›å¤±æœ›ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä¸€ç‚¹ç‚¹ç‚¹åˆ†æ²»</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/a-littile-tree-divide/" />
            <id>https://blog.kanari.moe/study/a-littile-tree-divide/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-26T18:40:09+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[ä»Šå¤©ä»ç„¶æ˜¯è¢«åŠèµ·æ¥æ‰“çš„ä¸€å¤©ã€‚ ç‚¹åˆ†æ²»æ˜¯ä¸€ç§ç”¨äºè§£å†³æ ‘ä¸Šè·¯å¾„é—®é¢˜çš„æ€è·¯ã€‚å®ƒçš„å…³é”®å°±æ˜¯é€‰ä¸­â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ä»Šå¤©ä»ç„¶æ˜¯è¢«åŠèµ·æ¥æ‰“çš„ä¸€å¤©ã€‚</p>
<p>ç‚¹åˆ†æ²»æ˜¯ä¸€ç§ç”¨äºè§£å†³æ ‘ä¸Šè·¯å¾„é—®é¢˜çš„æ€è·¯ã€‚å®ƒçš„å…³é”®å°±æ˜¯é€‰ä¸­ä¸€ç‚¹ï¼Œç»Ÿè®¡ç»è¿‡è¯¥ç‚¹çš„ç­”æ¡ˆååˆ é™¤ç‚¹ï¼Œå†é€’å½’åˆ°ä¸¤ä¸ªå­æ ‘ä¸­è¿›è¡ŒåŒæ ·çš„æ“ä½œã€‚</p>
<p>åˆ é™¤çš„ç‚¹è¿å¸¦åˆ é™¤äº†ä¸€äº›å·²ç»è®¡ç®—è¿‡çš„è·¯å¾„ã€‚</p>
<p>å½“æ¯æ¬¡é€‰æ‹©é‡å¿ƒä½œä¸ºæ ¹æ—¶ï¼Œèƒ½ä¿è¯ç‚¹åˆ†æ²»çš„å¤æ‚åº¦æœ¬èº«ä¸º$O(n \log n)$ã€‚å½“ç„¶ä½ å¾—ä¿è¯$O(n)$åšå®Œä½ çš„äº‹æƒ…ï¼Œ<em>åŒæ ·æ¸…æ•°ç»„æ—¶ä¹Ÿå¿…é¡»åªæ¸…ç”¨åˆ°çš„</em>ã€‚</p>
<p>å°è±¡é‡Œä¹‹å‰æœ‰é“æ ‘ä¸ŠDPçš„é¢˜ï¼Œè‡ªå·±yyçç³Šçš„ç®—æ³•å†™çš„éš¾çœ‹åˆéš¾è°ƒï¼Œå°±æœ‰ç‚¹è¿™ç§æ„Ÿè§‰ã€‚ä¸è¿‡é‚£ä¸ªæ˜¯$O(n)$çš„ï¼Œå¤§æ¦‚æ³›ç”¨ä¸Šä¸å¦‚è¿™ä¸ªã€‚</p>
<h2 id="èªèªå¯å¯">èªèªå¯å¯</h2>
<p>èªèªå’Œå¯å¯æ˜¯å…„å¼Ÿä¿©ï¼Œä»–ä»¬ä¿©ç»å¸¸ä¸ºäº†ä¸€äº›çäº‹æ‰“èµ·æ¥ï¼Œä¾‹å¦‚å®¶ä¸­åªå‰©ä¸‹æœ€åä¸€æ ¹å†°æ£è€Œä¸¤äººéƒ½æƒ³åƒã€ä¸¤ä¸ªäººéƒ½æƒ³ç©å„¿ç”µè„‘ï¼ˆå¯æ˜¯ä»–ä»¬å®¶åªæœ‰ä¸€å°ç”µè„‘ï¼‰â€¦â€¦é‡åˆ°è¿™ç§é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹çŸ³å¤´å‰ªåˆ€å¸ƒå°±å¥½äº†ï¼Œå¯æ˜¯ä»–ä»¬å·²ç»ç©å„¿è…»äº†è¿™ç§ä½æ™ºå•†çš„æ¸¸æˆã€‚</p>
<p>ä»–ä»¬çš„çˆ¸çˆ¸å¿«è¢«ä»–ä»¬çš„äº‰åµçƒ¦æ­»äº†ï¼Œæ‰€ä»¥ä»–å‘æ˜äº†ä¸€ä¸ªæ–°æ¸¸æˆï¼šç”±çˆ¸çˆ¸åœ¨çº¸ä¸Šç”» nn ä¸ªâ€œç‚¹â€ï¼Œå¹¶ç”¨ n-1nâˆ’1 æ¡â€œè¾¹â€æŠŠè¿™ nn ä¸ªâ€œç‚¹â€æ°å¥½è¿é€šï¼ˆå…¶å®è¿™å°±æ˜¯ä¸€æ£µæ ‘ï¼‰ã€‚å¹¶ä¸”æ¯æ¡â€œè¾¹â€ä¸Šéƒ½æœ‰ä¸€ä¸ªæ•°ã€‚æ¥ä¸‹æ¥ç”±èªèªå’Œå¯å¯åˆ†åˆ«éšå³é€‰ä¸€ä¸ªç‚¹ï¼ˆå½“ç„¶ä»–ä»¬é€‰ç‚¹æ—¶æ˜¯çœ‹ä¸åˆ°è¿™æ£µæ ‘çš„ï¼‰ï¼Œå¦‚æœä¸¤ä¸ªç‚¹ä¹‹é—´æ‰€æœ‰è¾¹ä¸Šæ•°çš„å’ŒåŠ èµ·æ¥æ°å¥½æ˜¯ 33 çš„å€æ•°ï¼Œåˆ™åˆ¤èªèªèµ¢ï¼Œå¦åˆ™å¯å¯èµ¢ã€‚</p>
<p>èªèªéå¸¸çˆ±æ€è€ƒé—®é¢˜ï¼Œåœ¨æ¯æ¬¡æ¸¸æˆåéƒ½ä¼šä»”ç»†ç ”ç©¶è¿™æ£µæ ‘ï¼Œå¸Œæœ›çŸ¥é“å¯¹äºè¿™å¼ å›¾è‡ªå·±çš„è·èƒœæ¦‚ç‡æ˜¯å¤šå°‘ã€‚ç°è¯·ä½ å¸®å¿™æ±‚å‡ºè¿™ä¸ªå€¼ä»¥éªŒè¯èªèªçš„ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ã€‚</p>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>ç»Ÿè®¡è·¯å¾„ã€‚ä½†æ˜¯è¿™é¢˜dpçš„è¯èƒ½è½¬ç§»ã€‚</p>
<p>ä½†æ˜¯è¿˜æ˜¯ç”¨ç‚¹åˆ†æ²»ã€‚</p>
<p>æšä¸¾ä¸€ä¸ªç‚¹åï¼Œè®¾$f(u,j)$è¡¨ç¤ºåˆ°$u$ç‚¹æ¨¡3ä¸º$j$çš„è·¯å¾„æ•°æœ‰å¤šå°‘ã€‚è½¬ç§»å¾ˆæ˜æ˜¾ï¼Œç»Ÿè®¡ä¹Ÿå¾ˆæ˜¾ç„¶ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">XV</span><span class="o">=</span><span class="mi">20010</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">pii</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">XV</span><span class="p">];</span>


<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">XV</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">sz</span><span class="p">[</span><span class="n">XV</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>
    <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">]</span><span class="o">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">dfs1</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">SZ</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">rt</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">maxsz</span><span class="p">[</span><span class="n">XV</span><span class="p">];</span>

<span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ready_to_clear</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">getroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>
    <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">ready_to_clear</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">]</span><span class="o">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">getroot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
        <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">SZ</span><span class="o">-</span><span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">rt</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">&lt;</span><span class="n">maxsz</span><span class="p">[</span><span class="n">rt</span><span class="p">])</span><span class="n">rt</span><span class="o">=</span><span class="n">u</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">XV</span><span class="p">][</span><span class="mi">3</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">cal</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>

    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">]</span><span class="o">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">cal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">t</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="n">w</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">t</span><span class="p">[</span><span class="n">w</span><span class="o">%</span><span class="mi">3</span><span class="p">]</span><span class="o">++</span><span class="p">;</span><span class="c1">//ç”±vç›´æ¥å‡ºå‘
</span><span class="c1"></span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">rt</span><span class="p">){</span>
            <span class="c1">//ä»è¯¥å­æ ‘åˆ°ä¹‹å‰æ‰€æœ‰çš„å­æ ‘
</span><span class="c1"></span>            <span class="n">ans</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">ans</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
            <span class="n">ans</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">rt</span><span class="p">)</span><span class="n">ans</span><span class="o">+=</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">){</span>
    <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">ready_to_clear</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
        <span class="kt">int</span> <span class="n">u</span><span class="o">=</span><span class="n">ready_to_clear</span><span class="p">.</span><span class="n">front</span><span class="p">();</span><span class="n">ready_to_clear</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cal</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="c1">//cout&lt;&lt;&#34;after&#34;&lt;&lt;u&lt;&lt;&#34;,ans=&#34;&lt;&lt;ans&lt;&lt;endl;
</span><span class="c1"></span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">]</span><span class="o">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">SZ</span><span class="o">=</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span><span class="n">rt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">getroot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">solve</span><span class="p">(</span><span class="n">rt</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span>
    <span class="k">return</span> <span class="o">!</span><span class="n">b</span><span class="o">?</span><span class="nl">a</span><span class="p">:</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">u</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="o">&gt;&gt;</span><span class="n">w</span><span class="p">;</span>
        <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>
        <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">vis</span><span class="p">));</span>
    <span class="n">SZ</span><span class="o">=</span><span class="n">nlen</span><span class="p">;</span>
    <span class="n">rt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">getroot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">rt</span><span class="p">);</span>


    <span class="n">ll</span> <span class="n">win</span><span class="o">=</span><span class="n">ans</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="n">nlen</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">all</span><span class="o">=</span><span class="mi">1LL</span><span class="o">*</span><span class="n">nlen</span><span class="o">*</span><span class="n">nlen</span><span class="p">;</span>

    <span class="n">ll</span> <span class="n">g</span><span class="o">=</span><span class="n">gcd</span><span class="p">(</span><span class="n">win</span><span class="p">,</span><span class="n">all</span><span class="p">);</span>

    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">win</span><span class="o">/</span><span class="n">g</span><span class="o">&lt;&lt;</span><span class="s">&#34;/&#34;</span><span class="o">&lt;&lt;</span><span class="n">all</span><span class="o">/</span><span class="n">g</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="hdu6643-yts1999-doesnt-like-this-problem">[HDU6643] yts1999 Doesn't Like This Problem</h2>
<p>Mr. Bread has a tree T with n vertices, labeled by 1,2,â€¦,n. Each vertex of the tree has a positive integer value wi.</p>
<p>The value of a non-empty tree T is equal to w1Ã—w2Ã—â‹¯Ã—wn. A subtree of T is a connected subgraph of T that is also a tree.</p>
<p>Please write a program to calculate the number of non-empty subtrees of T whose values are not larger than a given number m.</p>
<h3 id="åˆ†æ-1">åˆ†æ</h3>
<p>è™½ç„¶æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆå°±æ˜¾ç„¶ç‚¹åˆ†æ²»äº†ï¼Œä½†æ˜¯ä»–ä»¬è¯´æ˜¯ã€‚è¦DPè¿˜æ˜¯å®¹æ˜“çœ‹å‡ºæ¥çš„ã€‚</p>
<p>ç‚¹åˆ†æ²»èƒ½å¤Ÿè§£å†³è·¯å¾„é—®é¢˜ï¼Œè¿™ç§è¿é€šæ€§é—®é¢˜ä¹Ÿå¯ä»¥è§£å†³ã€‚ä¹Ÿæ˜¯æšä¸¾ä¸€ä¸ªç‚¹åï¼Œç»Ÿè®¡åŒ…æ‹¬è¿™ä¸ªç‚¹çš„è¿é€šå—çš„ç­”æ¡ˆã€‚</p>
<p>é€‰ä¸­è¯¥ç‚¹åï¼Œè¿›è¡ŒDPã€‚ç„¶åæ˜¯ä»–ä»¬è¯´çš„éå¸¸å¥—è·¯çš„åˆ©ç”¨dfsåºå°†æ ‘æ˜ å°„åˆ°åºåˆ—ä¸Šçš„åšæ³•ã€‚ä»¥$f(i,j)$è¡¨ç¤ºåœ¨$i$ç‚¹å¤„å€¼ä¸º$j$çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>é€‰ä¸­$i$ï¼š</p>
<div>$$f(i,ja)+=f(i+1,a)$$</div>
<p>ä¸é€‰$i$ï¼Œé‚£ä¹ˆåŒæ—¶è¦è·³è¿‡içš„æ•´ä¸ªå­æ ‘ï¼š</p>
<div>$$f(i,j)+=f(i+\text{sz}(i),j)$$</div>
<p>å¦å¤–æ˜¯è¿™é“é¢˜çš„$j$èŒƒå›´å¤ªå¤§ã€‚çœ‹åˆ°ä¸€ä¸ªå¾ˆéªšçš„å†™æ³•æ˜¯å­˜æˆ$j$å’Œ$M/j$ï¼Œç„¶åæ¯ä¸ªéƒ½åªæœ‰$\sqrt M$è¿™ä¹ˆå¤§â€¦æˆ‘å¯»æ€ä½ å†ç»™æˆ‘ä¸€éè¿™ä¸ªé¢˜æˆ‘ä¹Ÿyyä¸å‡ºæ¥è¿™ç§å­˜æ³•ã€‚</p>
<p>æ€»ä¹‹æœ‰ä¸¤ä¸ªä¸œè¥¿å¯ä»¥æ³¨æ„ä¸€ä¸‹ï¼š</p>
<ul>
<li>å¯¹æ ‘ä¸Šæ¶‰åŠä¾èµ–å…³ç³»çš„DPå¯ä»¥è€ƒè™‘ä½¿ç”¨dfsåºæ˜ å°„ã€‚</li>
<li>æˆ‘ä¸çŸ¥é“è¿™ä¸ªå¤„ç†jçš„åŠæ³•æœ‰æ²¡æœ‰æ³›ç”¨æ€§ã€‚</li>
</ul>
<h3 id="ä»£ç ">ä»£ç </h3>
<blockquote>
<p>ä»£ç ä¸­çš„é‡å¿ƒã€ç‚¹åˆ†æ²»çš„solveåº”è¯¥å½¢æˆè¾ƒä¸ºå›ºå®šçš„å†™æ³•ã€‚</p>
</blockquote>
<p><a href="https://www.cnblogs.com/hua-dong/p/11320013.html" title="origin">origin</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="c1">/// copied
</span><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">XN</span><span class="o">=</span><span class="mi">2010</span><span class="p">;</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">dfn</span><span class="p">[</span><span class="n">XN</span><span class="p">],</span><span class="n">sz</span><span class="p">[</span><span class="n">XN</span><span class="p">],</span><span class="n">tick</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">re</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">vis</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">wage</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">m</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">square</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tick</span><span class="p">;</span>
    <span class="n">re</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">SZ</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">maxsz</span><span class="p">[</span><span class="n">XN</span><span class="p">],</span><span class="n">root</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">getroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">v</span> <span class="o">==</span> <span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">getroot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
        <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">SZ</span> <span class="o">-</span> <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">root</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">maxsz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">maxsz</span><span class="p">[</span><span class="n">root</span><span class="p">])</span><span class="n">root</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">MOD</span><span class="o">=</span><span class="mi">1000000007</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">M</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">%=</span> <span class="n">MOD</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">f</span><span class="p">[</span><span class="n">XN</span><span class="p">][</span><span class="n">XN</span><span class="p">],</span><span class="n">f2</span><span class="p">[</span><span class="n">XN</span><span class="p">][</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">cal</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//é»˜è®¤é€‰ä¸­root
</span><span class="c1"></span>    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">tick</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="n">f</span><span class="p">[</span><span class="n">tick</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">tick</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="n">wage</span><span class="p">[</span><span class="n">re</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">min</span><span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="n">w</span><span class="p">,</span> <span class="n">square</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">to</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">j</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">to</span> <span class="o">&lt;=</span> <span class="n">square</span><span class="p">)</span><span class="n">M</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">to</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
            <span class="k">else</span> <span class="n">M</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">m</span> <span class="o">/</span> <span class="n">to</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">square</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">M</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">/</span> <span class="n">w</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="c1">//ä¸é€‰jï¼Œé‚£ä¹ˆè¦è·³è¿‡æ•´ä¸ªå­æ ‘
</span><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">square</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">M</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">sz</span><span class="p">[</span><span class="n">re</span><span class="p">[</span><span class="n">i</span><span class="p">]]][</span><span class="n">j</span><span class="p">]);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">square</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">M</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">sz</span><span class="p">[</span><span class="n">re</span><span class="p">[</span><span class="n">i</span><span class="p">]]][</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">square</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">M</span><span class="p">(</span><span class="n">res</span> <span class="o">+=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">square</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">M</span><span class="p">(</span><span class="n">res</span> <span class="o">+=</span> <span class="n">f2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
    <span class="c1">//å»æ‰ä¸é€‰rootçš„æƒ…å†µ
</span><span class="c1"></span>    <span class="n">res</span><span class="o">--</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">M</span><span class="p">(</span><span class="n">res</span> <span class="o">+=</span> <span class="n">MOD</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">tick</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">dfs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">M</span><span class="p">(</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">cal</span><span class="p">());</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">SZ</span> <span class="o">=</span> <span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
        <span class="n">root</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">getroot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">solve</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
        <span class="n">square</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">vis</span><span class="p">));</span>
        <span class="n">tick</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">wage</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
            <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">root</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">SZ</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
        <span class="n">getroot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">solve</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä¸€ç‚¹ç‚¹å†³ç­–å•è°ƒæ€§</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/juece-dandiao/" />
            <id>https://blog.kanari.moe/study/juece-dandiao/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-23T18:19:48+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[è‰¹äº†å¤©å¤©éƒ½è¢«ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹æ•™è‚²ï¼ŒçŸ¥é“çš„åˆåšä¸å‡ºæ¥ã€‚ :lei: åœ¨åŠ¨æ€è§„åˆ’ä¸­ï¼Œå†³ç­–å•è°ƒæ€§æŒ‡å¯¹äº$â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>è‰¹äº†å¤©å¤©éƒ½è¢«ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹æ•™è‚²ï¼ŒçŸ¥é“çš„åˆåšä¸å‡ºæ¥ã€‚ :lei:</p>
<p>åœ¨åŠ¨æ€è§„åˆ’ä¸­ï¼Œå†³ç­–å•è°ƒæ€§æŒ‡å¯¹äº$j &lt; j'$ï¼Œ$f(j')$çš„æœ€ä½³è½¬ç§»$f(i')$ä½ç½®$i'$ä¸€å®šä¸å°äº$f(j)$çš„$i$ã€‚</p>
<p>å‡è®¾</p>
<div>$$f(r)=\min{f(k-1)+w(k,r)}$$</div>
<p>ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œé¦–å…ˆå‡è®¾</p>
<div>$$f(r)=f(k-1)+w(k,r)$$</div>
<p>æ­¤æ—¶æˆ‘ä»¬æœ‰$\forall i &lt; k$ï¼Œ</p>
<div>$$f(k-1)+w(k,r) < f(i-1)+w(i,r)$$</div>
<p>æ­¤åï¼Œå°†råæŒª1ã€‚æˆ‘ä»¬å¿…é¡»è¦è¯æ˜$\forall i &lt; k$ï¼Œ</p>
<div>$$f(k-1)+w(k,r+1) < f(i-1)+w(i,r+1)$$</div>
<p>ä¹Ÿå°±æ˜¯è¯æ˜å¯¹äºä¸¤è¾¹çš„ä¸¤ä¸ªå¢é‡$\Delta$æœ‰</p>
<div>$$w(k,r+1) - w(k,r) < w(i,r+1) - w(i,r)$$</div>
<h2 id="ä½¿ç”¨åˆ†æ²»">ä½¿ç”¨åˆ†æ²»</h2>
<p>ä¸€æ—¦æœ‰å†³ç­–å•è°ƒæ€§äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¼˜äº$n^2$çš„æ€»å¤æ‚åº¦å®Œæˆè§„åˆ’ã€‚</p>
<p>ä¾‹å¦‚ä½¿ç”¨åˆ†æ²»ã€‚å½“æˆ‘ä»¬æ‰¾åˆ°åŒºé—´$[ l, r ]$çš„ä¸­ç‚¹$m$çš„å†³ç­–ç‚¹$p$æ—¶ï¼Œé‚£ä¹ˆ$[l, m-1]$åŒºé—´åªèƒ½ä»ä¸æ™šäº$p$è½¬ç§»ï¼Œ$[m+1, r]$åªèƒ½ä»ä¸æ—©äº$p$è½¬ç§»ã€‚</p>
<p>lå’Œræ˜¯å½“å‰è¦å†³ç­–çš„åŒºé—´ï¼ŒLå’ŒRæ˜¯è½¬ç§»ä½ç½®ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;</span><span class="n">r</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">L</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span><span class="n">R</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="c1">//è¿™é‡Œçš„ä¸‹æ ‡å†™æ³•è¦å’Œæ–¹ç¨‹é…å¥—
</span><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">]</span><span class="o">&lt;</span><span class="n">f</span><span class="p">[</span><span class="n">mid</span><span class="p">]){</span>
            <span class="n">f</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">];</span>
            <span class="n">p</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">R</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="cf868fyts1999-doing-minimization">ã€CF868Fã€‘yts1999 Doing Minimization</h2>
<p>You are given an array of n integers a1... an. The cost of a subsegment is the number of unordered pairs of distinct indices within the subsegment that contain equal elements. Split the given array into k non-intersecting non-empty subsegments so that the sum of their costs is minimum possible. Each element should be present in exactly one subsegment.</p>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>è®¾$f(i,j)$è¡¨ç¤ºå‰jä¸ªåˆ†iæ®µã€‚</p>
<p>è¿™ä¸ªé¢˜ç›®å°±æ»¡è¶³å†³ç­–å•è°ƒã€‚ä¸€ä¸ªæ›´é•¿çš„åŒºé—´+1ä¹‹ååªæœ‰å¯èƒ½æ¯”çŸ­çš„åŒºé—´å¢åŠ æ›´å¤šçš„ä»£ä»·ã€‚</p>
<p>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯æ€ä¹ˆç®—è¿™é“é¢˜é‡Œçš„$w(i,j)$ã€‚$n^2$æ˜¾ç„¶ä¸è¡Œã€‚çœ‹åˆ°æœ‰äººæ•´äº†ä¸ªç±»ä¼¼è«é˜Ÿçš„ä¸œè¥¿ï¼Œä¸è¿‡æˆ‘è¿˜æ²¡å¤ªå¼„æ˜ç™½è¿™ä¸ªå¤æ‚åº¦æ˜¯æ€ä¹ˆç®—çš„ï¼Œçœ‹èµ·æ¥æ˜¯å’Œåˆ†æ²»çš„å†…å±‚å¾ªç¯ä¸€è‡´æ‰€ä»¥å°±å¯¹å¤æ‚åº¦æ²¡æœ‰æ›´å¤šçš„è´¡çŒ®äº†ã€‚</p>
<p>ä¸€å…±è¿›è¡Œkè½®åˆ†æ²»ï¼Œ$O(kn\log n)$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">XN</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>

<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="mi">30</span><span class="p">][</span><span class="n">XN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">wage</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">cl</span><span class="p">,</span><span class="n">cr</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">cnt</span><span class="p">[</span><span class="n">XN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">jump</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cl</span><span class="o">&lt;</span><span class="n">l</span><span class="p">){</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cl</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
        <span class="n">wage</span><span class="o">-=</span><span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cl</span><span class="p">]];</span>
        <span class="n">cl</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">cl</span><span class="p">){</span>
        <span class="n">cl</span><span class="o">--</span><span class="p">;</span>
        <span class="n">wage</span><span class="o">+=</span><span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cl</span><span class="p">]];</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cl</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">&lt;</span><span class="n">cr</span><span class="p">){</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cr</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
        <span class="n">wage</span><span class="o">-=</span><span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cr</span><span class="p">]];</span>
        <span class="n">cr</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cr</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
        <span class="n">cr</span><span class="o">++</span><span class="p">;</span>
        <span class="n">wage</span><span class="o">+=</span><span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cr</span><span class="p">]];</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">cr</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;</span><span class="n">r</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">L</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span><span class="n">R</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">jump</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mid</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">wage</span><span class="o">&lt;</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">mid</span><span class="p">]){</span>
            <span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">mid</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">wage</span><span class="p">;</span>
            <span class="n">p</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">solve</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">kk</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">kk</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span> <span class="nl">i</span> <span class="p">:</span> <span class="n">f</span><span class="p">)</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">wage</span><span class="o">+=</span><span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">wage</span><span class="p">;</span>
    <span class="p">}</span>
<span class="c1">//    for(int i=1;i&lt;=n;i++){
</span><span class="c1">//        cout&lt;&lt;f[1][i]&lt;&lt;&amp;#039; &amp;#039;;
</span><span class="c1">//    }
</span><span class="c1">//    cout&lt;&lt;endl;
</span><span class="c1"></span>    <span class="n">wage</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">cl</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">cr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">cnt</span><span class="p">));</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">kk</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">f</span><span class="p">[</span><span class="n">kk</span><span class="p">][</span><span class="n">n</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[HDU 6363] bookshelf</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/hdu-6363-bookshelf/" />
            <id>https://blog.kanari.moe/code/hdu-6363-bookshelf/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-21T18:48:16+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Patrick Star bought a bookshelf, he named it ZYG !! Patrick Star has N book . The ZYG has K layers (count from 1 to K) and there is no limit on the capacity of each layer ! Now Patrick want toâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Patrick Star bought a bookshelf, he named it ZYG !!</p>
<p>Patrick Star has N book .</p>
<p>The ZYG has K layers (count from 1 to K) and there is no limit on the capacity of each layer !</p>
<p>Now Patrick want to put all N books on ZYG :</p>
<ol>
<li>
<p>Assume that the i-th layer has cnti(0â‰¤cntiâ‰¤N) books finally.</p>
</li>
<li>
<p>Assume that f[i] is the i-th fibonacci number (f[0]=0,f[1]=1,f[2]=1,f[i]=f[iâˆ’2]+f[iâˆ’1]).</p>
</li>
<li>
<p>Define the stable value of i-th layers stablei=f[cnti].</p>
</li>
<li>
<p>Define the beauty value of i-th layers beautyi=2stableiâˆ’1.</p>
</li>
<li>
<p>Define the whole beauty value of ZYG score=gcd(beauty1,beauty2,...,beautyk)(Note: gcd(0,x)=x).</p>
</li>
</ol>
<p>Patrick Star wants to know the expected value of score if Patrick choose a distribute method randomly !</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>æˆ‘tmè¿™è¾ˆå­å­¦ä¸ä¼šæ•°è®ºäº†ã€‚</p>
<p>å…ˆæ˜¯ä¸¤ä¸ªã€â€”â€”ã€‘ç»“è®º</p>
<ul>
<li>$\gcd(2^a-1,2^b-1)=2^{\gcd(a,b)}-1$</li>
<li>$\gcd(\text{fib}(a),\text{fib}(b))=\text{fib}(\gcd(a),\gcd(b))$</li>
</ul>
<p>ç„¶ååŸé¢˜çš„scoreå°±å˜æˆ</p>
<div>$$2^{\text{fib}(\gcd(a_1,a_2,\cdots))}-1$$</div>
<p>æ¥ä¸‹æ¥æ‰æœ‰æœºä¼šçæã€‚æšä¸¾gcdï¼Œ$d|n$ï¼Œ$a$çš„åˆ†é…æ–¹å¼æœ‰$C^{n/d+k-1}<em>{k-1}$ç§ã€‚è¿™ç§åˆ†é…åŒ…æ‹¬äº†d'æ˜¯dçš„å€æ•°çš„æ‰€æœ‰æƒ…å†µçš„å¯èƒ½ã€‚ä»¤$F(d)=C^{n/d+k-1}</em>{k-1}$ï¼Œ$f(d)$ä¸ºçœŸæ­£çš„æ•°ç›®ï¼Œäºæ˜¯æœ‰</p>
<div>$$F(d)=\sum_{d|d'}f(d')$$</div>
<p>ä¾ç…§è«æ¯”ä¹Œæ–¯åæ¼”ï¼Œæœ‰</p>
<div>$$f(d)=\sum_{d|d'}\mu(\frac{d'}{d})F(d')$$</div>
<p>äºæ˜¯åŸé¢˜å¾—ä»¥è§£å†³ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä¸€ç‚¹ç‚¹æ‹‰æ ¼æœ—æ—¥æ’å€¼</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/lagrange-polynomial/" />
            <id>https://blog.kanari.moe/study/lagrange-polynomial/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-19T18:18:21+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[æŠ„èµ·æˆ‘çš„æ··å‡åœŸæ•°å­¦ï¼Œå¤ä¹ äº†ä¼šä¸Šå‡ä¸‹é™ç§¯åˆ†ï¼Œçœ‹äº†çœ‹æ–¯ç‰¹æ—æ•°å’Œä¼¯åŠªåˆ©æ•°ã€‚ç»“æœè¯¯æŠŠä¼¯åŠªåˆ©æ•°â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>æŠ„èµ·æˆ‘çš„æ··å‡åœŸæ•°å­¦ï¼Œå¤ä¹ äº†ä¼šä¸Šå‡ä¸‹é™ç§¯åˆ†ï¼Œçœ‹äº†çœ‹æ–¯ç‰¹æ—æ•°å’Œä¼¯åŠªåˆ©æ•°ã€‚ç»“æœè¯¯æŠŠä¼¯åŠªåˆ©æ•°çš„é€’æ¨å¼çœ‹æˆäº†$O(n)$çš„ï¼Œæ”¹äº†åŠå¤©ä¸€åˆ°3æ¬¡æ–¹ä»¥ä¸Šå°±ç¿»è½¦ï¼Œè¿™æ‰ååº”è¿‡æ¥ã€‚</p>
<p>8ä¼šå•Šâ€¦æ‰¾äº†å¾ˆé•¿æ—¶é—´æ‰çŸ¥é“æ˜¯æ‹‰æ ¼æœ—æ—¥æ’å€¼ã€‚</p>
<p>æœ‰è¿™ä¹ˆä¸€æ¡å®šç†ã€‚</p>
<blockquote>
<p>å¹³é¢ä¸Šçš„n+1ä¸ªç‚¹å¯ä»¥ç¡®å®šä¸€ä¸ªnæ¬¡å¤šé¡¹å¼ã€‚</p>
</blockquote>
<p>è€Œ$\sum i^p$æ˜¯ä¸€ä¸ª$p+1$æ¬¡å¤šé¡¹å¼ï¼Œå†µä¸”åœ¨$p \leq 1000000$çš„å‰æä¸‹å¾ˆå®¹æ˜“æ‰¾åˆ°å‰$p+1$ä¸ªç‚¹ã€‚å¦‚æœæˆ‘ä»¬æ‰¾åˆ°ä¸€ç§æ–¹å¼å»æ„é€ è¿™æ ·ä¸€ä¸ªå¤šé¡¹å¼é—®é¢˜å°±è§£å†³äº†ã€‚</p>
<p><del>æ‹‰æ ¼æœ—</del>æå‡ºäº†è¿™ä¹ˆä¸€ç§æ–¹æ³•ã€‚</p>
<h2 id="æ„é€ ">æ„é€ </h2>
<p>è®¾å‡½æ•°</p>
<div>$$\ell_j(x)=\prod_{k \neq j} \frac{x-x_k}{x_j-x_k}$$</div>
<p>æ³¨æ„å…¶ç‰¹æ€§</p>
<ul>
<li>$x_j$è¢«å¸¦å…¥æ—¶ï¼Œå…¶ä¸º$1$</li>
<li>å…¶ä»–ä»»ä½•$x$è¢«å¸¦å…¥æ—¶ï¼Œä¼šå‡ºç°$0$é¡¹ã€‚</li>
</ul>
<p>å› æ­¤è¿™ä¸ªä¸œè¥¿å°±å¯ä»¥ä¸ºä»»ä½•ä¸€ä¸ªç‚¹å¯¹åˆ›å»ºåœ¨å¤šé¡¹å¼ä¸­çš„å•å…ƒ$y_j \ell_j(x_j)$ã€‚å‰©ä¸‹çš„é—®é¢˜æ˜¯å¦‚ä½•å¿«é€Ÿæ±‚è§£ã€‚</p>
<p>å½“æˆ‘ä»¬åªæ±‚å•ç‚¹ï¼ˆç‡å…ˆå¸¦å…¥ç‚¹ï¼‰ï¼Œä¸”æ•´æ•°xè¿ç»­å–å€¼æ—¶ï¼Œè§‚å¯Ÿåˆ°åˆ†æ¯å’Œåˆ†å­éƒ½å˜ä¸ºé˜¶ä¹˜å½¢å¼ï¼Œä¸”åˆ†å¼çš„æ„æˆå…ƒç´ åœ¨å‰åä¸¤é¡¹ä¹‹é—´å…·æœ‰é€’æ¨çš„å…³ç³»ã€‚</p>
<div>$$
\ell_j(x)=\frac{(x-1)(x-2)\cdots (x-(j-1))(x-(j+1))\cdots (x-n)}{(j-1)(j-2) \cdots (j-(j-1))(j-(j+1)) \cdots (j-n))}
$$</div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ†å­å’Œåˆ†æ¯é¡¹éƒ½èƒ½å¤Ÿæ‹†åˆ†ä¸ºå·¦å³ä¸¤ä¸ªéƒ¨åˆ†ã€‚åˆ†åˆ«ç»´æŠ¤å‰ç¼€åç¼€ä¸é˜¶ä¹˜é€†å…ƒå³å¯ã€‚</p>
<p><em>é˜¶ä¹˜å¹¶ä¸éœ€è¦å…¨éƒ¨çš„</em>ï¼Œä»…ä»…æ˜¯å·¦ä¾§å’Œå³ä¾§çš„ä¸€å°éƒ¨åˆ†ã€‚</p>
<h2 id="æ¿å­">æ¿å­</h2>
<p>å«–çš„ï¼Œè‡ªå·±çš„å†™çˆ†äº†è€Œä¸”å·¨ä¸‘ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">lagrange</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">f</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">g</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">!=</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">f</span><span class="o">=</span><span class="mi">1LL</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">mod</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
            <span class="n">g</span><span class="o">=</span><span class="mi">1LL</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">mod</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">upd</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="mi">1LL</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">f</span><span class="o">%</span><span class="n">mod</span><span class="o">*</span><span class="n">inv</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">int</span> <span class="nf">lagrange</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">pre</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">suf</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1LL</span><span class="o">*</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="n">suf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1LL</span><span class="o">*</span><span class="n">suf</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">1LL</span><span class="o">*</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">suf</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="o">*</span><span class="n">inv</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="o">*</span><span class="n">inv</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
        <span class="k">if</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="n">a</span><span class="o">=</span><span class="n">mod</span><span class="o">-</span><span class="n">a</span><span class="p">;</span>
        <span class="n">upd</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="mi">1LL</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="é”™è¯¯çš„ä»£ç ">é”™è¯¯çš„ä»£ç </h2>
<p>è¿™ä»½çœ‹é”™äº†ä¼¯åŠªåˆ©æ•°çš„é€’æ¨å¤æ‚åº¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1000010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">mod</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>


<span class="n">ll</span> <span class="n">inv</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">double</span> <span class="n">B</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">double</span> <span class="n">C</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="c1">//niyuan
</span><span class="c1"></span>    <span class="n">inv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inv</span><span class="p">[</span><span class="n">mod</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">mod</span> <span class="o">-</span> <span class="n">mod</span> <span class="o">/</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//C
</span><span class="c1"></span>    <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="c1">//        C[i]=C[i-1]*(n+1-i+1)%mod*inv[i]%mod;
</span><span class="c1"></span>        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
    
    
    <span class="c1">//WRONG
</span><span class="c1"></span>    <span class="c1">//ä¼¯åŠªåˆ©æ•°çš„é€’æ¨æ˜¯n^2çº§åˆ«çš„ï¼Œç†è§£å¼å­ä¸Šå‡ºç°äº†å¤±è¯¯ã€‚
</span><span class="c1"></span>    <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">s</span><span class="o">=</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="c1">//        B[i]=-inv[i+1]*s%mod;
</span><span class="c1">//        s=(s+B[i]*C[i]%mod)%mod;
</span><span class="c1"></span>        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="n">n2</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>

    <span class="n">init</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">n2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">n2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">n2</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">n2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="c1">//        ans=(ans+C[i]*B[i]%mod*n2[m+1-i]%mod)%mod;
</span><span class="c1"></span>        <span class="n">ans</span><span class="o">=</span><span class="p">(</span><span class="n">ans</span><span class="o">+</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">n2</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="c1">//    (ans*=inv[m+1])%=mod;
</span><span class="c1"></span>    <span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>


<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä»½è‡ªå·±yyçš„æ‹‰æ ¼æœ—æ—¥æ’å€¼åœ¨é˜¶ä¹˜çš„æ±‚æ³•ä¸Šæœ‰é—®é¢˜ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1000010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">mod</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>

<span class="n">ll</span> <span class="n">fac</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">facinv</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">inv</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="o">=</span><span class="n">mod</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">get_inv</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="o">=</span><span class="n">mod</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">qpow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">Fac</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">bool</span> <span class="n">pos</span><span class="o">=</span><span class="nb">true</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">flg</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">pos</span> <span class="o">&amp;&amp;</span> <span class="n">n</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">flg</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">fac</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">flg</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">Invfac</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">bool</span> <span class="n">pos</span><span class="o">=</span><span class="nb">true</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">flg</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">pos</span> <span class="o">&amp;&amp;</span> <span class="n">n</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">flg</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">facinv</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">flg</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">fac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">fac</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">fac</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
    <span class="n">facinv</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">get_inv</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="n">facinv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">facinv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">facinv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

    <span class="n">inv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">inv</span><span class="p">[</span><span class="n">mod</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">mod</span><span class="o">-</span><span class="n">mod</span><span class="o">/</span><span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">mod</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">yy</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">M</span><span class="o">=</span><span class="n">m</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">init</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">qpow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">yy</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">cell</span><span class="o">=</span><span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Fac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="o">*</span><span class="n">Invfac</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="o">*</span><span class="n">inv</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">mod</span><span class="p">;</span>
        <span class="p">(</span><span class="n">cell</span><span class="o">*=</span><span class="n">Invfac</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">%=</span><span class="n">mod</span><span class="p">;</span>
        <span class="p">(</span><span class="n">cell</span><span class="o">*=</span><span class="n">Invfac</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">M</span><span class="p">),</span><span class="nb">false</span><span class="p">))</span><span class="o">%=</span><span class="n">mod</span><span class="p">;</span>
        <span class="p">(</span><span class="n">ans</span><span class="o">+=</span><span class="n">cell</span><span class="p">)</span><span class="o">%=</span><span class="n">mod</span><span class="p">;</span>
<span class="c1">//        ll cell=yy[i]*Fac(n-1)/Fac(n-M-1)/(n-i);
</span><span class="c1">//        cell/=Fac(i-1);
</span><span class="c1">//        cell/=Fac(abs(i-M),false);
</span><span class="c1">//        ans+=cell;
</span><span class="c1"></span>    <span class="p">}</span>

    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ans</span><span class="o">+</span><span class="n">mod</span><span class="p">)</span><span class="o">%</span><span class="n">mod</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Spring Training 3</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/spring-training-3/" />
            <id>https://blog.kanari.moe/code/spring-training-3/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-19T09:38:52+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[HDU6319 Ascending Rating Before the start of contest, there are n ICPC contestants waiting in a long queue. They are labeled by 1 to n from left to right. It can be easily found that the i-th contestant's QodeForces rating is ai.â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="hdu6319-ascending-rating">HDU6319 Ascending Rating</h2>
<p>Before the start of contest, there are n ICPC contestants waiting in a long queue. They are labeled by 1 to n from left to right. It can be easily found that the i-th contestant's QodeForces rating is ai.
Little Q, the coach of Quailty Normal University, is bored to just watch them waiting in the queue. He starts to compare the rating of the contestants. He will pick a continous interval with length m, say [l,l+mâˆ’1], and then inspect each contestant from left to right. Initially, he will write down two numbers maxrating=âˆ’1 and count=0. Everytime he meets a contestant k with strictly higher rating than maxrating, he will change maxrating to ak and count to count+1.
Little T is also a coach waiting for the contest. He knows Little Q is not good at counting, so he is wondering what are the correct final value of maxrating and count. Please write a program to figure out the answer.</p>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>ä¸€å¼€å§‹æƒ³ç€ä»å·¦åˆ°å³æ»‘åŠ¨çª—å£ç»´æŠ¤ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ï¼Œç»“æœå‘ç°æ²¡æ³•ç»Ÿè®¡countã€‚</p>
<p>åå‘æ»‘åŠ¨å°±å¥½äº†ï¼Œæˆ‘è¿˜æ²¡å¤ªååº”è¿‡æ¥ä¸ºå•¥ã€‚å”¯ä¸€æ‰ä½çš„ä¸€ç‚¹æƒ³æ³•æ˜¯â€œæ•°æ®æ— ç”¨â€çš„æ—¶åˆ»ã€‚åœ¨æ­£å‘ç»´æŠ¤æ—¶ï¼Œåæƒ³åŠ å…¥ä½†æ˜¯æœªè¢«åŠ å…¥çš„å…ƒç´ å¯èƒ½å› ä¸ºå‰è€…popæ‰è€Œæ¼æ‰ï¼Œä½†æ˜¯åå‘ç»´æŠ¤æ—¶åªä¼šå¼¹å‡ºå·²ç»ä½¿ç”¨çš„æ— ç”¨å…ƒç´ ï¼Œä»»ä½•æ—¶å€™æ–°å…ƒç´ éƒ½ä¼šè¢«åŠ å…¥ã€‚</p>
<h2 id="hdu6331-walking-plan">HDU6331 Walking Plan</h2>
<p>There are n intersections in Bytetown, connected with m one way streets. Little Q likes sport walking very much, he plans to walk for q days. On the i-th day, Little Q plans to start walking at the si-th intersection, walk through at least ki streets and finally return to the ti-th intersection.
Little Q's smart phone will record his walking route. Compared to stay healthy, Little Q cares the statistics more. So he wants to minimize the total walking length of each day. Please write a program to help him find the best route.</p>
<h3 id="åˆ†æ-1">åˆ†æ</h3>
<p>â€¦â€¦æœç„¶è¿˜æ˜¯èœï¼Œåˆ«äººè¿‡å¾—åƒé£ä¸€æ ·ã€‚å…ˆæ˜¯è¯»é”™äº†é¢˜ï¼ŒæŠŠki streetsç†è§£æˆäº†è·¯å¾„æƒçš„é™åˆ¶ï¼Œå°±ç¿»äº†è½¦ã€‚åå‘ç°æ˜¯kæ¡ä¹‹åï¼ŒçŒœäº†å‘æ˜¯ä¸æ˜¯å€å¢ï¼Œåˆäº‰æ‰§äº†å¾ˆä¹…åˆ°åº•æœ€çŸ­è·¯èƒ½ä¸èƒ½è¹¦ã€‚æœ€åç»“è®ºæ˜¯å¤§æ¦‚å¯ä»¥è¹¦ã€‚ï¼ˆæ—¢ç„¶è¿‡äº†é‚£å°±ä¹Ÿæ˜¯äº†ï¼‰</p>
<p>ç»“æœå‘ç°å€å¢çš„è¯ç­”æ¡ˆæ²¡æ³•ç»Ÿè®¡ã€‚å¤§å“¥ä»¬è¯´åˆ†å—ï¼Œæ‰ç»ˆäºçœ‹åˆ°äº†ä¸€ç‚¹å¸Œæœ›ã€‚waäº†æ•°å‘æ‰è¿‡ã€‚</p>
<h2 id="hdu6325-interstellar-travel">HDU6325 Interstellar Travel</h2>
<p>After trying hard for many years, Little Q has finally received an astronaut license. To celebrate the fact, he intends to buy himself a spaceship and make an interstellar travel.
Little Q knows the position of n planets in space, labeled by 1 to n. To his surprise, these planets are all coplanar. So to simplify, Little Q put these n planets on a plane coordinate system, and calculated the coordinate of each planet (xi,yi).
Little Q plans to start his journey at the 1-th planet, and end at the n-th planet. When he is at the i-th planet, he can next fly to the j-th planet only if xi&lt;xj, which will cost his spaceship xiÃ—yjâˆ’xjÃ—yi units of energy. Note that this cost can be negative, it means the flight will supply his spaceship.
Please write a program to help Little Q find the best route with minimum total cost.</p>
<h3 id="åˆ†æ-2">åˆ†æ</h3>
<p>è¿™é¢˜å¦‚æœä½ åœ¨aå’Œbä¸¤ç‚¹ä¹‹é—´æ‰¾ç¬¬ä¸‰ç‚¹ï¼Œç„¶åè®¡ç®—ä»£ä»·å·®ï¼Œå°±ä¼šå‘ç°æœ€ç»ˆçš„ä»£ä»·é‡Œå‡ºç°äº†aåˆ°bçš„ç›´çº¿æ–¹ç¨‹ã€‚ä»£ä»·å˜æˆäº†è¯¥ç›´çº¿ä¸Šç¬¬ä¸‰ç‚¹çš„å€¼å’ŒçœŸå®å€¼çš„å·®ï¼Œ <del>å¯æ˜¯è§é¬¼äº†è¿™æ˜¯æ€ä¹ˆå‘ç°çš„ã€‚</del></p>
<p>ç»“è®ºæ˜¯ä¸€ä¸ªç‚¹åœ¨ç›´çº¿ä¹‹ä¸Šï¼Œå°±è¦è¿›è¡Œä¸­è½¬ã€‚æ‰€ä»¥æœ€ç»ˆç­”æ¡ˆå¤§æ–¹å‘æ˜¯æ±‚ä¸€ä¸ªå‡¸åŒ…ã€‚</p>
<h2 id="hdu6321-dynamic-graph-matching">HDU6321 Dynamic Graph Matching</h2>
<p>In the mathematical discipline of graph theory, a matching in a graph is a set of edges without common vertices.
You are given an undirected graph with n vertices, labeled by 1,2,...,n. Initially the graph has no edges.
There are 2 kinds of operations :</p>
<ul>
<li>u v, add an edge (u,v) into the graph, multiple edges between same pair of vertices are allowed.</li>
</ul>
<ul>
<li>u v, remove an edge (u,v), it is guaranteed that there are at least one such edge in the graph.
Your task is to compute the number of matchings with exactly k edges after each operation for k=1,2,3,...,n2. Note that multiple edges between same pair of vertices are considered different.</li>
</ul>
<h3 id="åˆ†æ-3">åˆ†æ</h3>
<p>æ•°æ®èŒƒå›´èƒ½å¤ŸçŠ¶å‹ã€‚</p>
<p>ç”¨$f(i,state)$è¡¨ç¤ºæ­¤æ¬¡æ“ä½œå®Œåï¼Œå·²ç»é€‰æ‹©çš„ç‚¹æœ‰stateæ‰€èƒ½æ„æˆçš„æ–¹æ¡ˆæ•°ã€‚å¯¹äºåŠ è¾¹uvï¼Œå°±æœ‰å¦‚ä¸‹è½¬ç§»ã€‚è¡¨ç¤ºåœ¨æœªé€‰æ‹©uvçš„å·²åŒ¹é…çŠ¶æ€é‡Œå†é€‰ä¸Šuvæ„æˆæ–°stateã€‚</p>
<div>$$f(i,s)=\sum f(i-1,s-\{u,v\})$$</div>
<p>è¡¨ç¤ºåœ¨åˆ é™¤uvæ—¶ï¼Œä»æ–¹æ¡ˆä¸­å†æ¬¡æ‰£å»è¿™äº›çŠ¶æ€ã€‚</p>
<div>$$f(i,s)-=f(i,s-\{u,v\})$$</div>
<p>æŠŠç¬¬ä¸€ç»´æ»šåŠ¨æ‰ï¼Œè¿™ä¸¤ä¸ªå…¬å¼å¯¹è½¬ç§»é¡ºåºæ²¡æœ‰è¦æ±‚ï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä¸ä¼šæ›´æ–°è¢«ç”¨æ¥è½¬ç§»çš„çŠ¶æ€ï¼Œçæ°å†™ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[???] Builds Sequences</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/builds-sequences/" />
            <id>https://blog.kanari.moe/code/builds-sequences/</id>
            <updated>2020-04-08T20:49:13+08:00</updated>
            <published>2020-03-18T11:56:43+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Alice æƒ³è¦å¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º n çš„åºåˆ—ï¼Œåºåˆ—ä¸­çš„æ•°éƒ½æ˜¯ä¸è¶…è¿‡ m çš„æ­£æ•´æ•°ï¼Œè€Œä¸”è¿™ n ä¸ªæ•°çš„å’Œæ˜¯ p çš„â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Alice æƒ³è¦å¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º n çš„åºåˆ—ï¼Œåºåˆ—ä¸­çš„æ•°éƒ½æ˜¯ä¸è¶…è¿‡ m çš„æ­£æ•´æ•°ï¼Œè€Œä¸”è¿™ n ä¸ªæ•°çš„å’Œæ˜¯ p çš„å€æ•°ã€‚</p>
<p>Alice è¿˜å¸Œæœ›ï¼Œè¿™ n ä¸ªæ•°ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ•°æ˜¯è´¨æ•°ã€‚</p>
<p>Alice æƒ³çŸ¥é“ï¼Œæœ‰å¤šå°‘ä¸ªåºåˆ—æ»¡è¶³å¥¹çš„è¦æ±‚ã€‚</p>
<div>$$1 \leq n \leq 10 ^ 9, 1 \leq m \leq 2 \times 10 ^ 7, 1 \leq p \leq 100$$</div>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é¢˜åšå¾—å¾ˆçˆ½â€¦</p>
<p>é¦–å…ˆæ˜¯ä¸€ä¸ªå¥—è·¯ï¼Œç»´æŠ¤å€æ•°å¯ä»¥è½¬ä¸ºç»´æŠ¤å½“å‰å’Œçš„æ¨¡ã€‚å› æ­¤å¦‚æœé€’æ¨çš„è¯ï¼Œåªéœ€è¦100ä¸ªçŠ¶æ€ï¼Œçœ‹èµ·æ¥æ˜¯å¯åšçš„ã€‚ä½†æ˜¯è¿™ä¸ªnçš„èŒƒå›´å®åœ¨æ˜¯æœ‰ç‚¹ï¼Œå…ˆåˆ—ä¸€ä¸‹å†è¯´ã€‚</p>
<p>æŠŠ2e7ä¸ªæ•°å­—å…¨éƒ¨æ¨¡å®Œï¼Œå®ƒä»¬å¯¹ç­”æ¡ˆçš„è´¡çŒ®åªå’Œå‰©ä½™ç±»æœ‰å…³ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½çŸ¥é“åœ¨å’Œçš„æ¨¡ä¸ºaæ—¶æœ‰å¤šå°‘ç§æ–¹æ¡ˆèƒ½å¤Ÿå‡‘åˆ°bäº†ã€‚å¾—å‡ºé€’æ¨æ–¹ç¨‹</p>
<div>$$
f(i,j)=\sum_{0 \leq k < p} f(i-1,(j-k) \mod 3)c(k)
$$</div>
<p>å…¶ä¸­$c(k)$æ˜¯æ¨¡ä¸ºkçš„æ•°æœ‰å¤šå°‘ä¸ªã€‚</p>
<p>è‡³å°‘æœ‰ä¸€ä¸ªè´¨æ•°çš„æ¡ä»¶è½¬ä¸ºæ— è´¨æ•°ï¼Œä»æ‰€æœ‰çš„cä¸­æ‰£å»è´¨æ•°åå†ç®—ä¸€éæ–¹æ¡ˆæ•°ï¼ŒäºŒè€…ç›¸å‡ã€‚</p>
<p>æœ€åï¼Œå…³äºnï¼Œè¿™ä¸ªå…¬å¼èƒ½å¤Ÿç”¨å¿«é€Ÿå¹‚åŠ é€Ÿã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">110</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXM</span><span class="o">=</span><span class="mi">20000010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MOD</span><span class="o">=</span><span class="mi">20170408</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">isnp</span><span class="p">[</span><span class="n">MAXM</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">isnp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">isnp</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">primes</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">isnp</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="nc">Mat</span><span class="p">{</span>
    <span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>

    <span class="n">Mat</span><span class="p">(){</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="n">Mat</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Mat</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">){</span>
        <span class="n">Mat</span> <span class="n">res</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
                    <span class="n">res</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">other</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">%</span><span class="n">MOD</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">debug</span><span class="p">(){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">normalize</span><span class="p">(){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">Mat</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">Mat</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
    <span class="n">Mat</span> <span class="n">res</span><span class="p">;</span>
    <span class="n">res</span><span class="p">.</span><span class="n">normalize</span><span class="p">();</span>

    <span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">Mat</span> <span class="n">base</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">pool</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">nopool</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">Mat</span> <span class="n">incprime</span><span class="p">,</span><span class="n">noprime</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">nopool</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="n">p</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">init</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">it</span><span class="p">:</span><span class="n">primes</span><span class="p">){</span>
        <span class="n">nopool</span><span class="p">[</span><span class="n">it</span><span class="o">%</span><span class="n">p</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span>

<span class="c1">//    for(auto it:nopool){
</span><span class="c1">//        cout&lt;&lt;it&lt;&lt;&#34; &#34;;
</span><span class="c1">//    }
</span><span class="c1">//    cout&lt;&lt;endl;
</span><span class="c1"></span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">p</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">p</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="c1">//cout&lt;&lt;((i-1-(j-1))%p+p)%p&lt;&lt;endl;
</span><span class="c1"></span>            <span class="n">incprime</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">pool</span><span class="p">[((</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">p</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">p</span><span class="p">];</span>
            <span class="n">noprime</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">nopool</span><span class="p">[((</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">p</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="o">%</span><span class="n">p</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">base</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

    <span class="n">incprime</span><span class="o">=</span><span class="n">base</span><span class="o">*</span><span class="n">qpow</span><span class="p">(</span><span class="n">incprime</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
<span class="c1">//    incprime.debug();
</span><span class="c1"></span>    <span class="n">noprime</span><span class="o">=</span><span class="n">base</span><span class="o">*</span><span class="n">qpow</span><span class="p">(</span><span class="n">noprime</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
<span class="c1">//    noprime.debug();
</span><span class="c1"></span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">((</span><span class="n">incprime</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">noprime</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="o">+</span><span class="n">MOD</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E5%BF%AB%E9%80%9F%E5%B9%82/" term="å¿«é€Ÿå¹‚" label="å¿«é€Ÿå¹‚" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1322C] Instant Noodles</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1322c-instant-noodles/" />
            <id>https://blog.kanari.moe/code/cf-1322c-instant-noodles/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-08T16:32:30+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Wu got hungry after an intense training session, and came to a nearby store to buy his favourite instant noodles. After Wu paid for his purchase, the cashier gave him an interesting task. You are given a bipartite graph with positive integersâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Wu got hungry after an intense training session, and came to a nearby store to buy his favourite instant noodles. After Wu paid for his purchase, the cashier gave him an interesting task.</p>
<p>You are given a bipartite graph with positive integers in all vertices of the right half. For a subset ğ‘† of vertices of the left half we define ğ‘(ğ‘†) as the set of all vertices of the right half adjacent to at least one vertex in ğ‘†, and ğ‘“(ğ‘†) as the sum of all numbers in vertices of ğ‘(ğ‘†). Find the greatest common divisor of ğ‘“(ğ‘†) for all possible non-empty subsets ğ‘† (assume that GCD of empty set is 0).</p>
<p>Wu is too tired after his training to solve this problem. Help him!</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é“é¢˜çš„èŒƒå›´æœ‰500000ä¹‹å¤§ï¼Œæ‰€ä»¥å®åœ¨æ˜¯æ— æ³•ä»å­é›†æœ¬èº«å…¥æ‰‹ï¼Œåªèƒ½è€ƒè™‘ä¸€ä¸‹gcdæ˜¯å¦å­˜åœ¨æ€§è´¨ã€‚</p>
<p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªå­é›†$a$ï¼Œå½“æˆ‘ä»¬ä¸ºå…¶åŠ ä¸Šä¸€ä¸ª$\Delta$åï¼Œè¿™ä¸¤ä¸ªç»“æœéƒ½ä¼šå‚ä¸gcdçš„è®¡ç®—ï¼Œæ›´ç›¸å‡æŸåè¡¨ç°ä¸º$\Delta$å‚ä¸gcdè®¡ç®—ã€‚</p>
<p>è¿™ä¸ª$\Delta$çš„å¢é‡ç›´æ¥è´¡çŒ®ç­”æ¡ˆçš„ç‰¹æ€§å¯èƒ½æ˜¯é‡è¦çš„ä¸€ç¯ã€‚æ¯”èµ›æ—¶å› ä¸ºæ—¶é—´ä¹Ÿå¥½ï¼Œåˆ«çš„ä¹Ÿç½¢ï¼Œè¢«å¡åœ¨è¿™è‡ªé—­ä¸ä¼šäº†ã€‚</p>
<p>æ¥ä¸‹æ¥ç¡®å®šå¢é‡æ˜¯ä»€ä¹ˆã€‚</p>
<p>æ˜¯å¦æ˜¯å•ç‹¬çš„ä¸€ä¸ªå…ƒç´ ï¼šå¯¹äºä¸€ä¸ªå³èŠ‚ç‚¹$v$ï¼Œæ˜¯å¦å­˜åœ¨æ·»åŠ ä¸€ä¸ªå·¦èŠ‚ç‚¹ååªå¢åŠ å…¶ä¸€ä¸ªçš„æƒ…å†µã€‚å¹²è„†æŠŠå…¨éƒ¨çš„å·¦èŠ‚ç‚¹å…¨éƒ¨é€‰ä¸­ï¼Œç„¶ååˆ æ‰åŒ…å«$v$çš„ã€‚æ¥ä¸‹æ¥ï¼Œè§‚å¯Ÿæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå·¦èŠ‚ç‚¹åªå¢åŠ $v$ã€‚è¿™æ˜¾ç„¶ä¼šæœ‰ä¸å­˜åœ¨çš„æƒ…å†µã€‚</p>
<p>åœ¨ä¸å­˜åœ¨çš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬æœ‰è¿™äº›ç»“è®ºã€‚å‡è®¾è¿™ä¸ªæ£ä¹±çš„èŠ‚ç‚¹æ˜¯$v'$</p>
<ul>
<li>$v'$ç”±äºåˆ é™¤æ‰€æœ‰åŒ…å«$v$çš„èŠ‚ç‚¹è€Œè¢«å…±åŒåˆ é™¤ã€‚</li>
<li>$v'$æ— æ³•è¢«ä¸åŒ…å«$v$çš„å…¶ä»–èŠ‚ç‚¹å¢åŠ ï¼Œé‚£ä¹ˆèƒ½å¢åŠ $v'$çš„èŠ‚ç‚¹å®šåŒ…å«$v$ã€‚</li>
</ul>
<p>æ­¤æ—¶æœ‰ä¸¤ç§æƒ…å†µã€‚</p>
<ul>
<li>æ‰€æœ‰æ·»åŠ vçš„èŠ‚ç‚¹å‡åŒ…å«$v'$ã€‚é‚£ä¹ˆäºŒè€…å…±è¿›é€€ï¼Œè¡¨ç°ä¸ºæ†ç»‘åœ¨ä¸€èµ·çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>
<li>å¹¶ä¸æ˜¯æ‰€æœ‰æ·»åŠ vçš„èŠ‚ç‚¹å‡åŒ…å«$v'$ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡æ·»åŠ åˆ«çš„èŠ‚ç‚¹ç‡å…ˆåŠ ä¸Švï¼Œä»è€Œèƒ½å¤Ÿå•ç‹¬æ·»åŠ v'ï¼Œä»è€Œèƒ½å¤Ÿå•ç‹¬æ·»åŠ vã€‚
æ‰€ä»¥ï¼Œè¿™ä¸ªå¢é‡ä¸æ˜¯å•ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ï¼šé‚»åŸŸç›¸åŒçš„å…ƒç´ ã€‚</li>
</ul>
<p>å¯ä»¥åšäº†ï¼Ÿâ€¦â€¦å¤ªèœï¼Œæä¸æ˜ç™½è¿™æ€ä¹ˆåœ¨æ¯”èµ›æœŸé—´çŸ­æœŸæŠ˜è…¾å‡ºæ¥ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1320C] World of Darkraft: Battle for Azathoth</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1320c-world-of-darkraft-battle-for-azathoth/" />
            <id>https://blog.kanari.moe/code/cf-1320c-world-of-darkraft-battle-for-azathoth/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-08T12:58:45+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Roma is playing a new expansion for his favorite game World of Darkraft. He made a new character and is going for his first grind. Roma has a choice to buy exactly one of ğ‘› different weapons and exactly one of ğ‘šâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Roma is playing a new expansion for his favorite game World of Darkraft. He made a new character and is going for his first grind.</p>
<p>Roma has a choice to buy exactly one of ğ‘› different weapons and exactly one of ğ‘š different armor sets. Weapon ğ‘– has attack modifier ğ‘ğ‘– and is worth ğ‘ğ‘ğ‘– coins, and armor set ğ‘— has defense modifier ğ‘ğ‘— and is worth ğ‘ğ‘ğ‘— coins.</p>
<p>After choosing his equipment Roma can proceed to defeat some monsters. There are ğ‘ monsters he can try to defeat. Monster ğ‘˜ has defense ğ‘¥ğ‘˜, attack ğ‘¦ğ‘˜ and possesses ğ‘§ğ‘˜ coins. Roma can defeat a monster if his weapon's attack modifier is larger than the monster's defense, and his armor set's defense modifier is larger than the monster's attack. That is, a monster ğ‘˜ can be defeated with a weapon ğ‘– and an armor set ğ‘— if ğ‘ğ‘–&gt;ğ‘¥ğ‘˜ and ğ‘ğ‘—&gt;ğ‘¦ğ‘˜. After defeating the monster, Roma takes all the coins from them. During the grind, Roma can defeat as many monsters as he likes. Monsters do not respawn, thus each monster can be defeated at most one.</p>
<p>Thanks to Roma's excessive donations, we can assume that he has an infinite amount of in-game currency and can afford any of the weapons and armor sets. Still, he wants to maximize the profit of the grind. The profit is defined as the total coins obtained from all defeated monsters minus the cost of his equipment. Note that Roma must purchase a weapon and an armor set even if he can not cover their cost with obtained coins.</p>
<p>Help Roma find the maximum profit of the grind.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é¢˜ä»£è¡¨äº†ä¸€ç±»åŸºæœ¬çš„æ€è·¯ã€‚æšä¸¾å…¶ä¸­ä¸€ç»´ï¼Œç”¨æ•°æ®ç»“æ„ç»´æŠ¤å¦ä¸€ç»´ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æšä¸¾æ­¦å™¨æ”»å‡»åŠ›ï¼Œé¦–å…ˆèƒ½å¤ŸæŒ‘å‡ºæ‰€æœ‰è¢«å‡»æ€çš„æ€ªç‰©ã€‚å½“æˆ‘ä»¬çš„é˜²å…·ä¸ºkæ—¶ï¼Œæ‰€æœ‰æ”»å‡»åŠ›å°äºkçš„éƒ½å¯ä»¥è®¡ç®—æ”¶ç›Šã€‚åè¿‡æ¥è¯´ï¼Œå¯¹äºæ”»å‡»åŠ›ä¸ºkçš„æ€ªç‰©ï¼Œåªè¦æˆ‘ä»¬çš„é˜²å…·å¤§äºkï¼Œå°±å¯ä»¥è®¡ç®—æ”¶ç›Šã€‚</p>
<p>æ‰€ä»¥æ¯æšä¸¾ä¸€ä¸ªä¸»è§’æ”»å‡»åŠ›ï¼Œæˆ‘ä»¬æŠŠæ€ªç‰©æŒ‰ç…§å…¶æ”»å‡»åŠ›ä¸ºä¸‹æ ‡ä½œæ”¶ç›Šå‰ç¼€å’Œï¼Œå°±å¯ä»¥è·å–åˆ°å½“ä¸»è§’é˜²å…·ä¸ºkæ—¶æ‰€èƒ½å¾—åˆ°çš„æ”¶ç›Šã€‚ä¸ºäº†è®¡ç®—å…¥é˜²å…·çš„èŠ±è´¹ï¼Œé¢„å¤„ç†æ¯ä¸ªé˜²å…·ç­‰çº§kæ‰€éœ€è¦çš„æœ€å°‘çš„é’±ï¼Œé¢„å…ˆåœ¨ç›¸åº”ä¸‹æ ‡æ‰£é™¤ã€‚æ­¤æ—¶è¿˜éœ€è¦ä¸€ä¸ªç»“æ„æ¥æ±‚å»æ‰€æœ‰å‰ç¼€å’Œä¸­æœ€å¤§ã€‚è¿™äº›æ“ä½œéƒ½å¯ä»¥ç”¨çº¿æ®µæ ‘å®Œæˆã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;limits&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1000100</span><span class="o">*</span><span class="mi">4</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">award</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">cost</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">flag</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">root</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">wlen</span><span class="p">,</span><span class="n">alen</span><span class="p">,</span><span class="n">mlen</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Weapon</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">rnk</span><span class="p">,</span> <span class="n">cost</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Weapon</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="c1">//if (rnk == b.rnk)return cost &lt; b.cost;å®é™…æ²¡ç”¨
</span><span class="c1"></span>        <span class="k">return</span> <span class="n">rnk</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">rnk</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">weapons</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="k">struct</span> <span class="nc">Armor</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">rnk</span><span class="p">,</span> <span class="n">cost</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Armor</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rnk</span> <span class="o">==</span> <span class="n">b</span><span class="p">.</span><span class="n">rnk</span><span class="p">)</span><span class="k">return</span> <span class="n">cost</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">cost</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">rnk</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">rnk</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">armors</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">collect</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">award</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">award</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]],</span><span class="n">award</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">pushdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">]){</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">award</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">award</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//æšä¸¾æ­¦å™¨ï¼Œç»´æŠ¤é˜²å…·
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">init</span><span class="o">=-</span><span class="mh">0x3f3f3f3f</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="n">n</span> <span class="o">=</span> <span class="o">++</span><span class="n">idx</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">award</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=-</span><span class="n">cost</span><span class="p">[</span><span class="n">l</span><span class="p">];</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span><span class="n">init</span><span class="p">);</span>
    <span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span><span class="n">init</span><span class="p">);</span>
    <span class="n">collect</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">award</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mid</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>

    <span class="n">collect</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">query</span><span class="p">(){</span>
    <span class="k">return</span> <span class="n">award</span><span class="p">[</span><span class="n">root</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">award</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

    <span class="n">ll</span> <span class="n">res</span><span class="o">=-</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]));</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="nc">Monster</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">att</span><span class="p">,</span><span class="n">de</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cost</span><span class="p">;</span>
<span class="p">}</span> <span class="n">monsters</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">debug</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">query</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">root</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">wlen</span> <span class="o">&gt;&gt;</span> <span class="n">alen</span> <span class="o">&gt;&gt;</span> <span class="n">mlen</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">vallim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">wlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">weapons</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rnk</span> <span class="o">&gt;&gt;</span> <span class="n">weapons</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">alen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">armors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rnk</span><span class="o">&gt;&gt;</span><span class="n">armors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">mlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">monsters</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">de</span><span class="o">&gt;&gt;</span><span class="n">monsters</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">att</span><span class="o">&gt;&gt;</span><span class="n">monsters</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="p">;</span>

    <span class="n">sort</span><span class="p">(</span><span class="n">weapons</span><span class="p">,</span><span class="n">weapons</span><span class="o">+</span><span class="n">wlen</span><span class="p">);</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">monsters</span><span class="p">,</span><span class="n">monsters</span><span class="o">+</span><span class="n">mlen</span><span class="p">,[](</span><span class="k">auto</span> <span class="n">a</span><span class="p">,</span><span class="k">auto</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">de</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">de</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="n">fill</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span><span class="n">cost</span><span class="o">+</span><span class="n">MAXN</span><span class="p">,</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">());</span>
    <span class="kt">int</span> <span class="n">maxarm</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">alen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cost</span><span class="p">[</span><span class="n">armors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rnk</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">cost</span><span class="p">[</span><span class="n">armors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rnk</span><span class="p">],</span><span class="n">armors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="p">);</span>
        <span class="n">maxarm</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxarm</span><span class="p">,</span><span class="n">armors</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rnk</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">maxarm</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxarm</span><span class="p">);</span>
    <span class="c1">//debug(maxarm);
</span><span class="c1"></span>
    <span class="n">ll</span> <span class="n">ans</span><span class="o">=-</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">wlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">while</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;</span><span class="n">mlen</span> <span class="o">&amp;&amp;</span> <span class="n">monsters</span><span class="p">[</span><span class="n">ptr</span><span class="p">].</span><span class="n">de</span><span class="o">&lt;</span><span class="n">weapons</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">rnk</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">monsters</span><span class="p">[</span><span class="n">ptr</span><span class="p">].</span><span class="n">att</span><span class="o">&lt;</span><span class="n">maxarm</span><span class="p">){</span>
                <span class="n">modify</span><span class="p">(</span><span class="n">monsters</span><span class="p">[</span><span class="n">ptr</span><span class="p">].</span><span class="n">cost</span><span class="p">,</span><span class="n">monsters</span><span class="p">[</span><span class="n">ptr</span><span class="p">].</span><span class="n">att</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">maxarm</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxarm</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">ptr</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">query</span><span class="p">()</span><span class="o">-</span><span class="n">weapons</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>


    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1321C] Remove Adjacent æ‹“å±•</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1321c-remove-adjacent/" />
            <id>https://blog.kanari.moe/code/cf-1321c-remove-adjacent/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-03-02T10:41:30+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[æ²¡æ³¨æ„åˆ°æ•°æ®èŒƒå›´æ˜¯100ã€‚ You are given a string ğ‘  consisting of lowercase Latin letters. Let the length of ğ‘  be |ğ‘ |. You may perform several operations on this string.â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>æ²¡æ³¨æ„åˆ°æ•°æ®èŒƒå›´æ˜¯100ã€‚</p>
<p>You are given a string ğ‘  consisting of lowercase Latin letters. Let the length of ğ‘  be |ğ‘ |. You may perform several operations on this string.</p>
<p>In one operation, you can choose some index ğ‘– and remove the ğ‘–-th character of ğ‘  (ğ‘ ğ‘–) if at least one of its adjacent characters is the previous letter in the Latin alphabet for ğ‘ ğ‘–. For example, the previous letter for b is a, the previous letter for s is r, the letter a has no previous letters. Note that after each removal the length of the string decreases by one. So, the index ğ‘– should satisfy the condition 1â‰¤ğ‘–â‰¤|ğ‘ | during each operation.</p>
<p>For the character ğ‘ ğ‘– adjacent characters are ğ‘ ğ‘–âˆ’1 and ğ‘ ğ‘–+1. The first and the last characters of ğ‘  both have only one adjacent character (unless |ğ‘ |=1).</p>
<p>Consider the following example. Let ğ‘ = bacabcab.</p>
<p>During the first move, you can remove the first character ğ‘ 1= b because ğ‘ 2= a. Then the string becomes ğ‘ = acabcab.
During the second move, you can remove the fifth character ğ‘ 5= c because ğ‘ 4= b. Then the string becomes ğ‘ = acabab.
During the third move, you can remove the sixth character ğ‘ 6='b' because ğ‘ 5= a. Then the string becomes ğ‘ = acaba.
During the fourth move, the only character you can remove is ğ‘ 4= b, because ğ‘ 3= a (or ğ‘ 5= a). The string becomes ğ‘ = acaa and you cannot do anything with it.
Your task is to find the maximum possible number of characters you can remove if you choose the sequence of operations optimally.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>æ¢ä¸ªè§†è§’æ¥çœ‹æ¶ˆé™¤ï¼Œå½“æœ‰bæ—¶ï¼Œæˆ‘ä»¬å°±èƒ½ä¿è¯æ‰€æœ‰èƒ½æ¥è§¦åˆ°è¿™ä¸ªbçš„cè¢«æ¶ˆé™¤ã€‚</p>
<p>æ‰€ä»¥ä»å¤§å¾€å°äº†åšï¼Œæšä¸¾æ¯ä¸€ä¸ªå­—æ¯$s$ï¼Œç„¶åæšä¸¾sçš„ä½ç½®å»æŸ¥è¯¢å®ƒå·¦å³æ˜¯å¦æœ‰èƒ½å¤Ÿç¢°åˆ°å®ƒçš„$s+1$ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯å¦‚ä½•ç»´æŠ¤ä¿¡æ¯ã€‚å½“ä¸Šä¸€ä¸ªå­—æ¯ä½¿å¾—ä¸Šä¸Šä¸ªå­—æ¯èƒ½å¤Ÿè¢«æ¶ˆé™¤åï¼Œå°±æœ‰å¯èƒ½ä½¿å¾—åŸæœ¬æ— æ³•æ¥è§¦åˆ°æœ¬æ¬¡å­—æ¯çš„ä¸Šä¸€ä¸ªå­—æ¯è½¬è€Œèƒ½å¤Ÿæ¥è§¦åˆ°è¯¥å­—æ¯ã€‚ä½¿ç”¨å¹¶æŸ¥é›†æ¥åšè¿™ç§äº‹æƒ…ï¼Œå¹¶æŸ¥é›†ç»´æŠ¤è¿ç»­æ¶ˆé™¤çš„åŒºé—´lå’Œrï¼Œä»¥åŠè¿™ä¸ªåŒºé—´å­˜åœ¨å­—æ¯ï¼ˆintçŠ¶å‹å³å¯ï¼‰ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1000</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">UT</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">fa</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">dat</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">l</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

    <span class="n">UT</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAXN</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">fa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAXN</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span> <span class="o">?</span> <span class="nl">u</span> <span class="p">:</span> <span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">con</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">uf</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">vf</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="n">dat</span><span class="p">[</span><span class="n">vf</span><span class="p">]</span> <span class="o">|=</span> <span class="n">dat</span><span class="p">[</span><span class="n">uf</span><span class="p">];</span>
        <span class="n">l</span><span class="p">[</span><span class="n">vf</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">vf</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">uf</span><span class="p">]);</span>
        <span class="n">r</span><span class="p">[</span><span class="n">vf</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">vf</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">uf</span><span class="p">]);</span>
        <span class="n">fa</span><span class="p">[</span><span class="n">uf</span><span class="p">]</span> <span class="o">=</span> <span class="n">vf</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="nf">isc</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">==</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">string</span> <span class="n">inp</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>
<span class="n">UT</span> <span class="n">ut</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">nlen</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">inp</span><span class="p">;</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">inp</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">pos</span><span class="p">[</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">ut</span><span class="p">.</span><span class="n">dat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;));</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">p</span><span class="p">:</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">ut</span><span class="p">.</span><span class="n">dat</span><span class="p">[</span><span class="n">ut</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">||</span> <span class="p">(</span><span class="n">ut</span><span class="p">.</span><span class="n">dat</span><span class="p">[</span><span class="n">ut</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)))</span> <span class="p">{</span>
                    <span class="n">ut</span><span class="p">.</span><span class="n">con</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">inp</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">ut</span><span class="p">.</span><span class="n">dat</span><span class="p">[</span><span class="n">ut</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">||</span> <span class="p">(</span><span class="n">ut</span><span class="p">.</span><span class="n">dat</span><span class="p">[</span><span class="n">ut</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)))</span> <span class="p">{</span>
                    <span class="n">ut</span><span class="p">.</span><span class="n">con</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">uf</span> <span class="o">=</span> <span class="n">ut</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">uf</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">uf</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

            <span class="kt">int</span> <span class="n">minn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">ut</span><span class="p">.</span><span class="n">dat</span><span class="p">[</span><span class="n">uf</span><span class="p">]</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="p">{</span>
                    <span class="n">minn</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="kt">int</span> <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ut</span><span class="p">.</span><span class="n">l</span><span class="p">[</span><span class="n">uf</span><span class="p">];</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">ut</span><span class="p">.</span><span class="n">r</span><span class="p">[</span><span class="n">uf</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">off</span> <span class="o">+=</span> <span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span> <span class="o">+</span> <span class="n">minn</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">ans</span> <span class="o">+=</span> <span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ut</span><span class="p">.</span><span class="n">r</span><span class="p">[</span><span class="n">uf</span><span class="p">]</span> <span class="o">-</span> <span class="n">ut</span><span class="p">.</span><span class="n">l</span><span class="p">[</span><span class="n">uf</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">off</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="extra">Extra</h2>
<p>è¿™åœºæ¯”èµ›çš„Bé¢˜æŒºå¥½ç©çš„â€¦è¦æ±‚é€‰å‡ºçš„æ•°å­—æ»¡è¶³</p>
<div>$$c_i-c_{i+1}=p_{c_i}-p_{c_{i+1}}$$</div>
<p>â€¦ä¸€ä¸Šæ¥å‚»äº†ä¸çŸ¥é“å’‹åšï¼Œå…¶å®åªè¦æŠŠå…¬å¼å·¦å³äº¤æ¢ä¸€ä¸‹å°±å®Œäº‹äº†ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1295E] Permutation Separation</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1295e-permutation-separation/" />
            <id>https://blog.kanari.moe/code/cf-1295e-permutation-separation/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-02-28T17:47:47+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[You are given a permutation ğ‘1,ğ‘2,â€¦,ğ‘ğ‘› (an array where each integer from 1 to ğ‘› appears exactly once). The weight of the ğ‘–-th element of this permutation is ğ‘ğ‘–â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>You are given a permutation ğ‘1,ğ‘2,â€¦,ğ‘ğ‘› (an array where each integer from 1 to ğ‘› appears exactly once). The weight of the ğ‘–-th element of this permutation is ğ‘ğ‘–.</p>
<p>At first, you separate your permutation into two non-empty sets â€” prefix and suffix. More formally, the first set contains elements ğ‘1,ğ‘2,â€¦,ğ‘ğ‘˜, the second â€” ğ‘ğ‘˜+1,ğ‘ğ‘˜+2,â€¦,ğ‘ğ‘›, where 1â‰¤ğ‘˜&lt;ğ‘›.</p>
<p>After that, you may move elements between sets. The operation you are allowed to do is to choose some element of the first set and move it to the second set, or vice versa (move from the second set to the first). You have to pay ğ‘ğ‘– dollars to move the element ğ‘ğ‘–.</p>
<p>Your goal is to make it so that each element of the first set is less than each element of the second set. Note that if one of the sets is empty, this condition is met.</p>
<p>For example, if ğ‘=[3,1,2] and ğ‘=[7,1,4], then the optimal strategy is: separate ğ‘ into two parts [3,1] and [2] and then move the 2-element into first set (it costs 4). And if ğ‘=[3,5,1,6,2,4], ğ‘=[9,1,9,9,1,9], then the optimal strategy is: separate ğ‘ into two parts [3,5,1] and [6,2,4], and then move the 2-element into first set (it costs 1), and 5-element into second set (it also costs 1).</p>
<p>Calculate the minimum number of dollars you have to spend.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¦–å…ˆè¦è§£å†³çš„é—®é¢˜æ˜¯å¦‚ä½•æ–­å¼€ã€‚æšä¸¾æ’åˆ—çš„æŸä¸ªä½ç½®æ–­å¼€ï¼Œä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆå¥½åŠæ³•è½¬ç§»ï¼Œæšä¸¾æ•°å€¼ä¸Šæ–­å¼€çš„ä½ç½®æ˜¾å¾—æ›´å¯é ä¸€äº›ã€‚ä¸è¿‡æ–­å¼€æ•°å€¼åï¼Œä»ç„¶æ²¡æœ‰ä»€ä¹ˆå¥½åŠæ³•å»ç›´æ¥æ±‚å¾—ä»æ’åˆ—çš„ä½•å¤„æ–­å¼€ã€‚</p>
<p>è€ƒè™‘å†æ¬¡æšä¸¾æ’åˆ—çš„æ–­å¼€ä½ç½®ã€‚å½“ç¡®å®šæ’åˆ—çš„ä¸€ä¸ªæ–­ç‚¹åï¼Œç”±äºå·²ç»çŸ¥é“ä¸¤ä¸ªå­é›†æ‰€åŒ…å«çš„æ•°ï¼Œå¯ä»¥$O(N)$ç®—å‡ºåˆ°è¾¾ç›®æ ‡çŠ¶æ€éœ€è¦çš„ä»£ä»·ï¼Œåœ¨æ­¤ä»¥å·¦ä¾§å°å³ä¾§å¤§ä¸ºå‡†ã€‚å½“å‘å³ç§»åŠ¨æ–­ç‚¹åï¼Œæ³¨æ„åˆ°å·¦ä¾§åŸæœ‰çš„éœ€è¦ç§»åŠ¨æ•°å­—<strong>ä»ç„¶éœ€è¦ç§»åŠ¨</strong>ã€‚äºæ˜¯ï¼Œé’ˆå¯¹ä¸€ä¸ªå­é›†çš„åˆ†å‰²ï¼Œèƒ½å¤Ÿç”¨é€šè¿‡çº¿æ®µæ ‘$O(n\lg n)$æ¥æ±‚å‡ºåœ¨æ’åˆ—ä»»ä½•ä¸€ä¸ªä½ç½®æ–­å¼€çš„ä»£ä»·ã€‚</p>
<p>æ¥ä¸‹æ¥è€ƒè™‘æ•°å€¼ä¸Šçš„æ–­ç‚¹ç§»åŠ¨åæ˜¯å¦èƒ½å¤Ÿç»´æŠ¤ä»£ä»·å˜åŒ–ã€‚å½“ä¸€ä¸ªæ–°çš„æ•°å­—$a$è¢«ä»å¤§é›†åˆåˆ’å½’åˆ°å°é›†åˆåï¼Œåœ¨æ’åˆ—ä¸­ï¼Œä»¥è¯¥æ•°å­—$a$ä½ç½®ï¼Œå·¦ä¾§æ‰€æœ‰çš„æ–­ç‚¹éƒ½éœ€è¦ä»˜å‡ºé¢å¤–çš„ä»£ä»·å°†è¯¥æ•°æŒªåˆ°å·¦ä¾§ï¼Œè€Œå³ä¾§æ‰€æœ‰çš„æ–­ç‚¹éƒ½ä¸å†éœ€è¦æ”¯ä»˜ä»£ä»·æ¥å°†è¯¥æ•°æŒªåˆ°å³ä¾§ã€‚äºæ˜¯ï¼Œè¿™ä¸ªä»£ä»·ä¹Ÿæ˜¯å¯ä»¥ç»´æŠ¤çš„ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;limits&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">200010</span><span class="p">;</span>
 
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">MAXN</span><span class="o">*</span><span class="mi">4</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">MAXN</span><span class="o">*</span><span class="mi">4</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">flag</span><span class="p">[</span><span class="n">MAXN</span><span class="o">*</span><span class="mi">4</span><span class="p">],</span><span class="n">dmin</span><span class="p">[</span><span class="n">MAXN</span><span class="o">*</span><span class="mi">4</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="n">n</span><span class="o">=++</span><span class="n">idx</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">==</span><span class="n">r</span><span class="p">){</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">dmin</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">);</span>
    <span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">pushdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="k">return</span><span class="p">;</span>
    <span class="n">flag</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">flag</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">dmin</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">dmin</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">collect</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">dmin</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">dmin</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]],</span><span class="n">dmin</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]);</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
        <span class="n">dmin</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="n">collect</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="n">ll</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">dmin</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]));</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">root</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">permu</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">wage</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">pos</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
 
 
    <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">permu</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">pos</span><span class="p">[</span><span class="n">permu</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">wage</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 
    <span class="k">if</span><span class="p">(</span><span class="n">nlen</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="mi">0</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//init
</span><span class="c1"></span>    <span class="c1">//ä»¥ç¬¬iä½åˆ‡å‰²ï¼Œå‰iä¸ªä¸ºä¸€ä¸ªé›†åˆ
</span><span class="c1"></span>    <span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">modify</span><span class="p">(</span><span class="n">wage</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="p">,</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
    <span class="p">}</span>
 
    <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">){</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="p">,</span><span class="n">root</span><span class="p">));</span>
        <span class="n">ptr</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">modify</span><span class="p">(</span><span class="n">wage</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="n">ptr</span><span class="p">]],</span><span class="mi">1</span><span class="p">,</span><span class="n">pos</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">modify</span><span class="p">(</span><span class="o">-</span><span class="n">wage</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="n">ptr</span><span class="p">]],</span><span class="n">pos</span><span class="p">[</span><span class="n">ptr</span><span class="p">],</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
    <span class="p">}</span>
 
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
 
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">C&#43;&#43;æ–°æ ‡å‡†ç‰¹æ€§åˆæ¢</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/new-standard-of-cpp/" />
            <id>https://blog.kanari.moe/study/new-standard-of-cpp/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-02-23T21:24:40+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[è¯´å®è¯,è¿™ä¸€å¥—ä¸œè¥¿ä¸œæ‹¼è¥¿å‡‘åˆ°å¤„å–ç»,ä¸è¿‡æœ‰äº›è¿˜æŒºé¦™çš„. ç›®å‰å¯¹äº14,17çš„ç‰¹æ€§,GCâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>è¯´å®è¯,è¿™ä¸€å¥—ä¸œè¥¿ä¸œæ‹¼è¥¿å‡‘åˆ°å¤„å–ç»,ä¸è¿‡æœ‰äº›è¿˜æŒºé¦™çš„.</p>
<p>ç›®å‰å¯¹äº14,17çš„ç‰¹æ€§,GCCå’ŒClangéƒ½å®Œæˆäº†å¾ˆå¥½çš„é€‚é….åœ¨C++20ä¸Š,ä¸‹é¢æåˆ°çš„ç‰¹æ€§éƒ½åœ¨<strong>æœ€æ–°çš„</strong>ç‰ˆæœ¬é‡Œå®Œæˆäº†ç»å¤§å¤šæ•°.</p>
<p>æ ‡å‡†å®šå¾—çˆ½,åˆ°äº†å®ç°å°±å‡‰å‡‰.</p>
<h2 id="auto">auto</h2>
<p>è¿™ä¸ªå…³é”®å­—...æ˜¯çœŸçš„...ç›¸ä¿¡ä¸ä¹…ä¹‹åc++åªéœ€è¦ä¸‹é¢ä¸€ä¸ªå‚æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">auto</span> <span class="nf">auto</span><span class="p">(</span><span class="k">auto</span><span class="p">...){</span>
	<span class="k">return</span> <span class="k">auto</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªä¸œè¥¿,å°±æ˜¯æŠŠå˜é‡ç±»å‹äº¤ç»™ç¼–è¯‘å™¨æ¥è€ƒè™‘.è¿™ä¸ªç‰¹æ€§å®é™…ä¸Šæ—©è¯¥æœ‰äº†,å› ä¸ºc++ç¼–è¯‘å™¨åŸæœ¬å°±ä¼šæ£€æŸ¥å³å€¼å’Œå·¦å€¼çš„ç±»å‹æ˜¯å¦åŒ¹é…,é‚£ä¹ˆé¡ºä¾¿å¡«ä¸€ä¸ªå·¦å€¼çš„ç±»å‹ä¹Ÿä¸ä¼šç´¯ç€å®ƒ.</p>
<p>è¿™ä¸ªä¹ŸæŒºå¸¸ç”¨çš„.<code>for(auto it=vec.begin();...</code>è¿™ç§å†™æ³•çœäº†å¾ˆå¤§å·¥å¤«.</p>
<p>å’Œå®ƒé…åˆå¾ˆå¥½çš„æ˜¯æ–°å¼•å…¥çš„è¯­æ³•ç³–<code>for(auto item:var)</code>,å†™èµ·æ¥å¾ˆçˆ½.è¿™ç©æ„ä¹Ÿæ”¯æŒå¼•ç”¨.å¦å¤–ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ˜¯åœ¨C++17å,ç”±æ¨¡å¼ç»‘å®šåŠ æˆ,è¿™ç©æ„èƒ½è¿›ä¸€æ­¥å†™æˆ<code>for(const auto&amp; [key,value] : map)</code>.</p>
<p>è¿˜æœ‰ä¸€ä¸ªä¸œè¥¿æ˜¯<strong>autoç”¨åœ¨å‡½æ•°ç­¾åçš„è¿”å›å€¼æ—¶éœ€è¦å°¾éšè¿”å›å€¼ç±»å‹</strong>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">auto</span> <span class="nf">f</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="o">???</span><span class="p">{</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨C++14é‡Œä¸éœ€è¦å†å°¾éšè¿”å›å€¼ç±»å‹äº†.ä¸è¿‡å¦å¤–è¿˜æœ‰ä¸€ç§å†™æ³•<code>decltype(auto)</code>,è¿™ä¸¤ä¸ªçš„åŒºåˆ«åœ¨äºåè€…èƒ½å¤Ÿä¿ç•™å¼•ç”¨çš„ç±»å‹ä¿¡æ¯.è¿™ä¸ªå°¾éšè¿”å›å€¼çš„ç”¨å¤„å°±å‰©ä¸‹åœ¨lambdaè¡¨è¾¾å¼é‡Œç”¨äº†.ä¸è¿‡,å°è¯•åœ¨ç­¾åé‡ŒåŸæœ¬çš„è¿”å›ç±»å‹ä½ç½®å†™<code>auto</code>,è½¬è€ŒæŠŠçœŸå®çš„è¿”å›ç±»å‹å°¾éš,è¿™ç§å†™æ³•è¶Šå‘åƒç°ä»£è¯­è¨€äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">f</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="lambda-è¡¨è¾¾å¼">Lambda è¡¨è¾¾å¼</h2>
<p>å¥½ç”¨çš„ä¸œè¥¿.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">sort</span><span class="p">(</span><span class="n">vec</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">vec</span><span class="p">.</span><span class="n">end</span><span class="p">(),[](</span><span class="k">const</span> <span class="n">Student</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Student</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
	<span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">age</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">age</span><span class="p">;</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>å†ä¹Ÿä¸éœ€è¦<code>cmp_1</code>,<code>cmp_2</code>äº†.</p>
<p>lambdaè¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªé—­åŒ…,éœ€è¦è€ƒè™‘å…¶å¯¹äºç¯å¢ƒå˜é‡çš„æ•æ‰ç±»å‹.</p>
<ul>
<li>æŒ‰å€¼æ•è·</li>
<li>æŒ‰å¼•ç”¨æ•è·</li>
</ul>
<p>å°±å¦‚å®ƒä»¬å­—é¢ä¸Šçš„æ„æ€.å®é™…å®ç°æ—¶,å°†å…¶å†™åœ¨<code>[]</code>å†….ä¾‹å¦‚<code>[=],[&amp;],[foo,&amp;bar]</code>.ä¸€ä¸ªè¦æ³¨æ„çš„é—®é¢˜æ˜¯,æŒ‰å€¼æ•è·æ—¶,æ•è·çš„å˜é‡å‡ä¸ºconst,ä¸èƒ½ä¿®æ”¹,åç¼€<code>[]()mutable{}</code>åå¯ä»¥ä¿®æ”¹,ä¸è¿‡è¿™ç§ä¿®æ”¹ä¸ä¼šå½±å“ç¯å¢ƒå˜é‡.</p>
<p>åœ¨C++14ä¸­å¯ä»¥å€ŸåŠ©autoå®ç°lambdaå¤šæ€.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">auto</span> <span class="n">func</span><span class="o">=</span><span class="p">[](</span><span class="k">auto</span> <span class="n">a</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">a</span><span class="p">;};</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶åè¿™ä¸ªfuncå¯ä»¥ç›´æ¥ä¼ å¾ˆå¤šå‚æ•°.</p>
<p>å¦ä¸€ä¸ªæ˜¯åœ¨æ•è·æ—¶è¿›è¡Œç¯å¢ƒå˜é‡åˆå§‹åŒ–,ä¾‹å¦‚<code>[x=0]</code>.ä¸è¿‡è¿™ç©æ„æ˜¯å¦æœ‰é¢å¤–çš„è€ƒè™‘...å¤§æ¦‚èƒ½å»çœ‹çœ‹RFC?</p>
<p>åœ¨C++20ä¸­,lambdaå¯ä»¥æºå¸¦æ¨¡æ¿<code>[]&lt;typename T&gt;(){}</code>.</p>
<h2 id="using">using</h2>
<p>ä»¥å‰,æˆ‘ä»¬å®šä¹‰<code>ll</code>æœ‰è¿™ä¹ˆä¸¤æ´¾.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#define ll long long
</span><span class="cp"></span><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨,æ–°çš„ä¸€æ´¾åŠ å…¥äº†æˆ˜åœº.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™å‡ ç§åŠæ³•å¦‚æœéè¦åˆ†å‡ºä¸ªé«˜ä½,é‚£å¤§æ¦‚è¦ä»ä¸‹é¢å‡ ä¸ªæ–¹é¢è¯´</p>
<ul>
<li>defineæ˜¯ä¸€ç§æ›¿æ¢.å®ƒç›¸å¯¹äºå¦å¤–ä¸¤ç§æ¥è¯´,æœ‰äº›è¿‡äºå¼ºå¤§å’Œéšæ€§,å¯èƒ½ä¼šå¸¦æ¥é—®é¢˜.</li>
<li>typedefæ˜¯Cé£æ ¼çš„.</li>
<li>usingæ˜¯C++é£æ ¼çš„.å¦å¤–usingåœ¨å†…éƒ¨çš„å®ç°æ˜¯åŸºäºæ¨¡æ¿çš„.è¿™ä¸€ç‚¹æ˜¯å¦ä¼šå¸¦æ¥å¥½å¤„æˆ‘è¿˜æ²¡å¼„æ˜ç™½.</li>
</ul>
<h2 id="nullptr">nullptr</h2>
<p>èµ‹å€¼ç»™ç©ºæŒ‡é’ˆçš„æ–°å€¼,ç”¨æ¥å–ä»£<code>NULL</code>.è¿™ä¸ªå…³é”®å­—å¯¹äºå·¥ç¨‹çš„ç”¨å¤„æ›´é«˜.å®ƒç”¨äºå¤„ç†å’Œé‡è½½,æ³›å‹ç¼–ç¨‹æœ‰å…³çš„é—®é¢˜.</p>
<p>ä¸€ä¸ªç©ºæŒ‡é’ˆåœ¨Cé£æ ¼ä¸­å®šä¹‰ä¸ºå®<code>NULL</code>,è¿™ä¸ªä¸œè¥¿,å®ƒæ˜¯<code>0</code>çš„åˆ«å.é‚£ä¹ˆ,ä¸€ä¸ªæ³›å‹å‡½æ•°åˆ°åº•è¯¥æŠŠå®ƒçœ‹ä½œ<code>int</code>è¿˜æ˜¯æŒ‡é’ˆ?è¿™ä¹Ÿæ˜¯ä¸æ¨èç”¨defineå®šä¹‰æ–°ç±»å‹çš„ä¸€ä¸ªç†ç”±.è¯´ä¸å®šä»€ä¹ˆæ—¶å€™å°±è¸©è¿›å‘.</p>
<h2 id="decltype">decltype</h2>
<p>å¯¹ç±»å‹çš„è¿ç®—,ç”¨äºåœ¨ç¼–è¯‘æ—¶è·å–æŸä¸ªå€¼çš„ç±»å‹.ç®—æ˜¯ä¸ªå’Œ<code>auto</code>é…å¥—çš„ä¸œè¥¿.å› ä¸º<code>auto</code>äº†,ä½ ä¹Ÿä¸çŸ¥é“å®ƒåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆ,æ­¤æ—¶å°±å¯ä»¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">auto</span> <span class="n">a</span><span class="o">=</span><span class="cm">/*something weired*/</span><span class="p">;</span>
<span class="k">decltype</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>æ€ä¹ˆè¯´å‘¢...æœ‰äº†ä¸€ç§åŠ¨æ€è¯­è¨€çš„è°ƒè°ƒ.</p>
<hr>
<h2 id="ç”¨ä»¥ä¸Šè¿™äº›ä¸œè¥¿å°±èƒ½å†™å‡ºè¿™ç§ä»£ç ">ç”¨ä»¥ä¸Šè¿™äº›ä¸œè¥¿,å°±èƒ½å†™å‡ºè¿™ç§ä»£ç .</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="c1">//å½“ç„¶è¿™æ®µä»£ç æ˜¯æ²¡å•¥æ„ä¹‰çš„,åªæ˜¯ç”¨ä¸€ä¸‹æ–°çš„ç‰¹æ€§
</span><span class="c1"></span><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">auto</span> <span class="n">func</span><span class="p">(</span><span class="n">string</span> <span class="n">type</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">function</span><span class="o">&lt;</span><span class="n">T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">&gt;</span><span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">type</span><span class="o">==</span><span class="s">&#34;add&#34;</span><span class="p">){</span>
        <span class="k">return</span> <span class="p">[](</span><span class="k">auto</span> <span class="n">x</span><span class="p">,</span><span class="k">auto</span> <span class="n">y</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">return</span> <span class="p">[](</span><span class="k">auto</span> <span class="n">x</span><span class="p">,</span><span class="k">auto</span> <span class="n">y</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">//å¯å˜å‚æ•°
</span><span class="c1"></span><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">decltype</span><span class="p">(</span><span class="k">auto</span><span class="p">)</span> <span class="n">reduce</span><span class="p">(</span><span class="k">auto</span> <span class="n">f</span><span class="p">,</span><span class="k">const</span> <span class="n">T</span><span class="p">...</span> <span class="n">args</span><span class="p">){</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">vec</span><span class="o">=</span><span class="p">{</span><span class="n">args</span><span class="p">...};</span>
    <span class="k">auto</span> <span class="n">res</span><span class="o">=*</span><span class="n">vec</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="n">ne</span><span class="o">=</span><span class="n">vec</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">ne</span><span class="o">!=</span><span class="n">vec</span><span class="p">.</span><span class="n">end</span><span class="p">();</span><span class="n">ne</span><span class="o">++</span><span class="p">){</span>
        <span class="n">res</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="o">*</span><span class="n">ne</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">reduce</span><span class="p">(</span><span class="n">func</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&#34;add&#34;</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="constexpr">constexpr</h2>
<p>å¥½äº†,ç°åœ¨å¯¹äº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬æœ‰äº†æ–°çš„å†™æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">constexpr</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</code></pre></td></tr></table>
</div>
</div><p>å®é™…ä¸Š,ä¸‹é¢çš„å†™æ³•æ‰æ˜¯å¯¹çš„.ä¸Šé¢çš„å†™æ³•æŒ‰ç…§æ ‡å‡†åº”è¯¥æ˜¯æ— æ³•é€šè¿‡ç¼–è¯‘çš„,åªä¸è¿‡å®ƒå¤ªå¸¸ç”¨,ç¼–è¯‘å™¨çŸ¥é“ä½ æƒ³å¹²å˜›,æ‰€ä»¥é»˜é»˜å®Œæˆäº†æ“ä½œ,æ²¡æœ‰äººæŠ±æ€¨,å¯å–œå¯è´º.</p>
<p><code>constexpr</code>ç”¨äºåœ¨<strong>ç¼–è¯‘é˜¶æ®µ</strong>è¿›è¡Œæ±‚å€¼.ä¹Ÿå¯ä»¥ç”¨åœ¨å‡½æ•°.ä»¥å¾€æœ‰äº›äººåœ¨æ¨¡æ¿ä¸Šç©èŠ±,åœ¨ç¼–è¯‘é˜¶æ®µå°±è®©ç¼–è¯‘å™¨ç‡å…ˆå®Œæˆç±»ä¼¼äºæ‰“è¡¨ä¹‹ç±»çš„æ“ä½œ,ä»¥è‡³äºè¯„æµ‹å™¨é™†ç»­å…¨éƒ¨å®Œå–„äº†ç¼–è¯‘æ—¶é™åˆ¶æ—¶é—´.ç°åœ¨å†æƒ³ç©è¿™äº›æ“ä½œ,å¯ä»¥ç›´æ¥ä½¿ç”¨<code>constexpr</code>äº†.ä¸è¿‡å¯æƒœçš„æ˜¯å®ƒè¿˜C++11é‡Œæ¯”è¾ƒèœ,ä¸èƒ½å®Œæˆå¤æ‚è¿ç®—.ç›´åˆ°åœ¨C++14é‡Œ,<code>constexpr</code>èƒ½å¤Ÿæ”¯æŒ<code>if</code>ç”šè‡³é€’å½’äº†.</p>
<p>åœ¨C++14é‡Œ,<code>constexpr</code>èƒ½å¤Ÿå’Œ<code>template</code>é…åˆå®ç°å¯¹ä¸åŒç±»å‹å¸¸é‡çš„åˆå§‹åŒ–.è¿™ä¸€ç‚¹åŸºæœ¬ä¸Šå°±æŠŠ<code>#define PI 3.1415926535897932385</code>æ‰“çˆ†.æ¨èä½¿ç”¨<code>#define</code>å®šä¹‰<code>PI</code>çš„åŸå› å°±åœ¨äºå®ƒçš„æ›¿æ¢è¡Œä¸ºèƒ½å¤Ÿå…å»åœ¨å¸¸é‡å®šä¹‰è¿‡ç¨‹ä¸­è¢«ç±»å‹ç²¾åº¦å½±å“.</p>
<h2 id="å³å€¼å¼•ç”¨">å³å€¼å¼•ç”¨</h2>
<p>è¿™ç©æ„çš„å­˜åœ¨æ„ä¹‰ä¸»è¦æ˜¯æ¶ˆé™¤ä¸å¿…è¦æ‹·è´ï¼Œå¹¶ç»™æ³›å‹ç¼–ç¨‹å¸¦æ¥ä¾¿åˆ©ã€‚</p>
<p>ä¸€èˆ¬æ¥è®²ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹çš„ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">Student</span> <span class="n">student</span><span class="p">;</span>
<span class="n">student</span> <span class="o">=</span> <span class="n">Student</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">Tiansuo</span> <span class="n">Li</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;,</span><span class="mi">24</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>ç¬¬äºŒè¡Œçš„èµ‹å€¼è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å†…å­˜çš„å¤åˆ¶å’Œé”€æ¯ã€‚å¯¹â€¦â€¦è¿™ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯å¹¶æ²¡æœ‰ç›´æ¥ç»™studentã€‚</p>
<blockquote>
<p>æ®è¯´ç°ä»£ç¼–è¯‘å™¨èƒ½å¤Ÿé’ˆå¯¹è¿™ç§æƒ…å†µè¿›è¡Œä¼˜åŒ–äº†ã€‚</p>
</blockquote>
<p>å³å€¼æœ‰è¿™ä¹ˆä¸€ä¸ªç‰¹æ€§ï¼Œ<strong>åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡</strong>ã€‚è¿™æ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€å¸¸é‡ï¼Œè¿™äº›ä¸œè¥¿é™¤äº†åœ¨ä½œä¸ºå³å€¼èµ‹å€¼ç»™å·¦å€¼çš„ä¸€ç¬é—´ï¼Œå…¶ä»–æ—¶å€™å†æ— ç”¨å¤„ã€‚é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»ç„¶å¯¹æ­¤ç±»å³å€¼æ‰§è¡Œå¤åˆ¶å°±æ˜¾å¾—å¾ˆç´¯èµ˜ã€‚å³å€¼å¼•ç”¨å°±æ˜¯ç”¨äºè§£å†³æ­¤ç±»é—®é¢˜çš„ã€‚</p>
<p>å³å€¼å¼•ç”¨ä½¿ç”¨<code>&amp;&amp;</code>æ ‡æ³¨ã€‚</p>
<p>ä¸ºStudentå®ç°ä»¥ä¸‹å³å€¼å¼•ç”¨è¯­ä¹‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">Student</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">Student</span> <span class="o">&amp;&amp;</span><span class="n">stu</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="k">this</span> <span class="o">!=&amp;</span><span class="n">str</span><span class="p">){</span>
		<span class="n">name</span><span class="o">=</span><span class="n">stu</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
		<span class="n">age</span><span class="o">=</span><span class="n">stu</span><span class="p">.</span><span class="n">age</span><span class="p">;</span>
		
		<span class="n">stu</span><span class="p">.</span><span class="n">name</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">;</span>
		<span class="n">stu</span><span class="p">.</span><span class="n">age</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“ç„¶å¤åˆ¶ä¸€ä¸ªåå­—ä»€ä¹ˆçš„è¿˜æ²¡æœ‰è¿™ä¹ˆå¤§åŒºåˆ«ã€‚</p>
<p><code>std::move</code>è¿™ä¸ªå…³é”®å­—å’Œä¸Šé¢çš„å³å€¼å¼•ç”¨æœ‰ç‚¹å…³ç³»ã€‚å®ƒæŒ‡æ˜å¯¹è±¡çš„èµ‹å€¼å¸¦æœ‰èµ„æºçš„è½¬ç§»ï¼Œä¹Ÿå°±æ˜¯å¼ºåˆ¶è¿›è¡Œå³å€¼å¼•ç”¨å’Œèµ„æºç§»åŠ¨ï¼ˆæ¯”å¦‚ä¸Šä¾‹ä¸­å­¦ç”Ÿåå­—çš„ç§»åŠ¨ï¼‰ã€‚</p>
<p>è¿™ç§æ„Ÿè§‰æ˜¯ä¸æ˜¯å’Œrustæœ‰ç‚¹ç›¸ä¼¼ï¼Ÿä¸è¿‡å¾ˆå¯æƒœè¿™ä¸æ˜¯ä¸€ç§ä¸œè¥¿ã€‚è‡³å°‘å®ƒåœ¨æœ€åˆè®¾è®¡ä¸Šä¸æ˜¯ã€‚ä½†æ˜¯å½“å’Œä¸€äº›æ™ºèƒ½æŒ‡é’ˆä¾‹å¦‚<code>unique_ptr</code>ä¸€åŒä½¿ç”¨æ—¶ï¼Œç¡®å®è¾¾åˆ°äº†ä¸€ç§æ‰€æœ‰æƒç§»åŠ¨çš„æ„Ÿè§‰ã€‚</p>
<p>å¤§å®¶æƒ³çš„éƒ½æ˜¯å·®ä¸å¤šçš„å˜›ã€‚</p>
<p>å¦å¤–<code>std::forward</code>ä¹Ÿæ˜¯åŸºäºå¼•ç”¨ç»™å‡ºçš„å·¥å…·ã€‚ç”¨æ¥<strong>æŠŠæ•°æ®æŒ‰åŸæ ·è¿”å›</strong>ã€‚å·¦å€¼å¼•ç”¨å½’å·¦å€¼å¼•ç”¨ï¼Œå³å€¼çš„å½’å³å€¼ã€‚</p>
<h2 id="æ™ºèƒ½æŒ‡é’ˆ">æ™ºèƒ½æŒ‡é’ˆ</h2>
<p>è¿™ä¸ªå¯¹æˆ‘æ¥è¯´ä¸æ˜¯å¾ˆå¸¸ç”¨.</p>
<p><code>std::unique_ptr</code>æ˜¯æ— æ³•å¤åˆ¶ä½†æ˜¯å¯ä»¥ç§»åŠ¨çš„æ™ºèƒ½æŒ‡é’ˆ,åˆšæ‰å·²ç»è¯´äº†.</p>
<p><code>std::shared_ptr</code>æ˜¯å¯ä»¥åœ¨ä¸åŒä»£ç æˆ–è€…çº¿ç¨‹é—´å…±äº«çš„æŒ‡é’ˆ,æ˜¯å’Œä¸Šé¢çš„ç›¸å¯¹è€Œè¨€çš„.ä¸è¿‡å®ƒä¸ä¿è¯å…¶å†…éƒ¨ä¿ç®¡çš„å¯¹è±¡ä¹Ÿå¯ä»¥çº¿ç¨‹å®‰å…¨...è¿™è®©æˆ‘æƒ³èµ·æ¥rustçš„<code>Arc&lt;Mutex&lt;...&gt;&gt;</code>.</p>
<p>ä¸shared_ptré…å¥—ä½¿ç”¨çš„è¿˜æœ‰make_shared.</p>
<h2 id="å†…å­˜æ¨¡å‹">å†…å­˜æ¨¡å‹</h2>
<p>è¯´å®è¯,è¿™ä¸ªå¤§æ¦‚æ‰æ˜¯é‡ç‚¹,ä¸è¿‡å¯¹æˆ‘æ¥è¯´ä¸å¸¸ç”¨.</p>
<p>è¿™æ„å‘³ç€c++æ ‡å‡†åº“å°†æä¾›æ— å…³å¹³å°çš„ä¸€ç³»åˆ—çº¿ç¨‹æ“ä½œ,åŒ…æ‹¬çº¿ç¨‹,é”,åŸå­æ“ä½œ,å¼‚æ­¥ç­‰.</p>
<ul>
<li>std::thread æ¥è‡ªæ ‡å‡†åº“çš„çº¿ç¨‹</li>
<li>std::async c++ä¹Ÿä»c#é‚£é‡Œæ¬æ¥äº†asyncå’Œawaité‚£å¥—å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹</li>
</ul>
<h2 id="å¯å˜å‚æ•°">å¯å˜å‚æ•°</h2>
<p>ä¹Ÿä¸å¸¸ç”¨...</p>
<p>æƒ³çŸ¥é“åœ¨æ²¡æœ‰å¯å˜å‚æ•°çš„æ—¶å€™,printfæ˜¯æ€ä¹ˆå®ç°çš„å—?é‚£ä¸ªæ¨¡æ¿åµŒå¥—æ˜¯çœŸçš„ææ€–.ç›´åˆ°ä»Šå¤©C++ä¹Ÿæœ‰å¯å˜å‚æ•°äº†.å…¶è¯­æ³•ä¸Šæ˜¯<code>...</code></p>
<p>è¿™ç©æ„æ˜¯ç”¨åœ¨æ¨¡æ¿é‡Œçš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">printf</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pattern</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="p">...</span> <span class="n">args</span><span class="p">){</span>
	<span class="c1">//bula bula
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>æ—¢ç„¶æœ‰äº†å¯å˜å‚æ•°,å°±èƒ½æœ‰å…ƒç»„.ä¸å…¶åŒæ—¶è€Œæ¥çš„è¿˜æœ‰<code>std::tie</code>,ç”¨äºè§£æ„å…ƒç»„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">tie</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span><span class="o">=</span><span class="n">make_tuple</span><span class="p">(</span><span class="s">&#34;Tiansuo Li&#34;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>C++17é‡Œ,è¿™ç§è§£æ„è¢«è¿›ä¸€æ­¥æå‡ä¸ºç»“æ„ç»‘å®š.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">const</span> <span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">make_tuple</span><span class="p">(</span><span class="s">&#34;Tiansuo Li&#34;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="å’Œé¢å‘å¯¹è±¡æœ‰å…³çš„">å’Œé¢å‘å¯¹è±¡æœ‰å…³çš„</h2>
<p>ç›®å‰åˆæ˜¯ä¸å¸¸ç”¨çš„ä¸œè¥¿.</p>
<p>æ˜¾å¼æ–¹æ³•é‡è½½.è¿™ä¸ªæ˜¯é¢å‘å¯¹è±¡é‡Œçš„æ¦‚å¿µ.å…·ä½“å°±æ˜¯åœ¨é‡å†™è™šå‡½æ•°æ—¶åœ¨å‡½æ•°ç­¾åæœ€åæ³¨æ˜<code>override</code>,ç¼–è¯‘å™¨å°±ä¼šæ ¹æ®å®é™…æƒ…å†µç»™å‡ºæ›´å¤šçš„æç¤ºå’Œå¸®åŠ©.</p>
<p><code>final</code>å°é—­æ–¹æ³•.è¿™ä¸ªä¹Ÿæ˜¯é¢å‘å¯¹è±¡æ¦‚å¿µ.ç”¨äºå°†ä¸€ä¸ªè™šå‡½æ•°å°é—­,ä¸å†è®©å­ç±»é‡å†™.</p>
<p><code>=default</code>é»˜è®¤æ–¹æ³•.è¿™ä¸ªä»ç„¶æ˜¯é¢å‘å¯¹è±¡æ¦‚å¿µ.æ˜¾å¼çš„å†™æ˜ä½¿ç”¨é»˜è®¤å®ç°.</p>
<p><code>=delete</code>åˆ é™¤æ–¹æ³•....è¿˜æ˜¯.æ˜¾å¼çš„æ³¨æ˜ä»ç±»ä¸­åˆ é™¤æŸä¸ªæ–¹æ³•(ä¾‹å¦‚é»˜è®¤æ–¹æ³•),é˜²æ­¢ä»–äººè°ƒç”¨.</p>
<p>å…è®¸éé™æ€æˆå‘˜å˜é‡è‡ªè¡Œåˆå§‹åŒ–.</p>
<p>æ–¹æ³•é‡è½½èƒ½å¤Ÿæ³¨æ˜å·¦å³å€¼çš„åŒºåˆ†.</p>
<h2 id="array">array</h2>
<p>ä¸å¯å˜é•¿çš„æ•°ç»„,éœ€è¦åœ¨å£°æ˜æ—¶å°±ç»™å‡ºå¤§å°.è¿™ç©æ„å¾ˆå¸¸ç”¨æ‰€ä»¥ä¹Ÿæå‡ºæ¥.</p>
<p>ä¸æ­¤ç›¸å…³çš„ä¿¡æ¯æ˜¯vectorçš„ç©ºé—´å ç”¨,è¿™ä¸ªä¸œè¥¿çš„è¡Œä¸ºæœ‰å¦‚ä¸‹ä¸¤ä¸ªç‰¹ç‚¹</p>
<ul>
<li>å½“éœ€è¦æ–°ç©ºé—´æ—¶,å°†é‡æ–°ç”³è¯·åŸæ¥ä¸¤å€çš„ç©ºé—´.</li>
<li>å°†æ•°æ®å¤åˆ¶åˆ°æ–°ç©ºé—´.</li>
</ul>
<p>å¦‚æœç¡®å®šæ•°æ®çš„å¤§å°,arrayæ˜¾ç„¶æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©.</p>
<h2 id="stdoptional">std::optional</h2>
<p>å¤© ä¸‹ å¤§ åŒ.</p>
<p>è¿™ç©æ„å’Œrustçš„<code>Option</code>æ˜¯ä¸€ä¸ªä¸œè¥¿.ä½ å®¶C++ä¹Ÿè¦å˜æˆ<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>äº†.</p>
<h2 id="concepts">Concepts</h2>
<p>å¤© ä¸‹ å¤§ åŒ x 2.</p>
<p>è¿™ç©æ„ç”¨äº<strong>é™å®š</strong>æ¨¡æ¿ä¸­çš„ç±»å‹.ç±»ä¼¼äºrustå†…çš„<code>+</code>æè¿°.</p>
<h2 id="å…¶ä»–ä¿¡æ¯">å…¶ä»–ä¿¡æ¯</h2>
<ul>
<li>std::chrono æ¥è‡ªæ ‡å‡†åº“çš„æ—¶é—´è®¡ç®—</li>
<li>unordered_xxx åŸºäºå“ˆå¸Œçš„æ— åºå®¹å™¨,è¿™ä¸ªå·²ç»å¾ˆå¸¸ç”¨äº†å§</li>
<li>std::begin/end ...è¿™ä¸ªç®—æ˜¯å¡«å‘?è™½ç„¶å„ä¸ªå®¹å™¨éƒ½æä¾›äº†ç±»ä¼¼çš„API,ä¸è¿‡åœ¨æ³›å‹ç¼–ç¨‹æ—¶,è¿˜æ˜¯éœ€è¦ä¸€ä¸ªè¿™ç§ä¸œè¥¿.</li>
<li>å…è®¸æ¨¡æ¿åµŒå¥—æ—¶å³ä¾§å°–æ‹¬å·ç´§é .è¿™ä¸ªå…¶å®å¾ˆå¥½.ä»¥åŠä¹Ÿè¦æ³¨æ„è¿™ä¸ªç‰¹æ€§æ˜¯åœ¨C++11é‡Œä¿®è®¢çš„.</li>
<li>noexcept æ”¾åœ¨å‡½æ•°ç­¾åé‡Œè¡¨ç¤ºä¸æŠ›å¼‚å¸¸</li>
<li>attribute ç”¨<code>[[]]</code>æ¥æ ‡æ³¨å±æ€§(æ³¨è§£),æœ‰ç‚¹åƒrustçš„<code>#[[]]</code>ä¸€ç±»çš„ä¸œè¥¿.åœ¨C++20é‡Œ,æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„æ³¨è§£<code>likely</code>å¯ä»¥å‘ç¼–è¯‘å™¨å»ºè®®åˆ†æ”¯çš„é¢„æµ‹ç»“æœ,è¿™ä¸ªå’ŒCSAPPè¯¾ç¨‹ç›¸å…³æ€§å¾ˆå¼º.</li>
<li>äºŒè¿›åˆ¶è¡¨ç¤º,åœ¨C++14ä¸­,è¿™æ²¡å•¥å¯è¯´çš„,<code>0b010101</code>.</li>
<li>å¸¦åˆå§‹åŒ–çš„<code>if</code>.åœ¨C++17ä¸­,èƒ½å¤Ÿç”¨ç±»ä¼¼äºgolangä¸­çš„å¸¦åˆå§‹åŒ–<code>if</code>äº†.</li>
<li>å¸¦åˆå§‹åŒ–çš„range<code>for</code>.åœ¨C++20ä¸­,<code>for(:)</code>çš„ç©æ„èƒ½å¤Ÿè‡ªå¸¦åˆå§‹åŒ–è¯­å¥äº†.</li>
<li><strong>utf-8æ”¯æŒ</strong>.åœ¨C++17ä¸­,å­—ç¬¦å‰ç¼€<code>u8</code>èƒ½å¤Ÿè·å¾—utf-8çš„å­—ç¬¦äº†.åœ¨C++20ä¸­,å­˜åœ¨<code>char8_t</code>ç”¨äºæ”¯æŒå­—ç¬¦ä¸².</li>
</ul>
<h2 id="å¯èƒ½å…³æ³¨çš„å…¶ä»–ä¸œè¥¿">å¯èƒ½å…³æ³¨çš„å…¶ä»–ä¸œè¥¿</h2>
<p><code>popcount</code>.C++20æä¾›çš„å‡½æ•°,å¯ä»¥æ•°äºŒè¿›åˆ¶æ•°ä¸­1çš„ä¸ªæ•°.å¦å¤–è¿˜æœ‰ä¸€äº›æ“ä½œ,ä½äº<code>&lt;bit&gt;</code>ä¸­.</p>
<p>æ•°å­¦å¸¸æ•°.ä¾‹å¦‚<code>std::numbers::pi</code>.ä¸è¿‡è¿™ä¸ªå€’æ— æ‰€è°“...åº”è¯¥éƒ½çŸ¥é“<code>acos(-1)</code>.</p>
<h2 id="cèµ°åœ¨ç°ä»£åŒ–çš„è·¯ä¸Š">C++èµ°åœ¨ç°ä»£åŒ–çš„è·¯ä¸Š</h2>
<p>å…ˆæä¸€ä¸ªé—®é¢˜.GCCå’ŒClangäºŒè€…æœ€æ–°ç‰ˆæœ¬çš„ç¼–è¯‘å™¨çš„å®‰è£…å¯èƒ½ä¼šç»™ä½ å¸¦æ¥éº»çƒ¦,å°¤å…¶æ˜¯Windowsç”¨æˆ·.MinGW,MinGW-w64,TDM-GCC<strong>éƒ½æ²¡æœ‰</strong>æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬.å¦‚æœå¸Œæœ›ä½¿ç”¨20æ ‡å‡†,ä¼¼ä¹æœ€ç®€å•çš„åŠæ³•æ˜¯å®‰è£…<code>msys2</code>.</p>
<p>å…¶å®åœ¨ç¿»çœ‹å®Œè¿™äº›æ–°æ ‡å‡†å,æˆ‘è¶Šå‘è§‰å¾—æˆ‘åŸæ¥å­¦çš„C++å’Œç°åœ¨çš„C++æ˜¯ä¸åŒçš„è¯­è¨€.ä½ å¯ä»¥æŠŠC++å½“Cæ¥å†™,ä¹Ÿå¯ä»¥åœåœ¨11ä¹‹å‰çš„æ ‡å‡†æ¥å†™,ä¹Ÿå¯ä»¥å¤§è¸æ­¥æ¥åˆ°20.ä¸‰ç§é£æ ¼å†™å‡ºæ¥çš„ä»£ç å®Œå…¨ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿.</p>
<p>å¦å¤–,æˆ‘ä¸€ç›´æ²¡æœ‰æ³¨æ„æ™ºèƒ½æŒ‡é’ˆ,å³å€¼å¼•ç”¨å’Œ<code>ç§»åŠ¨</code>æ¦‚å¿µ,åœ¨äº†è§£Rustä¹‹åæ‰æ„è¯†åˆ°å®ƒä»¬çš„é‡è¦æ€§.é™¤äº†æ²¡æœ‰Rustä¸ç”Ÿä¿±æ¥çš„ç”Ÿå‘½å‘¨æœŸä»¥åŠæ‰€æœ‰æƒçš„é™æ€æ£€æŸ¥,C++æŠŠå…¶ä»–è¯¥æœ‰çš„ä¼¼ä¹å…¨æœ‰äº†.å€’ä¸å¦‚è¯´Rustä¹Ÿä»C++è¿™é‡Œå€Ÿé‰´äº†å¤§é‡ä¸œè¥¿,æ¯”å¦‚æ™ºèƒ½æŒ‡é’ˆ.</p>
<p>è¯´å®è¯,åœ¨æ­¤æ—¶æˆ‘æœ‰ç‚¹æ›´å€¾å‘äºä½¿ç”¨C++äº†.</p>
<blockquote>
<p>C++çš„ç¼–è¯‘å™¨ä¹Ÿèƒ½åœ¨ç§»åŠ¨è¯­ä¹‰ä¸Šè¿›è¡Œè¾ƒä¸ºå®½æ¾çš„é™æ€æ£€æŸ¥,such as å·²ç»moveçš„å˜é‡å†æ¬¡ä½¿ç”¨ä¼šè¢«warning.</p>
</blockquote>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä½¿ç”¨Pythonåˆ†ææ•°æ®</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/python-in-data-processing/" />
            <id>https://blog.kanari.moe/code/python-in-data-processing/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-02-22T11:45:06+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[æœ¬æ¥è¿™ä¸æ˜¯æˆ‘ç°åœ¨è¯¥æƒ³çš„ä¸œè¥¿ï¼Œè¢«è¿«å› ä¸ºå»ºæ¨¡æ¯”èµ›çœ‹äº†ä¸€ç‚¹ã€‚æ‰€å­¦ä¸œè¥¿å¤ªè¿‡æ‚ä¹±ã€‚ ä¸ºä»€ä¹ˆä¸ç”¨Mâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>æœ¬æ¥è¿™ä¸æ˜¯æˆ‘ç°åœ¨è¯¥æƒ³çš„ä¸œè¥¿ï¼Œè¢«è¿«å› ä¸ºå»ºæ¨¡æ¯”èµ›çœ‹äº†ä¸€ç‚¹ã€‚æ‰€å­¦ä¸œè¥¿å¤ªè¿‡æ‚ä¹±ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆä¸ç”¨matlabmathematica">ä¸ºä»€ä¹ˆä¸ç”¨Matlabã€Mathematica</h2>
<p>å› ä¸ºMathematicaè¢«æˆ‘å¸äº†ï¼ŒMatlabæ²¡å­¦è¿‡ï¼Œä¹Ÿä¸å–œæ¬¢ã€‚è¿™åªæ˜¯ä¸€ä¸ªæ’é™¤æ³•ï¼Œæˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆä»ä¼˜åŠ¿ä¸Šæ¯”è¾ƒã€‚</p>
<p>Rè¯­è¨€æ²¡å­¦è¿‡ï¼ŒJuliaä¹Ÿæ²¡æœ‰ï¼Œæ‰€ä»¥å›å½’å·¥å…·é½å…¨çš„Pythonã€‚</p>
<h2 id="python-æ•°æ®åˆ†æå¥—è£…">Python æ•°æ®åˆ†æå¥—è£…</h2>
<p>å»ºè®®ç›®æ ‡å°±æ˜¯åˆ†ææ•°æ®çš„äººç›´æ¥å®‰è£…<code>anaconda</code>ï¼Œä½¿ç”¨jupyter labï¼Œä¸æŠ˜è…¾ã€‚</p>
<ul>
<li>å¯¹äºæ•°æ®è¯»å…¥å’Œæ¸…æ´—ï¼š<code>Pandas</code></li>
<li>å¯¹äºçŸ©é˜µç­‰å‘é‡è¿ç®—ï¼š<code>numpy</code></li>
<li>å¯¹äºè®¡ç®—æœºä»£æ•°è®¡ç®—ï¼š<code>sympy</code></li>
</ul>
<h3 id="ç»˜å›¾">ç»˜å›¾</h3>
<p>ç»˜å›¾çš„åº“å°±å¾ˆå¤šäº†ã€‚Matplotlibï¼ŒPlotlyï¼ŒSeabornï¼ŒAltairè¿™å‡ ä¸ªè¿˜ä¸é”™ã€‚ç¬¬ä¸€ä¸ªæ¯”è¾ƒåº•å±‚ï¼Œæ˜¯ç›´æ¥å‚ç…§Matlabçš„APIè®¾è®¡çš„ï¼ŒSeabornæ˜¯åœ¨å…¶åŸºç¡€ä¸Šè®¾è®¡çš„æ›´é«˜å±‚çš„ç»˜å›¾åŒ…,æ‰€ä»¥ä½¿ç”¨ã€é…è‰²ã€æ’ç‰ˆä»€ä¹ˆçš„éƒ½ä¸é”™ã€‚Plotlyå’ŒAltairéƒ½æ˜¯å…·æœ‰ä¸€å®šäº¤äº’èƒ½åŠ›çš„ç»˜å›¾åŒ…ï¼Œåœ¨labé‡Œæ˜¯éœ€è¦å‰ç«¯jsé…åˆç»˜å›¾çš„ï¼ˆæ‰€ä»¥ä¸€æ—¦å›¾ç‰‡æ•°æ®å¤ªå¤šï¼Œä¼šå¡å¾—æµè§ˆå™¨ç—›ä¸æ¬²ç”Ÿï¼‰ã€‚</p>
<p>æˆ‘å°±èƒ¡ä¹±é€‰äº†ä¸ªPlotlyã€‚ä¸è¿‡ç°åœ¨çœ‹æ¥å¤§æ¦‚æ˜¯ä¸ªé”™è¯¯çš„å†³å®šã€‚</p>
<h3 id="plotlyåœ¨å›½å†…é…ç½®çš„å‘">Plotlyåœ¨å›½å†…é…ç½®çš„å‘</h3>
<p>çœ‹ç€npmå’Œyarnè¿™ä¸¤ä¸ªå­—çœ¼å°±å®³æ€•ç°åœ¨ã€‚jsé‚£ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„å·¥å…·é“¾ï¼Œæ”¯æŒåº¦å„ä¸ç›¸åŒçš„æ ‡å‡†ï¼Œè¿™é‡Œå¯ä»¥importï¼Œé‚£é‡Œåˆä¼šceå¿…é¡»ç”¨requireï¼Œåˆletåˆvarï¼Œåˆ°ç°åœ¨ä¹Ÿæ•´ä¸æ¸…æ¥šçš„thiså’Œthatï¼Œæœ‰çš„åŒ…è¦æ±‚ä¼ æ­£ç¡®çš„lambdaè¡¨è¾¾å¼ï¼Œæœ‰çš„åˆå¿…é¡»ç”¨functionï¼Œè¿˜æœ‰ä¸€å †å‘â€¦â€¦çœ‹ç€å°±æƒ³èº²ç€èµ°ï¼Œç„¶è€Œè¿™plotlyçš„æ„å»ºæ˜¯éœ€è¦npmå’Œyarnçš„ã€‚</p>
<p>â€¦â€¦ä¸ºä»€ä¹ˆè¿™ç ´è¯­è¨€èƒ½ç”¨åˆ°ç°åœ¨ã€‚</p>
<p>åœ¨å®‰è£…Plotlyå‘Jupyter labçš„æ”¯æŒåº“æ—¶ï¼Œåˆ‡å‹¿åœ¨<code>npm</code>å’Œ<code>yarn</code>ä¸­ä½¿ç”¨é•œåƒã€‚é•œåƒå’Œæºä¹‹é—´æœ‰ä¸€å®šçš„æ›´æ–°å»¶è¿Ÿå¹¶ä¸”å­˜åœ¨åŒæ­¥é”™è¯¯è€Œè·³è¿‡æŸäº›åŒ…çš„é—®é¢˜ã€‚æˆ‘å°±æ­£å¥½å¡åœ¨äº†è¢«è·³è¿‡çš„åŒ…ä¸Šï¼Œå› ä¸ºè¿™ä¸ªé—®é¢˜æ­»æ´»ç¼–è¯‘ä¸è¿‡å»æµªè´¹äº†å¾ˆé•¿æ—¶é—´ã€‚</p>
<p>å…¶æ¬¡ï¼Œä½¿ç”¨Plotlyè¾“å‡º<code>.pdf</code>ç­‰æ ¼å¼çš„å›¾ç‰‡æ–‡ä»¶æ—¶ï¼Œéœ€è¦å®‰è£…<code>ocra</code>ï¼Œåœ¨æœåŠ¡å™¨ä¸Šé…ç½®æ—¶è¿˜éœ€è¦å®‰è£…<code>xvfb</code>ï¼Œè¿™äº›éƒ½åœ¨å…¶æ–‡æ¡£ä¸­æœ‰å†™ï¼Œä¸è¿‡è§†ç³»ç»Ÿä¸åŒä»ç„¶éœ€è¦è‡ªå·±è¡¥é½å¾ˆå¤šæ”¯æŒåº“ã€‚ä»è¿™ä¸ªè§’åº¦ä¸Šæ¥è¯´ï¼Œä¼¼ä¹è¿˜æ˜¯é€‰æ‹©Seaborn+Matplotlabæ¯”è¾ƒå¥½ï¼Œé™¤éä½ æœ‰å·¥å…·äººï¼Œå¦åˆ™ä¸è¦æŠŠæ—¶é—´æµªè´¹åœ¨è«åå…¶å¦™çš„åœ°æ–¹ã€‚</p>
<h2 id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</h2>
<p>numpyå’Œpandaséƒ½æœ‰å¿«é€Ÿå…¥é—¨æ•™ç¨‹ï¼ŒèŠ±20åˆ†é’Ÿè¯»ä¸€è¯»ï¼Œç„¶åå‰©ä¸‹çš„éšç”¨éšæŸ¥å°±å¥½äº†ã€‚</p>
<p>è¿™é‡Œè®°å‡ ä¸ªå¸¸ç”¨ä½†æ˜¯ä¸å¤ªå¥½æ‰¾çš„ä¸œè¥¿ã€‚</p>
<h3 id="å¦‚ä½•éå†æ•°æ®å¸§çš„æ‰€æœ‰è¡Œ">å¦‚ä½•éå†æ•°æ®å¸§çš„æ‰€æœ‰è¡Œ</h3>
<p>æ ‡å‡†æ“ä½œæ˜¯<code>apply</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#039;pass&amp;#039;]=df.apply(lambda a:a[&amp;#039;grade&amp;#039;]&gt;=60,axis=1)</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯ï¼Œè¿™ç©æ„çš„å‘åœ¨äºä¼ ç»™å®ƒçš„å‡½æ•°å†…éƒ¨æ˜¯åªèƒ½getä¸èƒ½setçš„ã€‚å³ä½¿setä¹Ÿæ²¡æœ‰ä½œç”¨ã€‚ä¸è¿‡ä¸€èˆ¬ä¿®æ”¹å•åˆ—æ•°æ®ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥åƒä¸Šé¢ä¸€è¡Œä¸€æ ·ã€‚</p>
<p>å¦å¤–æ—¶åˆ»è®°ä½ï¼Œç­›é€‰çš„æ•°æ®å¸§ç»“æœ<strong>ä¹Ÿæ˜¯ä¸èƒ½setçš„</strong>ã€‚è™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯æˆ‘åœ¨è¸©è¿™ä¸ªå‘çš„æ—¶å€™ï¼Œæœ‰äº›æ—¶å€™ä¸ä½†ä¸ä¼šä¿®æ”¹è€Œä¸”è¿é”™è¯¯ä¹Ÿä¸ä¼šæŠ¥ã€‚</p>
<p>ä¸è¿‡å¦‚æœæ˜¯ä¿®æ”¹å¤šè¡Œæ•°æ®å‘¢ï¼Œä¸Šé¢çš„å‘½ä»¤æ˜¯ä¸èƒ½ç®€å•æ¨å¹¿çš„ã€‚å½“ç„¶å¯ä»¥ç”¨ä¸€äº›å¾ˆä¸‘é™‹çš„åšæ³•ï¼Œæ¯”å¦‚<code>for i in range(df.shape[0])</code>ï¼ˆå¯èƒ½æœ‰ç¨å¾®å¥½çœ‹ä¸€ç‚¹çš„å†™æ³•ï¼‰ç„¶å<code>iloc</code>ä¸€ä¸ªä¸ªçš„æ”¹æ‰ã€‚ä¸è¿‡å®é™…ä¸Šï¼Œä»ç„¶æœ‰ä½¿ç”¨<code>apply</code>çš„ä½™åœ°ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#039;è®¡ç®—æœºå¯¼â™‚è®º&amp;#039;])*10,math.sqrt(row[&amp;#039;é«˜ç­‰â™‚æ•°å­¦&amp;#039;])*10</span>

<span class="n">df</span><span class="p">[</span><span class="o">&amp;</span><span class="c1">#039;è®¡ç®—æœºå¯¼â™‚è®º&amp;#039;],df[&amp;#039;é«˜ç­‰â™‚æ•°å­¦&amp;#039;]=zip(*df.apply(fn,axis=1))</span>
</code></pre></td></tr></table>
</div>
</div><p>å¼€æ–¹ä¹˜åï¼Œæ ‡å‡†çš„æäººæ–¹æ³•è¦ä¸è¦äº†è§£ä¸€ä¸‹ã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆå¯è¯»æ€§è¾ƒå·®ï¼Œä¸è¿‡å®æµ‹æ˜¯å¿«äºæ‰‹åŠ¨éå†çš„ã€‚å¬è¯´pythonä¸æƒ³è®©äººç®¡å¤æ‚åº¦ï¼Œäº‹å®å´ä¸å¤§è¡Œå•Šã€‚</p>
<h3 id="plotlyçš„æ•´ä½“è®¾è®¡">Plotlyçš„æ•´ä½“è®¾è®¡</h3>
<p>Plotlyçš„å®˜æ–¹æ–‡æ¡£å†™å¾—å¾ˆå¥½ï¼Œçœ‹å®Œæ¦‚è§ˆåè´¹ç‚¹åŠŸå¤«å°±èƒ½æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„å›¾çš„ç”»æ³•ã€‚å†æƒ³è‡ªå®šä¹‰å°±å»ç¿»APIã€‚</p>
<p>æ€»ä½“æ¥çœ‹ï¼Œ<code>graph_object</code>ï¼ˆå¥½åƒæ˜¯è¿™ä¹ˆæ‹¼ï¼Ÿï¼‰æ˜¯æœ€åŸºç¡€çš„ç»˜å›¾å¯¹è±¡ï¼Œè®¾ç½®å¥½å›¾ä¾‹ååŠ å…¥åˆ°<code>Figure</code>é‡Œï¼Œå°±å¯ä»¥ä½œä¸ºæœ€ç»ˆç»“æœè¾“å‡ºã€‚<code>express</code>æ˜¯ä¸€ä¸ªæ›´é«˜å±‚çš„å·¥å‚ï¼Œèƒ½å¤Ÿæ»¡è¶³ä¸€èˆ¬æƒ…å†µå¸¸ç”¨çš„å›¾çš„å¿«é€Ÿç»˜åˆ¶ã€‚æ‰€ä»¥ï¼Œå…ˆå»<code>express</code>ï¼Œæ»¡è¶³ä¸äº†å†å¾€ä¸‹æ‰¾ã€‚</p>
<p>å¦‚æœçœ‹å®Œæ¦‚è§ˆäº†ä¹‹åè¿˜èƒ½å‘ç°ä¸€ä¸ªå¾ˆé‡è¦çš„ä¿¡æ¯ã€‚è®¾ç½®å›¾ä¾‹å±æ€§æ—¶å¯èƒ½ä¼šé‡åˆ°åµŒå¥—å¤šå±‚å¯¹è±¡çš„é‚£ç§å‚æ•°ï¼Œè¿™æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨<code>_</code>è¿æ¥å‚æ•°åï¼Œä¸éœ€è¦ä¸€å±‚å±‚æ„é€ ã€‚</p>
<p>çŸ¥é“è¿™äº›ä¹‹åéšä¾¿ç”»å°±æ˜¯äº†ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æ¢ä¸ªä¸»é¢˜</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/change-theme/" />
            <id>https://blog.kanari.moe/gossip/change-theme/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-02-21T17:43:17+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[[music autoplay=&quot;0&quot;]40915181[/music] ä¸Šé¢è¿™ä¸ªæ”¹ç¼–çš„äº¤å“ä¹è¿˜ä¸é”™ï¼Œé¡ºä¾¿æµ‹è¯•ä¸€ä¸‹éŸ³ä¹ç›’ è¿™ä¸ªä¸»é¢˜è¿˜å¯ä»¥ï¼Œæœ‰ä¸€äº›æ¯”è¾ƒæ¯”è¾ƒæœ‰è¶£â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>[music autoplay=&quot;0&quot;]40915181[/music]</p>
<blockquote>
<p>ä¸Šé¢è¿™ä¸ªæ”¹ç¼–çš„äº¤å“ä¹è¿˜ä¸é”™ï¼Œé¡ºä¾¿æµ‹è¯•ä¸€ä¸‹éŸ³ä¹ç›’</p>
</blockquote>
<p>è¿™ä¸ªä¸»é¢˜è¿˜å¯ä»¥ï¼Œæœ‰ä¸€äº›æ¯”è¾ƒæ¯”è¾ƒæœ‰è¶£çš„ä¸œè¥¿ã€‚</p>
<p>å…¶å®æ˜¯è¿ç³»ç»Ÿéƒ½æ¢äº†â€¦â€¦ä¸æƒ³æŠ˜è…¾äº†ï¼Œè¿˜æ˜¯è¿™æ ·ç®—äº†ã€‚</p>
<h2 id="ä¿®æ”¹çš„åœ°æ–¹">ä¿®æ”¹çš„åœ°æ–¹</h2>
<ul>
<li>åœ¨headéƒ¨åˆ†æ·»åŠ äº†æµè§ˆç»Ÿè®¡ã€‚</li>
<li>åœ¨pjaxè°ƒç”¨çš„jqueryå°è£…æ’ä»¶å¤„æ·»åŠ äº†mathjaxçš„é‡æ–°æ¸²æŸ“ã€‚</li>
<li>è¿›ä¸€æ­¥å¯ç”¨äº†cdnä¸¥æ ¼æ¨¡å¼çš„SSL/TLSã€‚</li>
<li>å…³é—­äº†ä¸»é¢˜è‡ªå¸¦çš„ä»£ç é«˜äº®ï¼Œå¯ç”¨äº†Prismé«˜äº®ï¼Œå¹¶ä¸”é…ç½®åœ¨pjaxçš„é‡æ–°æ¸²æŸ“ã€‚(ä¿®æ”¹è®¾è®¡pjax.jså’Œä¸»é¢˜è‡ªèº«js,å…±ä¸¤å¤„;å¦å¤–csså†…æ ·å¼æœªå»é™¤)</li>
<li>ä¿®æ”¹äº†å½’æ¡£é¡µé¢çš„éƒ¨åˆ†è¯­å¥â€¦â€¦è¿˜æœ‰404é¡µé¢çš„éƒ¨åˆ†è¯­å¥â€¦â€¦ï¼ˆå¸Œæœ›æ²¡æœ‰æ¼ç½‘çš„</li>
</ul>
<p>å¦‚æœä½ çœ‹åˆ°æµè§ˆå™¨ä»ç„¶æç¤ºä¸å®‰å…¨ï¼Œæ˜¯å› ä¸ºç½‘ç«™å†…ä»ç„¶æœ‰ä¸€äº›å›¾ç‰‡ä½¿ç”¨äº†httpï¼Œä»€ä¹ˆæ—¶å€™é—²å¾—æ²¡äº‹å†æ¥ä¿®ã€‚å¦å¤–å›¾ç‰‡åŠ è½½è¿™ä¹ˆæ…¢æˆ‘ä¹Ÿæ²¡ä»€ä¹ˆåŠæ³•ï¼Œæ¯•ç«Ÿä¸–ç•Œä¸Šçš„äº’è”ç½‘åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚</p>
<p>æœåŠ¡å™¨å¯¹ä¸­æ–‡urlçš„æ”¯æŒè²Œä¼¼ä¹Ÿæœ‰äº›é—®é¢˜ã€‚</p>
<h2 id="å‡æœŸå°†è¿‡">å‡æœŸå°†è¿‡</h2>
<p>å‡æœŸå°±è¿™ä¹ˆæ²¡äº†ã€‚å¤´ç§ƒã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æ ‘é“¾å‰–åˆ†</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/heavy-light-decomposition/" />
            <id>https://blog.kanari.moe/study/heavy-light-decomposition/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-02-18T16:11:56+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[æ ‘é“¾å‰–åˆ†å¯ä»¥ç”¨æ¥ç»´æŠ¤æ ‘ä¸Šè·¯å¾„çš„ä¿¡æ¯ã€‚æŠŠæ ‘ä¸Šçš„èŠ‚ç‚¹æ‹†æˆä¸è¶…è¿‡$O(\log n)$æ®µè¿ç»­â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>æ ‘é“¾å‰–åˆ†å¯ä»¥ç”¨æ¥ç»´æŠ¤æ ‘ä¸Šè·¯å¾„çš„ä¿¡æ¯ã€‚æŠŠæ ‘ä¸Šçš„èŠ‚ç‚¹æ‹†æˆä¸è¶…è¿‡$O(\log n)$æ®µè¿ç»­çš„è·¯å¾„ï¼ˆé“¾ï¼‰ï¼Œä»¥æ˜ å°„åˆ°çº¿æ®µæ ‘æˆ–è€…ä»€ä¹ˆçš„æ„æ¥ç»´æŠ¤æ•°æ®ã€‚</p>
<p>ä¾ç…§å­æ ‘çš„å¤§å°ï¼Œå°†æœ€å¤§å­æ ‘ä½œä¸ºé‡è¾¹ï¼Œå…¶ä»–å­æ ‘ä½œä¸ºè½»è¾¹ï¼Œä»è€Œåœ¨æ ‘ä¸Šæ‹†åˆ†å‡ºå¤šæ¡é“¾ã€‚ä¸ºåŒä¸€æ¡é“¾ä¸Šçš„èŠ‚ç‚¹è¿ç»­ç¼–å·ï¼Œå®Œæˆå‰–åˆ†ã€‚è‡³äºå‰©ä¸‹çš„ï¼Œä¾ç…§ç¼–å·ä¸€æ¡é“¾å¯ä»¥è¿ç»­çš„æ˜ å°„åˆ°æ•°æ®ç»“æ„çš„æŸä¸ªå–é—´å†…ï¼Œç”¨ç±»ä¼¼äºå€å¢LCAçš„æ–¹æ³•åœ¨æ ‘ä¸Šå¾—åˆ°æ¯ä¸€ä¸ªè¯¢é—®æ‰€è¦†ç›–çš„é“¾çš„èµ·å§‹ä¸ç»“å°¾ç„¶åç»§ç»­å…¶ä»–æ“ä½œå°±å¯ä»¥äº†ã€‚</p>
<h2 id="é€šå¸¸ç­–ç•¥">é€šå¸¸ç­–ç•¥</h2>
<ul>
<li>å¯¹äºå­æ ‘çš„å¤§å°ç»Ÿè®¡ï¼Œdfså³å¯ã€‚</li>
<li>ä¹‹åèŠ‚ç‚¹ç¼–å·ä½¿ç”¨å…ˆåºçš„dfsåºï¼Œå¹¶ä¸”<strong>ä¼˜å…ˆè¿›å…¥é‡è¾¹</strong>ï¼Œä»¥ä¿è¯é“¾ä¸ŠèŠ‚ç‚¹çš„ç¼–å·è¿ç»­ã€‚</li>
<li>ä¸ºäº†åœ¨é“¾ä¸Šå¿«é€Ÿè·³è½¬ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸ªèŠ‚ç‚¹æ‰€åœ¨é“¾çš„å¤´ã€‚</li>
</ul>
<p>å…·ä½“çš„ä»£ç å¯ä»¥çœ‹ä¸‹é¢ä¸¤ä¸ªé¢˜ç›®ã€‚<del>å…¶å®æˆ‘ä¹Ÿæ˜¯ä»åˆ«å¤„æŠ„äº†æ¿å­</del></p>
<h2 id="hdu-3966-aragorns-story">HDU 3966 Aragorn's Story</h2>
<p>é¢˜ç›®è¦æ±‚åŒºé—´ä¿®æ”¹æŸæ¡è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„æƒå€¼ï¼ŒæŸ¥è¯¢æŸä¸ªç‚¹çš„æƒå€¼ã€‚</p>
<p>å°±å‰–ï¼Œå‰–å®Œçº¿æ®µæ ‘è¿˜æ˜¯æ ‘çŠ¶æ•°ç»„åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">50010</span><span class="p">;</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">vlen</span><span class="p">,</span><span class="n">elen</span><span class="p">,</span><span class="n">qlen</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">tick</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">fa</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">sz</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">dep</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">son</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">top</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">dfn</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">rnk</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">f</span><span class="p">){</span>
	<span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">;</span>
	<span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">dep</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">==</span><span class="n">f</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
		<span class="n">dfs1</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
		<span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
		<span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">&gt;</span><span class="n">sz</span><span class="p">[</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]]){</span>
			<span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">f</span><span class="p">){</span>
	<span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">;</span>
	<span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=++</span><span class="n">tick</span><span class="p">;</span>
	<span class="n">rnk</span><span class="p">[</span><span class="n">tick</span><span class="p">]</span><span class="o">=</span><span class="n">u</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
	<span class="n">dfs2</span><span class="p">(</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">f</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">!=</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">v</span><span class="o">!=</span><span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="n">dfs2</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">FTN</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">MAXN</span><span class="o">+</span><span class="mi">10</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ft</span><span class="p">[</span><span class="n">FTN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">lowbit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
	<span class="k">return</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">ftadd</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(;</span><span class="n">pos</span><span class="o">&lt;</span><span class="n">FTN</span><span class="p">;</span><span class="n">pos</span><span class="o">+=</span><span class="n">lowbit</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="n">ft</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">ftget</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(;</span><span class="n">pos</span><span class="p">;</span><span class="n">pos</span><span class="o">-=</span><span class="n">lowbit</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span><span class="n">res</span><span class="o">+=</span><span class="n">ft</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
	<span class="k">return</span> <span class="n">ftget</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">pos</span><span class="p">]);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
	<span class="n">ftadd</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
	<span class="n">ftadd</span><span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">,</span><span class="kt">int</span> <span class="n">delta</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">fx</span><span class="o">=</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">fy</span><span class="o">=</span><span class="n">top</span><span class="p">[</span><span class="n">y</span><span class="p">];</span>
	
	<span class="k">while</span><span class="p">(</span><span class="n">fx</span><span class="o">!=</span><span class="n">fy</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">fx</span><span class="p">]</span><span class="o">&gt;</span><span class="n">dep</span><span class="p">[</span><span class="n">fy</span><span class="p">])</span><span class="n">modify</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">fx</span><span class="p">],</span><span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">delta</span><span class="p">),</span><span class="n">x</span><span class="o">=</span><span class="n">fa</span><span class="p">[</span><span class="n">fx</span><span class="p">];</span>
		<span class="k">else</span> <span class="n">modify</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">fy</span><span class="p">],</span><span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">delta</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">fa</span><span class="p">[</span><span class="n">fy</span><span class="p">];</span>

		<span class="n">fx</span><span class="o">=</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
		<span class="n">fy</span><span class="o">=</span><span class="n">top</span><span class="p">[</span><span class="n">y</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="n">y</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">&lt;</span><span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">])</span><span class="n">modify</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">delta</span><span class="p">);</span>
		<span class="k">else</span> <span class="n">modify</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">delta</span><span class="p">);</span>
	<span class="p">}</span><span class="k">else</span> <span class="n">modify</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">delta</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>

	<span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">vlen</span><span class="p">,</span><span class="o">&amp;</span><span class="n">elen</span><span class="p">,</span><span class="o">&amp;</span><span class="n">qlen</span><span class="p">)){</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">vlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">ft</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">fa</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">sz</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dep</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">son</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">son</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">top</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">top</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dfn</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">rnk</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">rnk</span><span class="p">));</span>
		<span class="n">tick</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">vlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="n">num</span><span class="o">+</span><span class="n">i</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">elen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">u</span><span class="p">,</span><span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
			<span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
			<span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">dfs1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
		<span class="n">dfs2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
		<span class="cm">/*
</span><span class="cm">		for(int i=1;i&lt;=vlen;i++)
</span><span class="cm">			cout&lt;&lt;dfn[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">		cout&lt;&lt;endl;
</span><span class="cm">		*/</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">vlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="n">modify</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">dfn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="p">}</span>
		<span class="cm">/*
</span><span class="cm">		for(int i=1;i&lt;=vlen;i++){
</span><span class="cm">			cout&lt;&lt;query(i)&lt;&lt;&#34; &#34;;
</span><span class="cm">		}
</span><span class="cm">		cout&lt;&lt;endl;
</span><span class="cm">		*/</span>

		<span class="k">while</span><span class="p">(</span><span class="n">qlen</span><span class="o">--</span><span class="p">){</span>
			<span class="kt">char</span> <span class="n">opt</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">opt</span><span class="p">);</span>
			<span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="sc">&#39;I&#39;</span> <span class="o">||</span> <span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="sc">&#39;D&#39;</span><span class="p">){</span>
				<span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">;</span>
				<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">l</span><span class="p">,</span><span class="o">&amp;</span><span class="n">r</span><span class="p">,</span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span>
				<span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="sc">&#39;D&#39;</span><span class="p">)</span><span class="n">x</span><span class="o">=-</span><span class="n">x</span><span class="p">;</span>
				<span class="n">solve</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
			<span class="p">}</span><span class="k">else</span><span class="p">{</span>
				<span class="kt">int</span> <span class="n">u</span><span class="p">;</span>
				<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">u</span><span class="p">);</span>
				<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="p">));</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>	


    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="cf343d-water-tree">CF343D Water Tree</h2>
<p>ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·ã€‚ä¿®æ”¹1è¦æ±‚ä¸ºç‚¹çš„æ•´ä¸ªå­æ ‘æ‰“æ ‡è®°ï¼Œä¿®æ”¹2è¦æ±‚å–æ¶ˆèŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹ä¸Šçš„æ ‡è®°ã€‚</p>
<p>æŒ‰ç…§dfsåºçš„ç¼–å·æ–¹å¼ï¼Œä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹è®°å½•è¿›å…¥æ—¶é—´å’Œç¦»å¼€æ—¶é—´ï¼Œå°±èƒ½å¾—åˆ°è¯¥èŠ‚ç‚¹å­æ ‘æ˜ å°„åçš„è¿ç»­åŒºé—´ã€‚é‚£ä¹ˆæµ‡æ°´å°±å¯ä»¥å¥—ä¸€ä¸ªçº¿æ®µæ ‘ç›´æ¥æ”¹äº†ã€‚æ¸…ç©ºæ°´å¾€æ ¹èŠ‚ç‚¹è·³ç„¶åä¿®æ”¹ä¸€è·¯ä¸Šç»è¿‡çš„é“¾ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">500010</span><span class="p">;</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">vlen</span><span class="p">,</span><span class="n">elen</span><span class="p">,</span><span class="n">qlen</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">tick</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">fa</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">sz</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">dep</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">son</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">top</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">dfn</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">outdfn</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">f</span><span class="p">){</span>
	<span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">;</span>
	<span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">dep</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">==</span><span class="n">f</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
		<span class="n">dfs1</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
		<span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
		<span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">&gt;</span><span class="n">sz</span><span class="p">[</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]]){</span>
			<span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">v</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">f</span><span class="p">){</span>
	<span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">;</span>
	<span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=++</span><span class="n">tick</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
		<span class="n">outdfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=++</span><span class="n">tick</span><span class="p">;</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">dfs2</span><span class="p">(</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">f</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">!=</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">v</span><span class="o">!=</span><span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="n">dfs2</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">outdfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=++</span><span class="n">tick</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">FTN</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">MAXN</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">10</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">dat</span><span class="p">[</span><span class="n">FTN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">FTN</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">FTN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">root</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="n">n</span><span class="o">=++</span><span class="n">idx</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;=</span><span class="n">r</span><span class="p">){</span>
		<span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">);</span>
	<span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">pushdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
	<span class="n">dat</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">=</span><span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
	<span class="n">dat</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">=</span><span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
	<span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">fill_water</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
		<span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">fill_water</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">fill_water</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">f</span><span class="o">**</span><span class="nf">k_water</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
		<span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">f</span><span class="o">**</span><span class="n">k_water</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">f</span><span class="o">**</span><span class="n">k_water</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">F</span><span class="o">**</span><span class="nf">K_WATER</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">){</span>
	<span class="k">while</span><span class="p">(</span><span class="n">u</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
		<span class="c1">//cout&lt;&lt;&#34;clear &#34;&lt;&lt;dfn[u]&lt;&lt;endl;
</span><span class="c1"></span>		<span class="n">f</span><span class="o">**</span><span class="n">k_water</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]],</span><span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">tick</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
		<span class="n">u</span><span class="o">=</span><span class="n">fa</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]];</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
	<span class="c1">//1æœ‰æ°´
</span><span class="c1"></span>	<span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">==</span><span class="n">pos</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">==</span><span class="n">pos</span><span class="p">)</span><span class="k">return</span> <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
	<span class="k">else</span> <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
<span class="p">}</span>



<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">vlen</span><span class="p">;</span>
	<span class="n">elen</span><span class="o">=</span><span class="n">vlen</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">elen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">u</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="p">;</span>
		<span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
		<span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">dfs1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">dfs2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

	<span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tick</span><span class="p">);</span>
	<span class="cm">/*
</span><span class="cm">	for(int i=1;i&lt;=vlen;i++){
</span><span class="cm">		cout&lt;&lt;dfn[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">	}
</span><span class="cm">	cout&lt;&lt;endl;
</span><span class="cm">	for(int i=1;i&lt;=vlen;i++){
</span><span class="cm">		cout&lt;&lt;outdfn[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">	}
</span><span class="cm">	cout&lt;&lt;endl;
</span><span class="cm">	*/</span>

	<span class="kt">int</span> <span class="n">qlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">qlen</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">qlen</span><span class="o">--</span><span class="p">){</span>
		<span class="kt">int</span> <span class="n">opt</span><span class="p">,</span><span class="n">u</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">opt</span><span class="o">&gt;&gt;</span><span class="n">u</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
			<span class="n">fill_water</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">outdfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tick</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
			<span class="c1">//cout&lt;&lt;&#34;add &#34;&lt;&lt;dfn[u]&lt;&lt;&#34;-&#34;&lt;&lt;outdfn[u]&lt;&lt;endl;
</span><span class="c1"></span>		<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
			<span class="n">F</span><span class="o">**</span><span class="n">K_WATER</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
			<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">query</span><span class="p">(</span><span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">tick</span><span class="p">,</span><span class="n">root</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1165F2]Microtransactions</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1165f2microtransactions/" />
            <id>https://blog.kanari.moe/code/cf-1165f2microtransactions/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-01-21T15:11:56+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions â€” and he won't start playing until he gets all of them.</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Ivan plays a computer game that contains some microtransactions to make characters look cooler. Since Ivan wants his character to be really cool, he wants to use some of these microtransactions â€” and he won't start playing until he gets all of them.</p>
<p>Each day (during the morning) Ivan earns exactly one burle.</p>
<p>There are n types of microtransactions in the game. Each microtransaction costs 2 burles usually and 1 burle if it is on sale. Ivan has to order exactly ki microtransactions of the i-th type (he orders microtransactions during the evening).</p>
<p>Ivan can order any (possibly zero) number of microtransactions of any types during any day (of course, if he has enough money to do it). If the microtransaction he wants to order is on sale then he can buy it for 1 burle and otherwise he can buy it for 2 burles.</p>
<p>There are also m special offers in the game shop. The j-th offer (dj,tj) means that microtransactions of the tj-th type are on sale during the dj-th day.</p>
<p>Ivan wants to order all microtransactions as soon as possible. Your task is to calculate the minimum day when he can buy all microtransactions he want and actually start playing.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¦–å…ˆï¼Œä¸å…³æ³¨åˆ°åº•ä¹°äº†å“ªä¸ªå•†å“ï¼Œå› ä¸ºæ¯ç§å•†å“çš„ä»·æ ¼éƒ½ä¸€æ ·ï¼Œè®°$i$ç§å•†å“éœ€è¦$k_i$ï¼Œå…¨ä½“å•†å“æ€»æ•°$K$ã€‚</p>
<p>é¦–å…ˆï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•ä¼˜æƒ ï¼Œéœ€è¦$2K$å¤©ã€‚åœ¨æœ‰ä¼˜æƒ æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°½å¯èƒ½åœ¨ä¼˜æƒ <strong>å½“å¤©</strong>ä¹°é½éœ€è¦çš„å•†å“ã€‚æˆ‘ä»¬æ”¾å¼€çš„å¤©æ•°è¶Šå¤šï¼Œé’±è¶Šå¤šï¼ŒåŒæ—¶ä¹Ÿè¶Šæœ‰å¯èƒ½é‡åˆ°ä¼˜æƒ ï¼ˆèŠ±çš„é’±å‡å°‘ï¼‰ã€‚ä»¥æ­¤ï¼Œé¢˜ç›®å…·æœ‰å•è°ƒæ€§ã€‚</p>
<p>äºŒåˆ†æ—¶é—´$t$ã€‚å¾—å‡ºå“ªç§å•†å“æœ‰ä¼˜æƒ ï¼Œå¹¶ä»$2K$å…ƒå†…æŠµæ¶ˆä¼˜æƒ éƒ¨åˆ†ã€‚å°½é‡å°†ä¹°å•†å“çš„å†³ç­–æ‹–åˆ°è¯¥å•†å“æœ€åä¸€æ¬¡ä¼˜æƒ è¿›è¡Œï¼Œè‹¥å•†å“æœ‰ä¼˜æƒ ï¼Œä¹°æ¯”ä¸ä¹°å¥½ï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½å°†æ‰‹ä¸­ç§¯æ”’çš„é’±æ‰”å‡ºå»ã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯è¶Šé åçš„å•†å“æˆ‘ä»¬èƒ½å¤Ÿç”¨ä¹‹åçš„é’±å»ä¹°ï¼Œä½†æ˜¯æ›´é å‰çš„ä¼˜æƒ å¯èƒ½ä¼šå› ä¸ºä¹°äº†å‰è¿°é‚£ç§å•†å“è€Œæ²¡æœ‰æ›´å¤šé’±è´­ä¹°ã€‚å› æ­¤å°†æ¯ç§å•†å“è´­ä¹°æ—¶æœºæ‹–å¾—è¶Šæ™šè¶Šå¥½ï¼Œè¿™æ ·æˆ‘ä»¬é¡¶å¤šä¼šé‡åˆ°æ²¡é’±ä¹°ä¸‹ä¸€ä¸ªä¼˜æƒ çš„é—®é¢˜ï¼Œä¸è¿‡äºŒè€…è´¡çŒ®ä¸€æ ·ï¼Œè¿™å¯¹æœ€ç»ˆç­”æ¡ˆæ²¡æœ‰å½±å“ã€‚å› ä¸ºè¿™ç©æ„waäº†ä¸€å‘..</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">400010</span><span class="p">;</span>

<span class="c1">// å•†å“æ•°ç›® æ‰“æŠ˜æ¬¡æ•°
</span><span class="c1"></span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">wanted</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">bwanted</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">offs</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">goodoff</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span><span class="c1">//ç¬¬iç§å•†å“æœ€åçš„æ‰“æŠ˜æ—¶æœº
</span><span class="c1"></span><span class="kt">int</span> <span class="n">maxday</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">summ</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="n">ll</span> <span class="n">day</span><span class="p">){</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">goodoff</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">goodoff</span><span class="p">));</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">wanted</span><span class="p">,</span><span class="n">bwanted</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">wanted</span><span class="p">));</span>

	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="n">maxday</span><span class="p">,</span><span class="n">day</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">t</span><span class="p">:</span><span class="n">offs</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
			<span class="n">goodoff</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="cm">/*
</span><span class="cm">	cout&lt;&lt;&#34;end at &#34;&lt;&lt;day&lt;&lt;endl;
</span><span class="cm">	for(int i=1;i&lt;=n;i++){
</span><span class="cm">		cout&lt;&lt;goodoff[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">	}
</span><span class="cm">	cout&lt;&lt;endl;
</span><span class="cm">	*/</span>
	<span class="n">ll</span> <span class="n">cost</span><span class="o">=</span><span class="n">summ</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">ll</span> <span class="n">free</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="n">maxday</span><span class="p">,</span><span class="n">day</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">free</span><span class="o">++</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">t</span><span class="p">:</span><span class="n">offs</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
			<span class="k">if</span><span class="p">(</span><span class="n">goodoff</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">free</span><span class="o">&gt;</span><span class="n">wanted</span><span class="p">[</span><span class="n">t</span><span class="p">]){</span>
				<span class="n">free</span><span class="o">-=</span><span class="n">wanted</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
				<span class="n">cost</span><span class="o">-=</span><span class="n">wanted</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
				<span class="n">wanted</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span><span class="k">else</span><span class="p">{</span>
				<span class="n">wanted</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-=</span><span class="n">free</span><span class="p">;</span>
				<span class="n">cost</span><span class="o">-=</span><span class="n">free</span><span class="p">;</span>
				<span class="n">free</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">cost</span><span class="o">&lt;=</span><span class="n">day</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	
	<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">wanted</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">summ</span><span class="o">+=</span><span class="n">wanted</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">bwanted</span><span class="p">,</span><span class="n">wanted</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">bwanted</span><span class="p">));</span>

	
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="kt">int</span> <span class="n">d</span><span class="p">,</span><span class="n">t</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">d</span><span class="o">&gt;&gt;</span><span class="n">t</span><span class="p">;</span>
		<span class="n">maxday</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxday</span><span class="p">,</span><span class="n">d</span><span class="p">);</span>
		<span class="n">offs</span><span class="p">[</span><span class="n">d</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">ll</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mf">5e5</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">ll</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">mid</span><span class="p">)){</span>
			<span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
		<span class="p">}</span><span class="k">else</span> <span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">r</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1156F]Card Bag</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1156fcard-bag/" />
            <id>https://blog.kanari.moe/code/cf-1156fcard-bag/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-01-21T15:11:18+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>You have a bag which contains n cards. There is a number written on each card; the number on i-th card is ai.</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>You have a bag which contains n cards. There is a number written on each card; the number on i-th card is ai.</p>
<p>You are playing the following game. During each turn, you choose and remove a random card from the bag (all cards that are still left inside the bag are chosen equiprobably). Nothing else happens during the first turn â€” but during the next turns, after removing a card (let the number on it be x), you compare it with the card that was removed during the previous turn (let the number on it be y). Possible outcomes are:</p>
<p>if x &lt; y, the game ends and you lose;
if x = y, the game ends and you win;
if x &gt; y, the game continues.
If there are no cards left in the bag, you lose. Cards are not returned into the bag after you remove them.</p>
<p>You have to calculate the probability of winning in this game. It can be shown that it is in the form of PQ where P and Q are non-negative integers and Qâ‰ 0, Pâ‰¤Q. Output the value of Pâ‹…Qâˆ’1 (mod  998244353).</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>æ•°æ®èŒƒå›´è¶³å¤Ÿé€šè¿‡ç´¯ç§¯æ¯è½®æ¸¸æˆä¸­çš„èƒœç‡æ¥ç®—ã€‚å…ˆæƒ³åŠæ³•ç®—æ¸¸æˆè¿è¡Œåˆ°ç¬¬$i$è½®çš„æ¦‚ç‡ã€‚</p>
<p>å®šä¹‰$f(i,j)$ä¸ºç¬¬iæ¬¡æŠ½å¡æŠ½å‡º$j$ä¸”æ¸¸æˆå°†ç»§ç»­çš„æ¦‚ç‡ï¼Œå‘ç°</p>
<ul>
<li>$f(i,j)$åªèƒ½ä»$f(i,0 \to j-1)$è½¬ç§»ã€‚å¦åˆ™æ¸¸æˆç»“æŸã€‚</li>
<li>ç”±ä¸Šæ¡ï¼Œç¬¬$i$æ¬¡æŠ½å‡º$j$çš„æ¦‚ç‡ä¹Ÿå¯çŸ¥ï¼Œå› ä¸ºå‰é¢æŠ½å¡æ²¡æœ‰æŠ½è¿‡$j$ã€‚</li>
</ul>
<p>è®°ç‰Œæ€»æ•°$n$ï¼Œç‰Œé¢ä¸º$i$çš„ç‰Œæœ‰$c(i)$å¼ ï¼Œæœ‰è½¬ç§»</p>
<div>$$
\begin{aligned}
f(i,j)=\frac{c(j)}{n-i+1}\sum_{0 \leq k \leq j-1}f(i-1,k)
\end{aligned}
$$</div>
<p>æœ‰ç­”æ¡ˆ</p>
<div>$$
\text{ans}=\sum_{1 \leq i,j \leq n} f(i,j)\frac{c(j)-1}{n-i+1}
$$</div>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">5010</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">MOD</span><span class="o">=</span><span class="mi">998244353</span><span class="p">;</span>

<span class="c1">// æ¸¸æˆè¿›è¡Œåˆ°ç¬¬iè½®,æŠ½å‡ºjä¸”æ²¡æœ‰ç»“æŸçš„æ¦‚ç‡
</span><span class="c1"></span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">card</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">inv</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="p">){</span>
	<span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">get_inv</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="p">){</span>
	<span class="k">return</span> <span class="n">qpow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">init_inv</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">get_inv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">MOD</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>


	<span class="kt">int</span> <span class="n">n</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
	<span class="n">init_inv</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="kt">int</span> <span class="n">x</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="p">;</span>
		<span class="n">card</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">ll</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">cnt</span><span class="o">=</span><span class="p">(</span><span class="n">cnt</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>

		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
			<span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">((</span><span class="n">cnt</span><span class="o">*</span><span class="n">card</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">inv</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
			<span class="c1">//cout&lt;&lt;&#34;f(&#34;&lt;&lt;i&lt;&lt;&#34;,&#34;&lt;&lt;j&lt;&lt;&#34;)&#34;&lt;&lt;f[i][j]&lt;&lt;endl;
</span><span class="c1"></span>			<span class="n">cnt</span><span class="o">=</span><span class="p">(</span><span class="n">cnt</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
			<span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">+</span><span class="p">((</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">card</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">inv</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
			<span class="n">ans</span><span class="o">%=</span><span class="n">MOD</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF 1156D] 0-1 Tree</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-1156d-0-1-tree/" />
            <id>https://blog.kanari.moe/code/cf-1156d-0-1-tree/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-01-21T15:10:42+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>You are given a tree</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>You are given a tree</p>
<p>(an undirected connected acyclic graph) consisting of n vertices and nâˆ’1 edges. A number is written on each edge, each number is either 0 (let's call such edges 0-edges) or 1 (those are 1-edges).</p>
<p>Let's call an ordered pair of vertices (x,y) (xâ‰ y) valid if, while traversing the simple path from x to y, we never go through a 0-edge after going through a 1-edge. Your task is to calculate the number of valid pairs in the tree.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å½“ç»è¿‡ä¸€æ¡<code>1</code>ï¼Œå°±ä¸èƒ½å†ç»è¿‡<code>0</code>ã€‚æ‰€ä»¥è·¯å¾„åªä¼šæœ‰ï¼ˆç§°<code>1</code>ä¸ºé»‘ï¼Œ<code>0</code>ä¸ºç™½ï¼‰</p>
<ul>
<li>å…¨<code>0</code></li>
<li>å…¨<code>1</code></li>
<li>ä»æŸå¤„åˆ’åˆ†åä¸€åŠä¸º<code>1</code>ä¸€åŠä¸º<code>0</code></li>
</ul>
<p>ç»´æŠ¤ä»ç‚¹<code>u</code>åˆ°å…¶å­æ ‘ä»»æ„èŠ‚ç‚¹çš„ç™½è‰²è·¯å¾„ï¼Œé»‘è‰²è·¯å¾„æ€»æ•°ã€‚é‚£ä¹ˆç­”æ¡ˆå°±å¯ä»¥ç»Ÿè®¡äº†ã€‚</p>
<ol>
<li>ä»å­æ ‘åˆ°è‡ªå·±çš„é»‘ï¼Œç™½è·¯å¾„</li>
<li>å­æ ‘åˆ°å­æ ‘çš„é»‘ï¼Œç™½è·¯å¾„</li>
<li>ä»¥<code>u</code>ä¸ºåˆ†ç•Œç‚¹çš„é»‘ç™½è·¯å¾„ã€‚åŒ…æ‹¬å­æ ‘åˆ°å­æ ‘ï¼Œå­æ ‘åˆ°éå­æ ‘ã€‚</li>
</ol>
<p>å­æ ‘åˆ°éå­æ ‘çš„é»‘ç™½èŠ‚ç‚¹å·²ç»åŒ…æ‹¬åœ¨ç¬¬1ï¼Œ2éƒ¨åˆ†ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">pii</span><span class="o">=</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXV</span><span class="o">=</span><span class="mi">200010</span><span class="p">,</span><span class="n">MAXE</span><span class="o">=</span><span class="mi">400020</span><span class="p">;</span>


<span class="k">struct</span> <span class="nc">Edge</span><span class="p">{</span>
	<span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
<span class="p">}</span><span class="n">edges</span><span class="p">[</span><span class="n">MAXE</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">MAXV</span><span class="p">],</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">adde</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="kt">int</span> <span class="n">c</span><span class="p">){</span>
	<span class="n">edges</span><span class="p">[</span><span class="o">++</span><span class="n">idx</span><span class="p">].</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">;</span>
	<span class="n">edges</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">n</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
	<span class="n">edges</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">;</span>
	<span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">idx</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//ä»å­æ ‘åˆ°æœ¬èŠ‚ç‚¹ä¸ºç™½è‰²è·¯å¾„æˆ–é»‘è‰²è·¯å¾„çš„æ€»æ•°.
</span><span class="c1">//ä¸åŒ…æ‹¬è‡ªå·±.
</span><span class="c1"></span><span class="n">ll</span> <span class="n">white</span><span class="p">[</span><span class="n">MAXV</span><span class="p">],</span><span class="n">black</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">dfsCal</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ei</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">ei</span><span class="p">;</span><span class="n">ei</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">].</span><span class="n">n</span><span class="p">){</span>
		<span class="n">Edge</span> <span class="o">&amp;</span><span class="n">e</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">];</span>
		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
		<span class="n">dfsCal</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>

		<span class="n">white</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">;</span>
		<span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="n">white</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">white</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">];</span>
		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">black</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">,</span><span class="n">ll</span> <span class="n">w</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span>
	<span class="c1">//å­æ ‘åˆ°æˆ‘
</span><span class="c1"></span>	<span class="n">ans</span><span class="o">+=</span><span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">ans</span><span class="o">+=</span><span class="n">white</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
	<span class="c1">//å­æ ‘åˆ°å­æ ‘
</span><span class="c1"></span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ei</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">ei</span><span class="p">;</span><span class="n">ei</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">].</span><span class="n">n</span><span class="p">){</span>
		<span class="n">Edge</span> <span class="o">&amp;</span><span class="n">e</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">];</span>
		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>

		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
			<span class="n">ans</span><span class="o">+=</span><span class="p">(</span><span class="n">black</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">black</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
			<span class="n">ans</span><span class="o">+=</span><span class="p">(</span><span class="n">white</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">white</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">white</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span>

		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
			<span class="n">ans</span><span class="o">+=</span><span class="p">(</span><span class="n">white</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
		<span class="p">}</span>

		
	<span class="p">}</span>
	<span class="c1">//è·¨è¿‡æˆ‘
</span><span class="c1"></span>	<span class="n">ans</span><span class="o">+=</span><span class="n">b</span><span class="o">*</span><span class="n">white</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
	<span class="n">ans</span><span class="o">+=</span><span class="n">w</span><span class="o">*</span><span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>

	<span class="c1">//cout&lt;&lt;&#34;arrive at &#34;&lt;&lt;u&lt;&lt;&#34; and collect &#34;&lt;&lt;ans&lt;&lt;endl;
</span><span class="c1"></span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ei</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">ei</span><span class="p">;</span><span class="n">ei</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">].</span><span class="n">n</span><span class="p">){</span>
		<span class="n">Edge</span> <span class="o">&amp;</span><span class="n">e</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">];</span>
		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>

		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
			<span class="n">solve</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">+</span><span class="p">(</span><span class="n">black</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">black</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
			<span class="n">solve</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">w</span><span class="o">+</span><span class="p">(</span><span class="n">white</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">white</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
		<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">u</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="o">&gt;&gt;</span><span class="n">c</span><span class="p">;</span>
		<span class="n">adde</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">c</span><span class="p">);</span>
		<span class="n">adde</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">c</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">dfsCal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>

	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="c1">//cout&lt;&lt;white[i]&lt;&lt;&#34; &#34;&lt;&lt;black[i]&lt;&lt;endl;
</span><span class="c1"></span>	<span class="p">}</span>

	<span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>


	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä¸Rustç©è€</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/have-fun-with-rust/" />
            <id>https://blog.kanari.moe/study/have-fun-with-rust/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-01-18T20:39:20+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p><img src="https://blog.kanari.moe/wp-content/uploads/2020/02/unsafe_badge-300x300.jpg" alt="">
æŠŠå…ˆå‰ä¿¡æ¯ä½çš„ä¸¤ç¯‡blogç»™æ‹†äº†,è¿™æ ·å¥½ç‚¹.</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p><img src="https://blog.kanari.moe/wp-content/uploads/2020/02/unsafe_badge-300x300.jpg" alt="">
æŠŠå…ˆå‰ä¿¡æ¯ä½çš„ä¸¤ç¯‡blogç»™æ‹†äº†,è¿™æ ·å¥½ç‚¹.</p>
<h2 id="ä¸€ç‚¹å°æ’æ›²-å¦‚ä½•åœ¨windowsä¸Šçš„rustä½¿ç”¨gnuå·¥å…·é“¾">ä¸€ç‚¹å°æ’æ›²: å¦‚ä½•åœ¨windowsä¸Šçš„rustä½¿ç”¨gnuå·¥å…·é“¾</h2>
<p>ä¼—æ‰€å‘¨çŸ¥windowså¯¹ç¼–ç¨‹çš„ä½“éªŒä¸å¦‚*nixå’Œosx,rustç”šè‡³åœ¨Windowsä¸Šçš„é…ç½®éƒ½éº»çƒ¦ä¸€ç‚¹.æ¯”å¦‚è¯´,ä¸ºäº†è£…ä¸ªrust,å¯èƒ½éœ€è¦å¦å¤–å‡†å¤‡vs2019.è¿™ä¸¤ä¸ªä¸œè¥¿çš„ç©ºé—´å ç”¨å·®äº†ä¸æ­¢ä¸€ç‚¹åŠç‚¹.</p>
<p>æŠ˜è…¾äº†ä¸€å¤©.å¦‚æœèƒ½ä»”ç»†é˜…è¯»å®˜æ–¹çš„rustupæ–‡æ¡£çš„è¯,è¯´ä¸å®šå°±ä¸ç”¨è¿™ä¹ˆå¤´ç§ƒäº†.</p>
<p>ä¸»è¦çš„é€‰é¡¹åœ¨äºé€‰å¥½hostå’Œversion.åœ¨rustupæ‰§è¡Œå®‰è£…æ—¶,ä¿®æ”¹ä¸º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">x86_64-pc-windows-gnu
stable-gnu
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·å®‰è£…çš„ç‰ˆæœ¬æ‰ä¼šä½¿ç”¨gnuå·¥å…·é“¾.ä½†æ˜¯å¦‚æ­¤åšçš„åæœ,æˆ‘è¿˜ä¸å¤ªæ¸…æ¥š.</p>
<h2 id="ä»¥cå¯¹æ’rust">ä»¥Cå¯¹æ’Rust</h2>
<p>è‡ªå·±ä¸»è¦è¿˜æ˜¯Cç³»è¯­è¨€ç”¨æˆ·,æ‰€ä»¥å®é™…å­¦ä¹ æ—¶,æ€»æ˜¯ä¼šç›¸æ¯”è¾ƒç€è¿›è¡Œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="kd">let</span><span class="w"> </span><span class="n">x</span>:<span class="kt">i32</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>é¦–å…ˆ,rustä¹Ÿä½¿ç”¨åˆ†å·.æ¯ä¸ªå˜é‡çš„å£°æ˜å¼€å¤´ä½¿ç”¨let,å¹¶ä¸”å°†å˜é‡ç±»å‹è·Ÿéšåç§°åé¢.</p>
<p>éšç€æ—¶é—´å‘å±•,ç°ä»£è¯­è¨€å‡ ä¹éƒ½æŠ›å¼ƒäº†å˜é‡ç±»å‹åœ¨å·¦ä¾§çš„å£°æ˜æ–¹å¼.è¿™å¤§æ¦‚æ˜¯ä¸€ä¸ªå®è·µä¸Šçš„ç»éªŒ.å·¦ä¾§çš„ç±»å‹å£°æ˜ä¼šåœ¨å¤æ‚çŠ¶å†µä¸‹é€ æˆæå¤§çš„ç†è§£éšœç¢.æ¯”å¦‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">signal</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fp</span><span class="p">)(</span><span class="kt">int</span><span class="p">)))(</span><span class="kt">int</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>é˜…è¯»æ­¤ç±»ä¸œè¥¿,æ€»ä¼šæ˜¯è®©äººå¤´ç–¼.ä½ ä¼šå‘ç°,ä¸ºäº†ç†è§£å®ƒåœ¨å¹²å˜›,è¿™ç§å£°æ˜æ–¹å¼ä½¿å¾—é˜…è¯»é¡ºåºå¿…é¡»æ˜¯é¡ºæ—¶é’ˆçš„èºæ—‹å¼,æ˜¾å¾—å¾ˆä¸è‡ªç„¶å’Œæ˜ç¡®.ä¸€æ—¦è°ƒæ•´ç±»å‹åˆ°å³ä¾§æ—¶,è¿™ä¸ªé—®é¢˜ä¼¼ä¹å°±ä¸å­˜åœ¨äº†.</p>
<p>æ‰€ä»¥ä¸ä½†å˜é‡çš„å£°æ˜ç±»å‹ä½äºåç§°å·¦ä¾§,åŒ…æ‹¬å‡½æ•°å‚æ•°ç±»å‹å’Œè¿”å›å€¼ä¹Ÿéƒ½æ˜¯ä½äºå³ä¾§.</p>
<p>å‰©ä¸‹çš„..</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="c1">//rustä¸­çš„å˜é‡**é»˜è®¤ä¸ºä¸å¯æ›´æ”¹**.å¿…é¡»æ·»åŠ `mut`å…³é”®å­—æ‰ä½œä¸ºä¸€èˆ¬æ„ä¹‰ä¸Šçš„å˜é‡è€ƒè™‘.
</span><span class="c1"></span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">x</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="kd">let</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">y</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="c1">// this is not allowed.
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="c1">//do something
</span><span class="c1"></span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="c1">//do what
</span><span class="c1"></span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="c1">//yeah?
</span><span class="c1"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">//ç‰¹æ®Šçš„æ­»å¾ªç¯
</span><span class="c1"></span><span class="k">loop</span><span class="p">{</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">while</span><span class="w"> </span><span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span><span class="p">{</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">//ç”±äºRustçš„é›¶ä»£ä»·æŠ½è±¡,è¿­ä»£å™¨çš„ä½¿ç”¨æ²¡æœ‰æ€§èƒ½æŠ˜æ‰£.
</span><span class="c1"></span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="p">..</span><span class="mi">9</span><span class="p">{</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="c1">//è¿™ä¸ªæ˜¯å³é—­åŒºé—´
</span><span class="c1"></span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="p">..</span><span class="o">=</span><span class="mi">9</span><span class="p">{</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">//æ‰€æœ‰æ§åˆ¶æµéƒ½æ˜¯è¡¨è¾¾å¼,èƒ½å¤Ÿè¿”å›å€¼;æ‰€ä»¥æˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä¸‰å…ƒè¿ç®—ç¬¦äº†.
</span><span class="c1">//å¯¹äºå¾ªç¯,å¯ä»¥ä½¿ç”¨break.
</span><span class="c1"></span><span class="kd">let</span><span class="w"> </span><span class="n">flag</span><span class="o">=</span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="c1">//æœ€åä¸€è¡Œä¸å†™å¼•å·,ä»£è¡¨è¿”å›è¯¥å€¼.æ²¡è®°é”™çš„è¯åº”è¯¥æ˜¯ä»åˆ«çš„è¯­è¨€é‚£å€Ÿé‰´çš„.
</span><span class="c1"></span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="w">
</span><span class="w"></span><span class="p">};</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span>:<span class="kt">i32</span><span class="p">,</span><span class="n">b</span>:<span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="åŒ…ç®¡ç†">åŒ…ç®¡ç†</h2>
<p>rustå‘å±•å¤ªå¿«äº†,å„ç§æ–‡ç« å„è¯´å„è¯.è¿™é‡Œä¸»è¦æ˜¯ä¸€ä¸ª<code>crate</code>(ä¸€ä¸ªåŒ…)å†…çš„ç»“æ„.</p>
<p>rustä½¿ç”¨<code>mod</code>æ¥æ˜ç¡®çš„æ ‡æ³¨ä¸€ä¸ªæ¨¡å—.å…³é”®å­—é»˜è®¤ä¸ºç§æœ‰,ä½¿ç”¨<code>pub</code>æ¥æ ‡æ³¨ä¸€ä¸ªå¯¹å¤–å…¬å¼€çš„å…³é”®å­—.åœ¨2018æ ‡å‡†,ç›®å½•ä¹Ÿä¼šä½œä¸ºä¸€ä¸ªæ¨¡å—è·¯å¾„,æ–‡ä»¶åä½œä¸ºæ¨¡å—å,æ–‡ä»¶å†…å…³é”®å­—åŒæ ·é»˜è®¤ç§æœ‰.åœ¨è¿™ç§æƒ…å†µ,ä½¿ç”¨<code>mod</code>å…³é”®å­—æ¥æ˜¾å¼çš„å¼•å…¥æŸä¸ªæ¨¡å—.å¯¹äºç¬¬ä¸‰æ–¹æ¨¡å—,2018ä¸å†éœ€è¦æ˜¾å¼æ ‡æ³¨å¼•å…¥<code>extern crate</code>.(ä½†æ˜¯ä»ç„¶éœ€è¦<code>use</code>)</p>
<p>åœ¨ä¸€ä¸ªåŒ…é‡Œ,å…è®¸æœ‰å¤šä¸ªcrate.å¦‚æœç¡¬è¦è¯´,ç±»ä¼¼äºvs studioé‡Œçš„è§£å†³æ–¹æ¡ˆå’Œé¡¹ç›®ä¹‹é—´çš„å…³ç³».ä½†æ˜¯,rustè¿˜æœ‰ä¸€äº›ä¸é‚£ä¹ˆæ˜¾ç„¶çš„é™åˆ¶</p>
<ul>
<li>æœ€å¤šæœ‰ä¸€ä¸ªlib crate</li>
<li>å¯ä»¥æœ‰å¤šä¸ªbinary crate</li>
</ul>
<h2 id="ä¸€ä¸ªæœ€å°çš„httpæœåŠ¡å™¨">ä¸€ä¸ªæœ€å°(?)çš„HTTPæœåŠ¡å™¨</h2>
<p>å®ç°è¿™ä¸ªæœåŠ¡å™¨çš„è¿‡ç¨‹ä¸­,ä¼šé­é‡åˆ°å¾ˆå¤šRustå†…çš„é—®é¢˜.å‡è®¾æˆ‘ä»¬å·²ç»å¯¹æ¯”C++æŒæ¡å…¶åŸºæœ¬è¯­æ³•äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">thread</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">Arc</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">Mutex</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">ThreadPool</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">workers</span>:<span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Worker</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="n">sender</span>: <span class="nc">mpsc</span>::<span class="n">Sender</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">type</span> <span class="nc">Job</span><span class="o">=</span><span class="nb">Box</span><span class="o">&lt;</span><span class="n">dyn</span><span class="w"> </span><span class="nb">FnOnce</span><span class="p">()</span><span class="o">+</span><span class="nb">Send</span><span class="o">+</span><span class="nb">&#39;static</span><span class="o">&gt;</span><span class="p">;</span><span class="c1">//?
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">enum</span> <span class="nc">Message</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">NewJob</span><span class="p">(</span><span class="n">Job</span><span class="p">),</span><span class="w">
</span><span class="w">    </span><span class="n">Terminate</span><span class="p">,</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">ThreadPool</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="sd">/// Create thread pool
</span><span class="sd"></span><span class="w">    </span><span class="sd">/// 
</span><span class="sd"></span><span class="w">    </span><span class="sd">/// The number of threads in pool
</span><span class="sd"></span><span class="w">    </span><span class="sd">/// 
</span><span class="sd"></span><span class="w">    </span><span class="sd">/// # Paincs
</span><span class="sd"></span><span class="w">    </span><span class="sd">/// 
</span><span class="sd"></span><span class="w">    </span><span class="sd">/// `new` will panic when size is not great than 0.
</span><span class="sd"></span><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">size</span>:<span class="kt">usize</span><span class="p">)</span>-&gt;<span class="nc">ThreadPool</span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">assert</span><span class="o">!</span><span class="p">(</span><span class="n">size</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">sender</span><span class="p">,</span><span class="n">receiver</span><span class="p">)</span><span class="o">=</span><span class="n">mpsc</span>::<span class="n">channel</span><span class="p">();</span><span class="w">
</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">receiver</span><span class="o">=</span><span class="n">Arc</span>::<span class="n">new</span><span class="p">(</span><span class="n">Mutex</span>::<span class="n">new</span><span class="p">(</span><span class="n">receiver</span><span class="p">));</span><span class="w">
</span><span class="w">
</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">workers</span><span class="o">=</span><span class="nb">Vec</span>::<span class="n">with_capacity</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w">
</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="p">..</span><span class="n">size</span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">workers</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Worker</span>::<span class="n">new</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">receiver</span><span class="p">.</span><span class="n">clone</span><span class="p">()));</span><span class="w">
</span><span class="w">        </span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w">        </span><span class="n">ThreadPool</span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">workers</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">sender</span><span class="w">
</span><span class="w">        </span><span class="p">}</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">execute</span><span class="o">&lt;</span><span class="n">F</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span>:<span class="nc">F</span><span class="p">)</span><span class="w">
</span><span class="w">        </span><span class="k">where</span><span class="w"> </span><span class="n">F</span>:<span class="nb">FnOnce</span><span class="p">()</span><span class="o">+</span><span class="nb">Send</span><span class="o">+</span><span class="nb">&#39;static</span><span class="w">
</span><span class="w">    </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">job</span><span class="o">=</span><span class="nb">Box</span>::<span class="n">new</span><span class="p">(</span><span class="n">f</span><span class="p">);</span><span class="w">
</span><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">sender</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">Message</span>::<span class="n">NewJob</span><span class="p">(</span><span class="n">job</span><span class="p">)).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="nb">Drop</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ThreadPool</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="k">fn</span> <span class="nf">drop</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">){</span><span class="w">
</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">workers</span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">sender</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">Message</span>::<span class="n">Terminate</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">        </span><span class="p">}</span><span class="w">
</span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">workers</span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;shutting down worker {}&#34;</span><span class="p">,</span><span class="n">worker</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">thread</span><span class="p">)</span><span class="o">=</span><span class="n">worker</span><span class="p">.</span><span class="n">thread</span><span class="p">.</span><span class="n">take</span><span class="p">(){</span><span class="w">
</span><span class="w">                </span><span class="n">thread</span><span class="p">.</span><span class="n">join</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">            </span><span class="p">}</span><span class="w">
</span><span class="w">        </span><span class="p">}</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">struct</span> <span class="nc">Worker</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">id</span>: <span class="kt">usize</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="n">thread</span>: <span class="nb">Option</span><span class="o">&lt;</span><span class="n">thread</span>::<span class="n">JoinHandle</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Worker</span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">id</span>:<span class="kt">usize</span><span class="p">,</span><span class="n">receiver</span>: <span class="nc">Arc</span><span class="o">&lt;</span><span class="n">Mutex</span><span class="o">&lt;</span><span class="n">mpsc</span>::<span class="n">Receiver</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;&gt;&gt;</span><span class="p">)</span>-&gt;<span class="nc">Worker</span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">thread</span><span class="o">=</span><span class="n">thread</span>::<span class="n">spawn</span><span class="p">(</span><span class="k">move</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="k">loop</span><span class="p">{</span><span class="w">
</span><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">message</span><span class="o">=</span><span class="n">receiver</span><span class="p">.</span><span class="n">lock</span><span class="p">().</span><span class="n">unwrap</span><span class="p">().</span><span class="n">recv</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">
</span><span class="w">                </span><span class="k">match</span><span class="w"> </span><span class="n">message</span><span class="p">{</span><span class="w">
</span><span class="w">                    </span><span class="n">Message</span>::<span class="n">NewJob</span><span class="p">(</span><span class="n">job</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span><span class="w">
</span><span class="w">                        </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;Worker {} got job.&#34;</span><span class="p">,</span><span class="n">id</span><span class="w"> </span><span class="p">);</span><span class="w">
</span><span class="w">                        </span><span class="n">job</span><span class="p">();</span><span class="w">
</span><span class="w">                    </span><span class="p">},</span><span class="w">
</span><span class="w">                    </span><span class="n">Message</span>::<span class="n">Terminate</span><span class="o">=&gt;</span><span class="p">{</span><span class="w">
</span><span class="w">                        </span><span class="n">println</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;Worker {} is terminating.&#34;</span><span class="p">,</span><span class="n">id</span><span class="p">);</span><span class="w">
</span><span class="w">                        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span><span class="w">                    </span><span class="p">}</span><span class="w">
</span><span class="w">                </span><span class="p">}</span><span class="w">
</span><span class="w">                
</span><span class="w">            </span><span class="p">}</span><span class="w">
</span><span class="w">        </span><span class="p">});</span><span class="w">
</span><span class="w">
</span><span class="w">        </span><span class="n">Worker</span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">id</span><span class="p">,</span><span class="w">
</span><span class="w">            </span><span class="n">thread</span>: <span class="nb">Some</span><span class="p">(</span><span class="n">thread</span><span class="p">),</span><span class="w">
</span><span class="w">        </span><span class="p">}</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">prelude</span>::<span class="o">*</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">net</span>::<span class="p">{</span><span class="n">TcpListener</span><span class="p">,</span><span class="n">TcpStream</span><span class="p">};</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">fs</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">time</span>::<span class="n">Duration</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">thread</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">automan</span>::<span class="n">ThreadPool</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">listener</span><span class="o">=</span><span class="n">TcpListener</span>::<span class="n">bind</span><span class="p">(</span><span class="s">&#34;127.0.0.1:7878&#34;</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">pool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ThreadPool</span>::<span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">listener</span><span class="p">.</span><span class="n">incoming</span><span class="p">(){</span><span class="w">
</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">.</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">
</span><span class="w">        </span><span class="n">pool</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">            </span><span class="n">handler</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span><span class="w">
</span><span class="w">        </span><span class="p">});</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">handler</span><span class="p">(</span><span class="k">mut</span><span class="w"> </span><span class="n">stream</span>: <span class="nc">TcpStream</span><span class="p">){</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="mi">512</span><span class="p">];</span><span class="w">
</span><span class="w">    </span><span class="n">stream</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">buffer</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">b&#34;GET / HTTP/1.1</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">;</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sleep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">b&#34;GET /sleep HTTP/1.1</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">status_line</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="n">starts_with</span><span class="p">(</span><span class="n">get</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="p">(</span><span class="s">&#34;HTTP/1.1 200 OK\r\n\r\n&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;hello.html&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">buffer</span><span class="p">.</span><span class="n">starts_with</span><span class="p">(</span><span class="n">sleep</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">thread</span>::<span class="n">sleep</span><span class="p">(</span><span class="n">Duration</span>::<span class="n">from_secs</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span><span class="w">
</span><span class="w">        </span><span class="p">(</span><span class="s">&#34;HTTP/1.1 200 OK\r\n\r\n&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;hello.html&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="p">(</span><span class="s">&#34;HTTP/1.1 404 NOT FOUND\r\n\r\n&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;404.html&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">    </span><span class="p">};</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fs</span>::<span class="n">read_to_string</span><span class="p">(</span><span class="n">filename</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;{}{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">status_line</span><span class="p">,</span><span class="w"> </span><span class="n">contents</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="n">stream</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">as_bytes</span><span class="p">()).</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w">    </span><span class="n">stream</span><span class="p">.</span><span class="n">flush</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="fnonce">FnOnce</h2>
<p>åœ¨C++é‡Œ,æˆ‘ä»¬èƒ½å¤Ÿç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºé—­åŒ…,å½“éœ€è¦ä¿å­˜ä¸€ä¸ªé—­åŒ…æ—¶,æ ‡å‡†åº“æä¾›äº†å«<code>function</code>çš„ä¸œè¥¿.åœ¨Rusté‡Œ,æˆ‘ä»¬ä¹Ÿæœ‰é—­åŒ…,è€Œæè¿°ä¸€ä¸ªé—­åŒ…ç±»å‹çš„ç©æ„,å°±æ˜¯<code>Fn***</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">type</span> <span class="nc">Job</span><span class="o">=</span><span class="nb">Box</span><span class="o">&lt;</span><span class="n">dyn</span><span class="w"> </span><span class="nb">FnOnce</span><span class="p">()</span><span class="o">+</span><span class="nb">Send</span><span class="o">+&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="k">static</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>å¾—ç›Šäºrustçš„å†…å­˜æ¨¡å‹,è¯ç”Ÿå‡ºè¿™ä¸ªå¥‡è‘©ç©æ„.åæ­£è¿˜æ˜¯å’Œå˜é‡çš„æ‰€æœ‰æƒæœ‰å…³ç³».<code>FnOnce</code>çš„é—­åŒ…ä¼šè·å–å…¶æ•è·å˜é‡çš„æ‰€æœ‰æƒ.å¦å¤–<code>FnMut</code>çš„é—­åŒ…è·å¾—å…¶æ•è·å˜é‡çš„å¯å˜å€Ÿç”¨,<code>Fn</code>è·å¾—ä¸å¯å˜å€Ÿç”¨.å‹‰å¼ºå¯ä»¥å¯¹æ¯”C++é‡Œçš„<code>[],[&amp;]</code>.</p>
<p>è‡³äºåˆ°åº•ä»€ä¹ˆé—­åŒ…ä¼šå®ç°å“ªä¸€ä¸ª,æ˜¯ç”±ç¼–è¯‘å™¨æ ¹æ®å®é™…æƒ…å†µåˆ¤æ–­çš„.æƒ³è¦å¼ºåˆ¶å°†å˜é‡æŒªè¿›é—­åŒ…æ—¶,å¯ä»¥å‰ç¼€<code>move</code>,å°±åƒ<code>Worker</code>çš„<code>run</code>é‡Œçš„ä»£ç ä¸€æ ·.å› ä¸ºå½“<code>run</code>æ‰§è¡Œå®Œ,receiverå°†ä¼šè¢«ä¸¢å¼ƒ,ä»è€Œå½±å“åˆ°é—­åŒ…é‡Œçš„å¼•ç”¨.</p>
<p>å…¶ä»–çš„å‡ ä¸ª<code>+</code>å·å’Œ<code>Send</code>,<code>'static</code>ä»€ä¹ˆçš„.<code>+</code>å°±æ˜¯<code>+</code>,è¦æ±‚è¯¥ç±»å‹å¿…é¡»åŒæ—¶å®ç°è¿™ä¸‰ç§<code>trait</code>.Sendæ˜¯ä¸ª<code>trait</code>(Types that can be transferred across thread boundaries).<code>'static</code>ç­‰æ—¶é—´å‘¨æœŸå®é™…ä¸Šä¹Ÿæ˜¯<code>trait</code>.</p>
<h2 id="boxå’Œdyn">Boxå’Œdyn</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">type</span> <span class="nc">Job</span><span class="o">=</span><span class="nb">Box</span><span class="o">&lt;</span><span class="n">dyn</span><span class="w"> </span><span class="nb">FnOnce</span><span class="p">()</span><span class="o">+</span><span class="nb">Send</span><span class="o">+&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="k">static</span><span class="o">&gt;</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>......æ²¡å®Œ..å‰é¢é‚£ä¸ª<code>dyn</code>ç©æ„ä¹Ÿæ˜¯æŒºå¥‡æ€ª,éœ€è¦å’Œ<code>impl</code>å…³é”®å­—å¯¹æ¯”ç†è§£.</p>
<p>Rustçš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯é›¶ä»£ä»·æŠ½è±¡.ä¾‹å¦‚å¯¹äºæ³›å‹,ä¸€ç§å®ç°0æŠ½è±¡çš„æ–¹æ³•å°±æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå•ä¾‹åŒ–.C++ä¹Ÿæ˜¯å¦‚æ­¤å¤„ç†.</p>
<p>ä¸è¿‡æœ‰ä¸€ç§æƒ…å†µç›®æµ‹C++æ— æ³•å®ç°é›¶æŠ½è±¡:åœ¨C++ä¸­,å¦‚æœå­˜åœ¨çˆ¶ç±»<code>A</code>æœ‰è™šæ–¹æ³•<code>f</code>,è€Œå­ç±»<code>B</code>é‡å†™äº†<code>f</code>,åˆæœ‰ä¸€ä¸ªå‡½æ•°<code>g(A a)</code>ä¼šè°ƒç”¨<code>f</code>.å½“æŠŠ<code>B</code>ä½œä¸ºå‚æ•°ä¼ ç»™<code>g</code>æ—¶,C++é€šè¿‡ä¸€ç§å«<code>è™šå‡½æ•°è¡¨</code>çš„æ–¹å¼å®ç°è°ƒç”¨<code>B</code>å†™çš„<code>f</code>.è¿™ç§è¡Œä¸ºæ˜¯å‘ç”Ÿåœ¨è¿è¡Œæ—¶çš„.</p>
<p>å¯¹äºRustæ¥è®²,è™½ç„¶æ²¡æœ‰ç±»ä¸ç»§æ‰¿,è¿™ç§æ“ä½œå®é™…ç­‰ä»·äº<code>trait</code>.ä¸Šé¢çš„æƒ…å†µå¯¹ç­‰äºå­˜åœ¨<code>trait A</code>,å®ƒå®šä¹‰äº†ä¸€ä¸ª<code>f</code>,<code>B</code>å®ç°äº†<code>A</code>,<code>g</code>åŒä¸Š.Rust<strong>èƒ½å¤Ÿåœ¨ç¼–è¯‘é˜¶æ®µ</strong>å°±ç¡®å®šä¼ ç»™<code>g</code>çš„æ˜¯è°,å¹¶ä¸”ä¼˜åŒ–æ‰å®ƒ.ä¸è¿‡è¿™ç§ä¼˜åŒ–ä¹Ÿæ˜¯æœ‰é™åº¦çš„.å¦‚æœæŠŠä¸€å †å®ç°<code>A</code>çš„ç»“æ„çš„æŒ‡é’ˆå­˜åˆ°æ•°ç»„æˆ–è€…å…¶ä»–å†…å­˜ç»“æ„é‡Œ,é‚£Rustä¹Ÿæ˜¯æ— èƒ½ä¸ºåŠ›çš„,åªèƒ½åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†å‘.</p>
<p>å†å›æ¥çœ‹<code>impl</code>å’Œ<code>dyn</code>.å®ƒä»¬åˆ†åˆ«å¯¹åº”äº†èƒ½å¤Ÿä¼˜åŒ–(é™æ€åˆ†å‘)å’ŒåŠ¨æ€åˆ†å‘çš„æƒ…æ™¯.</p>
<p>å¦å¤–,é‡‡ç”¨åŠ¨æ€åˆ†å‘çš„ç»“æ„ä¹Ÿä¸èƒ½åœ¨ç¼–è¯‘æ—¶ç¡®å®šå¤§å°,æ‰€ä»¥å¿…é¡»å¤–åŒ…<code>Box</code>.è¿™ä¸€ç‚¹è¿˜æ˜¯æœ‰ç‚¹ç‰¹æ®Šçš„,C++ä¼¼ä¹å¹¶ä¸ä¼šæŠ±æ€¨è¿™ä¸ªé—®é¢˜.</p>
<h2 id="arcå’Œmutex">Arcå’ŒMutex</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="n">id</span>:<span class="kt">usize</span><span class="p">,</span><span class="n">receiver</span>: <span class="nc">Arc</span><span class="o">&lt;</span><span class="n">Mutex</span><span class="o">&lt;</span><span class="n">mpsc</span>::<span class="n">Receiver</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;&gt;&gt;</span><span class="p">)</span>-&gt;<span class="nc">Worker</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>è¯´çœŸçš„,çœ‹åˆ°<code>Worker</code>çš„è¿™ä¸ªå‡½æ•°ç­¾å,å½“æ—¶å°±åƒå.Rustè¿™ç©æ„,åŠ¨ä¸åŠ¨å°±ä¼šåµŒå¥—ä¸Šå¥½å‡ å±‚çš„<code>&lt;&gt;</code>.</p>
<p>é¦–å…ˆå…³äº<code>Arc</code>...å…ˆ<code>Rc</code>.ä¸€èˆ¬æƒ…å†µä¸‹,ä¸€ä¸ªå˜é‡çš„æ‰€æœ‰æƒæ˜¯å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå°±ç¡®å®šä¸‹æ¥çš„.ä½†æ˜¯æ€»ä¼šæœ‰ä¸å¦‚æ„çš„æ—¶å€™,å½“æœ‰å¤šä¸ªç»“æ„åŒæ—¶äº«æœ‰æŸä¸ªå˜é‡çš„æ‰€æœ‰æƒ(ä¾‹å¦‚ä¸€æ£µæ ‘),å°±ä¸å¤ªå¥½ç¡®å®šå…¶å®é™…çš„é”€æ¯æ—¶æœº,è€Œä¸”Rustä¹Ÿä¸ä¼šç»™ä½ æœºä¼šå…±äº«æ‰€æœ‰æƒ.<code>Rc</code>æ˜¯ä¸€ä¸ªå¼•ç”¨è®¡æ•°æŒ‡é’ˆ,å˜é‡æ‰€æœ‰æƒç”±å®ƒä¿ç®¡,è€Œå®ƒèƒ½å¤Ÿæä¾›å¤šä»½åªè¯»å€Ÿç”¨.</p>
<p>ç„¶è€Œ<code>Rc</code>çº¿ç¨‹ä¸å®‰å…¨,<code>Arc</code>çº¿ç¨‹å®‰å…¨.ä¸è¿‡<code>Arc</code>æ€§èƒ½å¼±äº<code>Rc</code>.</p>
<p>å…¶æ¬¡æ˜¯<code>Mutex</code>...å°±æ˜¯ä¸ªé”...</p>
<p>è‡³äºä¸ºå•¥ç”¨é”,å…ˆçœ‹<code>mpsc</code>,Multi-producer, single-consumer FIFO queue communication primitives.</p>
<p>ä¸€å¤´é›¾æ°´çš„ç¼©å†™...ç®€è€Œè¨€ä¹‹,è¿™ä¸ªä¸œè¥¿çš„è®¾å®šç±»ä¼¼äºgoé‡Œ<code>channel</code>,åŒæ—¶æ˜¯å¤šç”Ÿäº§è€…,<strong>å•æ¶ˆè´¹è€…</strong>æ¨¡å¼.æœ¬èº«ä½¿ç”¨æ²¡ä»€ä¹ˆç»•çš„åœ°æ–¹.ç»•çš„åœ°æ–¹åœ¨äºå¤šçº¿ç¨‹å…±äº«å’Œå•æ¶ˆè´¹è€…æ¨¡å¼çš„å†²çª,æ‰€ä»¥å¼•å…¥äº†é”,ä¿è¯åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿæ¶ˆè´¹æ¶ˆæ¯.</p>
<p>é¡ºä¾¿åæ§½ä¸€å¥è¿™ä»£ç å†™çš„...</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rust" data-lang="rust"><span class="kd">let</span><span class="w"> </span><span class="n">message</span><span class="o">=</span><span class="n">receiver</span><span class="p">.</span><span class="n">lock</span><span class="p">().</span><span class="n">unwrap</span><span class="p">().</span><span class="n">recv</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>å…¶å®æ¶‰åŠåˆ°<code>Rc</code>æ—¶,è¿˜æœ‰å¦å¤–ä¸€ä¸ªå¤–éƒ¨å¯å˜,å†…éƒ¨å¯å˜çš„éº»çƒ¦äº‹.è¿™é‡Œæ²¡æœ‰æåˆ°.</p>
<h2 id="è¿˜æœ‰">è¿˜æœ‰</h2>
<p><code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>,<code>unwrap</code>...</p>
<p>å½“ç„¶å®ƒä»¬æœ¬æ¥ä¼šè¢«æ›¿ä»£æˆæ›´å¤æ‚çš„é”™è¯¯å¤„ç†.</p>
<h2 id="å°ç»“">å°ç»“</h2>
<p>ç”¨Rustå†™çš„ç¨‹åº,å’Œè‡ªå·±è„‘è¢‹æ–—æ™ºæ–—å‹‡å‡ å›åˆ,å†å’Œç¼–è¯‘å™¨æ–—æ™ºæ–—å‹‡(å•æ–¹é¢æŒ¨æ)å‡ ç™¾å›åˆ,æœ€åæ˜¯çœŸçš„éš¾ä»¥å‡ºç°bug,æ¯•ç«Ÿä¸€åˆ‡éƒ½è¢«ç®¡çš„æ­»æ­»çš„.æˆ‘è¿˜çœ‹åˆ°Rusté‡Œä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ç©æ„å«é”™è¯¯é©±åŠ¨,è¯´æ˜¯å…ˆæŠŠä»£ç å¤§æ¦‚æ¨¡æ ·çç³Šä¸Š,ç„¶åè®©ç¼–è¯‘å™¨checkä¸€é,å†ä¸€æ­¥æ­¥æ”¹æ‰ç¼–è¯‘å™¨çš„æŠ¥é”™<del>é¡ºä¾¿å†™ä»£ç </del>,æœ€åå°±èƒ½åœ¨ç¼–è¯‘å™¨çš„åæ§½ä¸‹å®Œç¾å®ç°ç¨‹åº,å†åŠ ç‚¹æµ‹è¯•å°±é½å…¨äº†...</p>
<p>è™½ç„¶æ•´ä¸ªè¯­æ³•çœ‹èµ·æ¥å¤æ‚å•°å—¦,ä¸è¿‡æ— æ³•å¦è®¤è¿™äº›è¯­å¥å¯¹äºå·¥ç¨‹æ¥è®²å®é™…ä¸Šéƒ½æ˜¯å¿…è¦çš„.æ‰€ä»¥è¿™ç©æ„çš„æ°”è´¨å†³å®šå®ƒä¸å¤ªé€‚åˆä½œä¸ºæ‰“æ¯”èµ›æ—¶ç”¨çš„è¯­è¨€.ç¿»äº†ç¿»CFå¥½å‡ åœºæ¯”èµ›,é›¶æ˜Ÿæœ‰å‡ ä¸ªRustçš„ä»£ç ä¹Ÿéƒ½æ²¡æœ‰æ¶‰åŠä»»ä½•æ•°æ®ç»“æ„,æœ¬æ¥è¿˜æƒ³ç»ä»°ä¸€ä¸‹ä»–ä»¬ä¼šæ€ä¹ˆå¤„ç†ç”Ÿå‘½å‘¨æœŸä¸€ç±»çš„é—®é¢˜.</p>
<p>å¦‚æœæœ‰æœºä¼š,æ‹¿Rustå†™è¯¾è®¾åº”è¯¥å¯ä»¥ç©ä¸€ç©(å¤§æ¦‚ä¼šè¢«å¼ºè¡Œç”¨Cç³»è¯­è¨€).è‡³äºåŸæœ¬æƒ³æ‹¿Rustå†™ä¸ªæœ¬åœ°è¯„æµ‹å™¨,è¿˜æ˜¯ç®—äº†,æœ‰ç©ºå†è¯´å§.</p>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Codeforces Round #612 (Div. 2)</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/codeforces-round-612-div-2/" />
            <id>https://blog.kanari.moe/code/codeforces-round-612-div-2/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-01-14T14:12:13+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[C æ— è„‘DP.è®¾çŠ¶æ€$f(i,j,0/1)$è¡¨ç¤ºå·²ç»è®¾ç½®äº†$i$ä½,ç”¨äº†$j$ä¸ªå¶æ•°,â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="c">C</h2>
<p>æ— è„‘DP.è®¾çŠ¶æ€$f(i,j,0/1)$è¡¨ç¤ºå·²ç»è®¾ç½®äº†$i$ä½,ç”¨äº†$j$ä¸ªå¶æ•°,ç¬¬$i$ä½æ˜¯å¶æ•°/å¥‡æ•°.ç„¶å</p>
<div>$$
\begin{aligned}
f(i,j,0)&=\min\{f(i-1,j-1,0),f(i-1,j-1,1)+1\} \\
f(i,j,1)&=\min\{f(i-1,j,0)+1,f(i-1,j,1)\}
\end{aligned}
$$</div>
<p>ä»¥$i=1$ä½œä¸ºå¼€å§‹,å› ä¸ºç¬¬1ä½ä¸èƒ½ç®—ä»£ä»·.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="c1">// missing?
</span></code></pre></td></tr></table>
</div>
</div><h2 id="d">D</h2>
<p>ä¸€ä¸ªäº‹å®æ˜¯,ä¸¤æ£µå­ğŸŒ³çš„é—´å¤§å°å…³ç³»ä¸ä¼šå½±å“å…¶å†…éƒ¨èŠ‚ç‚¹çš„æ—¢å®šå…³ç³».</p>
<p>ä»¥æ­¤,ç›´æ¥dfs,ä»åº•å±‚å‘ä¸Šæ„é€ ç›¸å¯¹å¤§å°é¡ºåº.åˆå¹¶æ—¶å­æ ‘é—´çš„ç›¸å¯¹å¤§å°æ²¡æœ‰å½±å“,æ‰€ä»¥ç›´æ¥å‰åæ¥åœ¨ä¸€èµ·å°±å¥½,å†æŠŠå½“å‰èŠ‚ç‚¹æ’åˆ°åˆé€‚çš„ä½ç½®ä½¿å…¶æ»¡è¶³cçš„æ¡ä»¶.
å…¨éƒ¨å®Œæˆåå†å¯¹èŠ‚ç‚¹ç»Ÿä¸€æ ‡å·.</p>
<p>æœ€å¼€å§‹å…ˆæ ‡äº†å·,ç„¶åè¶Šå†™è¶Šéº»çƒ¦,ç”Ÿæ°”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">2010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXV</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span><span class="n">MAXE</span><span class="o">=</span><span class="mi">4020</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">tick</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 
<span class="k">struct</span> <span class="nc">Edge</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">v</span><span class="p">,</span><span class="n">n</span><span class="p">;</span>
<span class="p">}</span><span class="n">edges</span><span class="p">[</span><span class="n">MAXE</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">sz</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">adde</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">v</span><span class="p">){</span>
    <span class="n">edges</span><span class="p">[</span><span class="o">++</span><span class="n">idx</span><span class="p">].</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">;</span>
    <span class="n">edges</span><span class="p">[</span><span class="n">idx</span><span class="p">].</span><span class="n">n</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
    <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">idx</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">name</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">cur</span><span class="p">[</span><span class="n">MAXV</span><span class="p">][</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">dfs0</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>
    <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ei</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">ei</span><span class="p">;</span><span class="n">ei</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">].</span><span class="n">n</span><span class="p">){</span>
        <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">e</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+=</span><span class="n">dfs0</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">name</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="n">tick</span><span class="p">;</span>
        <span class="n">cur</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">tick</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">tick</span><span class="o">+=</span><span class="mi">2000</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">sz</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">target</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">ok</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ei</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">ei</span><span class="p">;</span><span class="n">ei</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">].</span><span class="n">n</span><span class="p">){</span>
        <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">e</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">ei</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">cur</span><span class="o">=</span><span class="n">dfs</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="n">it</span><span class="o">=</span><span class="n">cur</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span><span class="n">it</span><span class="o">!=</span><span class="n">cur</span><span class="p">.</span><span class="n">end</span><span class="p">();</span><span class="n">it</span><span class="o">++</span><span class="p">){</span>
            <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">&gt;</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="n">ok</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">else</span> <span class="n">res</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="n">target</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">u</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">vlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">vlen</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">root</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">vlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">fa</span><span class="p">;</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">fa</span><span class="o">&gt;&gt;</span><span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fa</span><span class="o">!=</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">adde</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="n">root</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
 
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">res</span><span class="o">=</span><span class="n">dfs</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ok</span><span class="p">){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;YES&#34;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">name</span><span class="p">[</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">vlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;NO&#34;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">CF1285D Dr.Evil Underscores</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf1285d-dr-evil-underscores/" />
            <id>https://blog.kanari.moe/code/cf1285d-dr-evil-underscores/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2020-01-13T17:27:25+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>Today, as a friendship gift, Bakry gave Badawy n integers a1,a2,â€¦,an and challenged him to choose an integer X such that the value max1â‰¤iâ‰¤n(aiâŠ•X) is minimum possible, where âŠ• denotes the bitwise XOR operation.</p>
<p>As always, Badawy is too lazy, so you decided to help him and find the minimum possible value of max1â‰¤iâ‰¤n(aiâŠ•X).</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Today, as a friendship gift, Bakry gave Badawy n integers a1,a2,â€¦,an and challenged him to choose an integer X such that the value max1â‰¤iâ‰¤n(aiâŠ•X) is minimum possible, where âŠ• denotes the bitwise XOR operation.</p>
<p>As always, Badawy is too lazy, so you decided to help him and find the minimum possible value of max1â‰¤iâ‰¤n(aiâŠ•X).</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å°†è¾“å…¥æŒ‰ç…§äºŒè¿›åˆ¶ä½ä»é«˜ä½å¼€å§‹å»ºæ ‘,å°±èƒ½çœ‹å‡ºæ¥,ä¸€æ—¦ç¡®å®šäº†é«˜ä½$i$å¡«1è¿˜æ˜¯0å,åªä¼šæœ‰ä¸€æ£µå­æ ‘å½±å“ç­”æ¡ˆ.å¦ä¸€æ£µå­æ ‘çš„æ‰€æœ‰æ•°å­—éƒ½å› ä¸º$i$ä½ä¸Šçš„å¼‚æˆ–ç»“æœä¸º0è€Œå®šå°äºå¦ä¸€ä¸ªå­æ ‘.</p>
<p>æ ‘ä¸ç”¨çœŸçš„å»ºå‡ºæ¥,è¿™æ ·å°±å¯ä»¥åšäº†.</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;limits&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">LMAX</span><span class="o">=</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">();</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>
 
<span class="c1">//int nlen;
</span><span class="c1">//int num[MAXN];
</span><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">num</span><span class="p">;</span>
 
<span class="kt">int</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">ptr</span><span class="p">,</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">vec</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">one</span><span class="p">,</span><span class="n">zero</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">i</span><span class="p">:</span><span class="n">vec</span><span class="p">){</span>
        <span class="k">if</span><span class="p">((</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="n">ptr</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">one</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">else</span> <span class="n">zero</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="cm">/*
</span><span class="cm">    cout&lt;&lt;&#34;====vec====&#34;&lt;&lt;endl;
</span><span class="cm">    for(auto i:one)cout&lt;&lt;i&lt;&lt;&#34;,&#34;;
</span><span class="cm">    cout&lt;&lt;endl;
</span><span class="cm">    for(auto i:zero)cout&lt;&lt;i&lt;&lt;&#34;,&#34;;
</span><span class="cm">    cout&lt;&lt;endl;
</span><span class="cm">    cout&lt;&lt;&#34;===========&#34;&lt;&lt;endl;
</span><span class="cm">    */</span>
    <span class="k">if</span><span class="p">(</span><span class="n">one</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">zero</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">zero</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">one</span><span class="p">);</span>
    <span class="c1">//cout&lt;&lt;&#34;add&#34;&lt;&lt;(1&lt;&lt;ptr)&lt;&lt;endl;
</span><span class="c1"></span> 
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">ptr</span><span class="p">)</span><span class="o">+</span><span class="n">min</span><span class="p">(</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">zero</span><span class="p">),</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">one</span><span class="p">));</span>
<span class="p">}</span>
 
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
 
    <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">x</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="p">;</span>
        <span class="n">num</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
 
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">dfs</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">num</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">åº·åº·æ–°æ•™åŠ¡</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/look-new-jw/" />
            <id>https://blog.kanari.moe/gossip/look-new-jw/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-12-27T09:08:05+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>å­¦æ ¡æ¢æ•™åŠ¡äº†?çªå¦‚å…¶æ¥çš„æƒŠå–œ,ç»“æœç¬¬ä¸€å¤©æ•™åŠ¡å‡ºäº†ä¸ªé”….</p>
<p>æ‰’æ‰’ä»£ç çœ‹çœ‹å¼€å‘è¿™ä¸ªæ•™åŠ¡çš„å…¬å¸æ°´å¹³,å½»åº•å¤±æœ›.</p>
<p>è¿™ä¸ªæ•™åŠ¡ç³»ç»Ÿçš„é—®é¢˜è¿œä¸æ­¢æ—¶åŒº,æœ€å¤§çš„é—®é¢˜æ˜¯å®ƒè¡¨é¢ä¸Šç›¸æ¯”å…ˆå‰çš„ç³»ç»Ÿ...ä¼¼ä¹...æ²¡å•¥...é•¿è¿›?</p>
<h2 id="é¦–é¡µ">é¦–é¡µ</h2>
<h3 id="ç¼–ç æ–¹å¼">ç¼–ç æ–¹å¼</h3>
<p>é¦–å…ˆ,æ¥çœ‹è¿™æ•™åŠ¡å¦‚ä½•å¤„ç†ç™»å½•ä¿¡æ¯.</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>å­¦æ ¡æ¢æ•™åŠ¡äº†?çªå¦‚å…¶æ¥çš„æƒŠå–œ,ç»“æœç¬¬ä¸€å¤©æ•™åŠ¡å‡ºäº†ä¸ªé”….</p>
<p>æ‰’æ‰’ä»£ç çœ‹çœ‹å¼€å‘è¿™ä¸ªæ•™åŠ¡çš„å…¬å¸æ°´å¹³,å½»åº•å¤±æœ›.</p>
<p>è¿™ä¸ªæ•™åŠ¡ç³»ç»Ÿçš„é—®é¢˜è¿œä¸æ­¢æ—¶åŒº,æœ€å¤§çš„é—®é¢˜æ˜¯å®ƒè¡¨é¢ä¸Šç›¸æ¯”å…ˆå‰çš„ç³»ç»Ÿ...ä¼¼ä¹...æ²¡å•¥...é•¿è¿›?</p>
<h2 id="é¦–é¡µ">é¦–é¡µ</h2>
<h3 id="ç¼–ç æ–¹å¼">ç¼–ç æ–¹å¼</h3>
<p>é¦–å…ˆ,æ¥çœ‹è¿™æ•™åŠ¡å¦‚ä½•å¤„ç†ç™»å½•ä¿¡æ¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">submitForm1</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">xh</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;userAccount&#34;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">pwd</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;userPassword&#34;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xh</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;ç”¨æˆ·åä¸èƒ½ä¸ºç©ºï¼&#34;</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">pwd</span> <span class="o">==</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;å¯†ç ä¸èƒ½ä¸ºç©ºï¼&#34;</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">account</span> <span class="o">=</span> <span class="nx">encodeInp</span><span class="p">(</span><span class="nx">xh</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">passwd</span> <span class="o">=</span> <span class="nx">encodeInp</span><span class="p">(</span><span class="nx">pwd</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">encoded</span> <span class="o">=</span> <span class="nx">account</span> <span class="o">+</span> <span class="s2">&#34;%%%&#34;</span> <span class="o">+</span> <span class="nx">passwd</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;encoded&#34;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">encoded</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">jzmmid</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;Form1&#34;</span><span class="p">).</span><span class="nx">jzmmid</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;userPassword&#34;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç ç”¨äº†ä¸€ç§éå¸¸è§„çš„ç™»å½•æ–¹å¼.å°†è´¦å·å’Œå¯†ç ç¼–ç åç”¨<code>%%%</code>è¿æ¥,ä½œä¸ºçœŸæ­£çš„ç™»å½•è¯·æ±‚å‘åˆ°æœåŠ¡å™¨</p>
<p>%%%(???)æ¥çœ‹çœ‹è¿™<code>encodeInp</code>æ˜¯å•¥ç©æ„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nb">eval</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span><span class="nx">a</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">d</span><span class="p">){</span><span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span><span class="k">return</span><span class="p">(</span><span class="nx">c</span><span class="o">&lt;</span><span class="nx">a</span><span class="o">?</span><span class="s2">&#34;&#34;</span><span class="o">:</span><span class="nx">e</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">c</span><span class="o">/</span><span class="nx">a</span><span class="p">)))</span><span class="o">+</span><span class="p">((</span><span class="nx">c</span><span class="o">=</span><span class="nx">c</span><span class="o">%</span><span class="nx">a</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">35</span><span class="o">?</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">c</span><span class="o">+</span><span class="mi">29</span><span class="p">)</span><span class="o">:</span><span class="nx">c</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">36</span><span class="p">))};</span><span class="k">if</span><span class="p">(</span><span class="o">!&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^/</span><span class="p">,</span><span class="nb">String</span><span class="p">)){</span><span class="k">while</span><span class="p">(</span><span class="nx">c</span><span class="o">--</span><span class="p">)</span><span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">)]</span><span class="o">=</span><span class="nx">k</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span><span class="o">||</span><span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span><span class="nx">k</span><span class="o">=</span><span class="p">[</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span><span class="p">[</span><span class="nx">e</span><span class="p">]}];</span><span class="nx">e</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">return</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="err">\\</span><span class="nx">w</span><span class="o">+&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;};</span><span class="nx">c</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span><span class="k">while</span><span class="p">(</span><span class="nx">c</span><span class="o">--</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span><span class="nx">p</span><span class="o">=</span><span class="nx">p</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="err">\\</span><span class="nx">b</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="o">+</span><span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">+&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="err">\\</span><span class="nx">b</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;,</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="nx">g</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;),</span><span class="nx">k</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span><span class="k">return</span> <span class="nx">p</span><span class="p">;}(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="nx">b</span> <span class="mi">9</span><span class="o">=</span><span class="s2">&#34;o+/=&#34;</span><span class="p">;</span><span class="nx">p</span> <span class="nx">q</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="nx">b</span> <span class="nx">e</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span><span class="nx">b</span> <span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span><span class="nx">b</span> <span class="nx">f</span><span class="p">,</span><span class="nx">g</span><span class="p">,</span><span class="nx">c</span><span class="p">,</span><span class="mi">1</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span><span class="nx">b</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">m</span><span class="p">{</span><span class="mi">8</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">h</span><span class="p">(</span><span class="nx">i</span><span class="o">++</span><span class="p">);</span><span class="mi">5</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">h</span><span class="p">(</span><span class="nx">i</span><span class="o">++</span><span class="p">);</span><span class="mi">7</span><span class="o">=</span><span class="nx">a</span><span class="p">.</span><span class="nx">h</span><span class="p">(</span><span class="nx">i</span><span class="o">++</span><span class="p">);</span><span class="nx">f</span><span class="o">=</span><span class="mi">8</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">;</span><span class="nx">g</span><span class="o">=</span><span class="p">((</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">3</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">4</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="mi">5</span><span class="o">&gt;&gt;</span><span class="mi">4</span><span class="p">);</span><span class="nx">c</span><span class="o">=</span><span class="p">((</span><span class="mi">5</span><span class="o">&amp;</span><span class="nx">s</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="mi">7</span><span class="o">&gt;&gt;</span><span class="mi">6</span><span class="p">);</span><span class="mi">1</span><span class="o">=</span><span class="mi">7</span><span class="o">&amp;</span><span class="nx">t</span><span class="p">;</span><span class="nx">k</span><span class="p">(</span><span class="nx">j</span><span class="p">(</span><span class="mi">5</span><span class="p">)){</span><span class="nx">c</span><span class="o">=</span><span class="mi">1</span><span class="o">=</span><span class="nx">l</span><span class="p">}</span><span class="nx">v</span> <span class="nx">k</span><span class="p">(</span><span class="nx">j</span><span class="p">(</span><span class="mi">7</span><span class="p">)){</span><span class="mi">1</span><span class="o">=</span><span class="nx">l</span><span class="p">}</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="o">+</span><span class="mf">9.</span><span class="nx">d</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span><span class="o">+</span><span class="mf">9.</span><span class="nx">d</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span><span class="o">+</span><span class="mf">9.</span><span class="nx">d</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="o">+</span><span class="mf">9.</span><span class="nx">d</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="mi">8</span><span class="o">=</span><span class="mi">5</span><span class="o">=</span><span class="mi">7</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">;</span><span class="nx">f</span><span class="o">=</span><span class="nx">g</span><span class="o">=</span><span class="nx">c</span><span class="o">=</span><span class="mi">1</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">}</span><span class="nx">u</span><span class="p">(</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">n</span><span class="p">);</span><span class="nx">r</span> <span class="nx">e</span><span class="p">}</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;,</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="o">|</span><span class="nx">enc4</span><span class="o">||||</span><span class="nx">chr2</span><span class="o">||</span><span class="nx">chr3</span><span class="o">|</span><span class="nx">chr1</span><span class="o">|</span><span class="nx">keyStr</span><span class="o">|</span><span class="nx">input</span><span class="o">|</span><span class="kd">var</span><span class="o">|</span><span class="nx">enc3</span><span class="o">|</span><span class="nx">charAt</span><span class="o">|</span><span class="nx">output</span><span class="o">|</span><span class="nx">enc1</span><span class="o">|</span><span class="nx">enc2</span><span class="o">|</span><span class="nx">charCodeAt</span><span class="o">||</span><span class="nb">isNaN</span><span class="o">|</span><span class="k">if</span><span class="o">|</span><span class="mi">64</span><span class="o">|</span><span class="k">do</span><span class="o">|</span><span class="nx">length</span><span class="o">|</span><span class="nx">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</span><span class="o">|</span><span class="kd">function</span><span class="o">|</span><span class="nx">encodeInp</span><span class="o">|</span><span class="k">return</span><span class="o">|</span><span class="mi">15</span><span class="o">|</span><span class="mi">63</span><span class="o">|</span><span class="k">while</span><span class="o">|</span><span class="k">else</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;.</span><span class="nx">split</span><span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;</span><span class="o">|&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;),</span><span class="mi">0</span><span class="p">,{}))</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç æ˜¯æ··æ·†è¿‡çš„base64ç®—æ³•.<strong>è¿™å…¬å¸å¼€å‘çš„æ•™åŠ¡ç³»ç»Ÿçš„ç™»å½•ä¿¡æ¯å±…ç„¶ç”¨å¯é€†ç¼–ç ,è„‘å­å‘¢?</strong></p>
<h3 id="å‰ç«¯è´Ÿè½½å¹³è¡¡">å‰ç«¯è´Ÿè½½å¹³è¡¡</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">selectServer</span><span class="p">(</span><span class="nx">uName</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">enableServers</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span><span class="c1">//æ˜¯å¦å¯ç”¨å¤šæœåŠ¡å™¨ true/false
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">serversArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span><span class="c1">//æœåŠ¡å™¨åˆ—è¡¨
</span><span class="c1"></span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].10:8080/jsxsd1/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].11:8080/jsxsd/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].12:8080/jsxsd/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].13:8080/jsxsd/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].14:8080/jsxsd/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].15:8080/jsxsd/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].16:8080/jsxsd/&#34;</span><span class="p">;</span>

    <span class="nx">serversArray</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;http://[DELETED].17:8080/jsxsd/&#34;</span><span class="p">;</span>


    <span class="kd">var</span> <span class="nx">loginUrl</span> <span class="o">=</span> <span class="s2">&#34;xk/LoginToXk&#34;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">enableServers</span> <span class="o">==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/[^\d]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">uName</span><span class="p">))</span> <span class="p">{</span><span class="c1">//å¿…é¡»ä¸ºæ•°å­—
</span><span class="c1"></span>            <span class="kd">var</span> <span class="nx">modVal</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">uName</span> <span class="o">%</span> <span class="nx">serversArray</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
            <span class="nx">loginUrl</span> <span class="o">=</span> <span class="nx">serversArray</span><span class="p">[</span><span class="nx">modVal</span><span class="p">]</span> <span class="o">+</span> <span class="nx">loginUrl</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">loginUrl</span> <span class="o">=</span> <span class="nx">serversArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">loginUrl</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">loginUrl</span> <span class="o">=</span> <span class="s2">&#34;/jsxsd&#34;</span> <span class="o">+</span> <span class="nx">loginUrl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">loginUrl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>æ•™åŠ¡åœ¨å‰ç«¯ä½œè´Ÿè½½å¹³è¡¡</strong></p>
<p>è¿™æ®µä»£ç æ˜¯å®Œå…¨é¢å‘éœ€æ±‚ç¼–å†™çš„.</p>
<ol>
<li>éœ€è¦è´Ÿè½½åªåœ¨é€‰è¯¾æ—¶,å­¦ç”Ÿå­¦å·åˆ†å¸ƒå‡åŒ€.</li>
<li>å¤§å®¶éƒ½æ˜¯æ­£å¸¸ä½¿ç”¨ç³»ç»Ÿ,ä¸ä¼šæœ‰äººæ¥ææˆ‘.</li>
</ol>
<p>å¦‚æœæœ‰ä»»ä½•ä¸€æ¡ä¸æ»¡è¶³,å°±ç™½çäº†.</p>
<p>ä¸è¿‡è¿™ä¸ª<code>else</code>æ˜¯ä»€ä¹ˆ?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/[^\d]/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">uName</span><span class="p">))</span> <span class="p">{</span><span class="c1">//å¿…é¡»ä¸ºæ•°å­—
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">modVal</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">uName</span> <span class="o">%</span> <span class="nx">serversArray</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">loginUrl</span> <span class="o">=</span> <span class="nx">serversArray</span><span class="p">[</span><span class="nx">modVal</span><span class="p">]</span> <span class="o">+</span> <span class="nx">loginUrl</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">loginUrl</span> <span class="o">=</span> <span class="nx">serversArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">loginUrl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="åå°é¦–é¡µ">åå°é¦–é¡µ</h2>
<p>åå°æ˜¯ä¸€ä¸ªæ¡†æ¶åµŒå¥—çš„æ¨¡å¼.å¦å¤–æ–°æ•™åŠ¡ç½‘é¡µå…ƒç´ çš„é•¿å®½æ˜¯å†™æ­»çš„.</p>
<h3 id="å¤§é‡æ‹¼å†™é”™è¯¯">å¤§é‡æ‹¼å†™é”™è¯¯</h3>
<p>{% asset_img loadkb.png è¯¾è¡¨è¯·æ±‚ %}</p>
<p>æ•™åŠ¡çš„ä¸­è‹±æ–‡æ··è¡€å‘½åæ³•<code>åŠ è½½è¯¾è¡¨</code>.</p>
<p>{% asset_img panle.png æ‹¼å†™é”™è¯¯ %}</p>
<p>çœ‹æ¥è¯¥å…¬å¸ç¡®å®é€‚åˆç”¨æ‹¼éŸ³,è¿™ä¸ªæ‹¼å†™é”™è¯¯å‡ºç°äº†æ— æ•°æ¬¡.</p>
<h3 id="åå°å¯†ç åŠ å¯†">åå°å¯†ç åŠ å¯†</h3>
<p>å¥½å§,æˆ‘æ‰¿è®¤,å½“æˆ‘æ‰“å¼€ç™»å½•åçš„é¦–é¡µå,æˆ‘ç¡®å®çœ‹åˆ°äº†è¿™å®¶å…¬å¸çš„åŠªåŠ›.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">opengld</span><span class="p">(){</span>
    <span class="c1">//...
</span><span class="c1"></span>	<span class="c1">//å–å¾—userid
</span><span class="c1"></span>	<span class="kd">var</span> <span class="nx">userid</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;[</span><span class="nx">DELETED</span><span class="p">]</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;;</span>
	<span class="kd">var</span> <span class="nx">userpsw</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;[</span><span class="nx">DELETED</span><span class="p">]</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">039</span><span class="p">;;</span>
	<span class="c1">//å–å¾—userid
</span><span class="c1"></span>	<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;ticket&#34;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">userid</span><span class="o">+</span><span class="s2">&#34;#&#34;</span><span class="o">+</span><span class="nx">userpsw</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>åç«¯ä½¿ç”¨çš„åŠ å¯†æ–¹å¼ä¸º<strong>æ²¡æœ‰ä»»ä½•åŠ ç›çš„MD5æ‘˜è¦</strong>.</p>
<p><strong>è¿™ä¸ªæ˜¯æå…¶å¹¼ç¨šä¸”ä¸¥é‡çš„å®‰å…¨éšæ‚£</strong>.</p>
<p>å¦å¤–,è¿˜èƒ½çœ‹å‡ºæ¥è¿™å¥—ç³»ç»Ÿåœ¨å¼€å‘æ—¶æ²¡æœ‰ä»»ä½•çº¦å®š,éšæ€§å†™.å‰é¢ç™»å½•ç”¨<code>%%%</code>,è¿™é‡Œç”¨<code>#</code>.</p>
<h3 id="æ•°æ®æäº¤æ–¹å¼">æ•°æ®æäº¤æ–¹å¼</h3>
<p>æ•´ä¸ªåå°æäº¤æ•°æ®çš„æ–¹å¼,å…¨æ˜¯éšè—è¡¨å•+jsèµ‹å€¼æäº¤.</p>
<h2 id="å“åº”æ•°æ®">å“åº”æ•°æ®</h2>
<h3 id="æ—¶é—´">æ—¶é—´</h3>
<p>å…¶HTTPæœåŠ¡ä»ç„¶æ˜¯å®Œç¾çš„æ ¼æ—å°¼æ²»æ—¶é—´,åˆ°æ–‡ç« å‘å¸ƒæ—¶ä¹Ÿæ²¡æ”¹.æˆ‘ä¸çŸ¥é“æ”¹ä¸‹æ—¶é—´å¯¹äºè¯¥å…¬å¸è¿ç»´æ¥è¯´éš¾åº¦æœ‰å¤šå¤§.</p>
<h3 id="cookie">Cookie</h3>
<p>å¯ä»¥å‘ç°CookieåŒæ ·æ˜¯MD5åŠ å¯†äº†ä»€ä¹ˆç©æ„ä¸œè¥¿.</p>
<blockquote>
<p>æœªå®Œå¾…ç»­</p>
</blockquote>
<h2 id="æ–°æ•™åŠ¡-æ—§æ€ç»´">æ–°æ•™åŠ¡ æ—§æ€ç»´</h2>
<p>ç»“è®º,<strong>è¿™ä¸è¯¥æ˜¯ä¸€ä¸ªç°ä»£æ•™åŠ¡è¯¥æœ‰çš„æ°´å¹³</strong>,ä»å¤´åˆ°å°¾éƒ½é€æ¼ç€ä¸ä¸“ä¸šçš„è¡¨ç°,éšä¾¿æŠ“å‡ ä¸ªæœ¬ç§‘ç”Ÿå¤šå­¦ç‚¹htmlå’Œjqueryå’Œjavaçš„æ°´å¹³.è¿csså’Œè‹±è¯­éƒ½ä¸ç”¨å­¦,æ¯•ç«Ÿè¿™csså’Œå‘½åå†™çš„éƒ½æ˜¯ä»€ä¹ˆåƒåœ¾.</p>
<p>æ— æ³•å®Œå…¨æ¥è§¦åˆ°åç«¯,å› æ­¤ä¸çŸ¥é“åç«¯çš„æŠ€æœ¯æ¶æ„å¦‚ä½•,ä¸è¿‡çœ‹å‰ç«¯éƒ½å†™ä¸å¥½,å¤§å¯çŒœæµ‹åç«¯æ¶æ„ä¹Ÿä¸ä¼šæ€æ ·.å•å‡­å‰ç«¯éƒ½æ˜¯æ— è®ºå¦‚ä½•éƒ½æ˜¯è¯´ä¸è¿‡å»çš„.é¦–å…ˆæ˜¯ç¡¬ä¼¤:</p>
<ul>
<li><strong>å®‰å…¨æ„è¯†æ·¡è–„</strong>.è¿™æ˜¯æœ€ä¸¥é‡çš„é—®é¢˜.å‰ç«¯base64,åç«¯md5è¿ç›éƒ½ä¸åŠ ,ç­‰æ’åº“?</li>
</ul>
<p>å…¶ä»–çš„è¯¸å¦‚å¼€å‘äººå‘˜è‹±è¯­éƒ½æ²¡å­¦å¥½ã€å‘½åæ‹¼éŸ³è‹±è¯­æ··åˆä¸€æŠŠæ¢­ï¼Œå‰åç«¯äº¤äº’æ•°æ®æ ¼å¼èƒ¡ä¹±æ‹¼æ¥ä¸€æŠŠæ¢­ï¼Œæ— ç§»åŠ¨ç«¯é€‚é…ï¼Œè¿è¡Œç»´æŠ¤äººå‘˜ä¸å¤ªé è°±ä¹‹ç±»çš„ï¼Œå¦‚æœè¯´åœç•™åœ¨ç³»ç»Ÿèƒ½ç”¨å°±å¥½çš„å±‚é¢ä¸Šï¼Œä¹Ÿä¸æ˜¯ä¸èƒ½æ¥å—ã€‚</p>
<p>å…¶æ¬¡æ˜¯æ„å»ºæ–¹å¼å®Œå…¨æ˜¯äº’è”ç½‘åˆšåˆšå…´èµ·æ—¶çš„æ–¹æ³•ã€‚htmlæ‹¼æ¥ï¼Œä»£ç vanillaä¸€æŠŠæ¢­ï¼Œç¡¬ç¼–ç ï¼Œå’Œé‚£ä¸ªå“­ç¬‘ä¸å¾—çš„è´Ÿè½½å¹³è¡¡â€¦â€¦å°±å¥½åƒæ´»åœ¨ä¸Šä¸ªä¸–çºªã€‚</p>
<p>æ•´å¥—ç³»ç»Ÿæ¥çœ‹,ä¹Ÿè®¸æœ€å¤§çš„å‡çº§æ˜¯å¤šäº†å¥½å‡ å°æ˜é¢ä¸Šçš„&quot;æœåŠ¡å™¨&quot;ã€‚</p>
<p>åœ¨å®é™…é€‰è¯¾æ—¶,æ–°æ•™åŠ¡ä»ç„¶æ— æ³•æ‰¿å—å‹åŠ›,ä¸è¿‡è¿™æœ‰å¯èƒ½æ˜¯å¸¦å®½çš„é”…ã€‚</p>
<p>å¦‚æœä»Šåå‘ç°å¥½ç©çš„ç©æ„,æˆ‘è¿˜ä¼šç»§ç»­è¡¥å…….</p>
<h2 id="ä¸€ç‚¹å¥½ç©çš„">ä¸€ç‚¹å¥½ç©çš„</h2>
<p>ä¸ç”¨&quot;æ€€ç–‘&quot;äº†,è¿™ä¸ªå…¬å¸é£è¯„ä¸é”™å•Šçœ‹æ¥.</p>
<p><a href="https://www.zhihu.com/question/294293977">æ¥çœ‹çœ‹çŸ¥ä¹ä¸Šçš„è¯„ä»·</a></p>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">8å¹´äº†ï¼Œæ˜¥ç‰©ç»ˆäºè¿æ¥äº†ç»“å±€</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/eight-years-for-chunwu/" />
            <id>https://blog.kanari.moe/gossip/eight-years-for-chunwu/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-11-19T10:45:45+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[æˆ‘è§‰å¾—è¿™ä»¶éœ€è¦å‘ä¸€ç¯‡æ¥åº†ç¥ä¸€ä¸‹ã€‚è™½ç„¶ä»å¤´åˆ°å°¾æˆ‘å°±æ²¡æ€€ç–‘è¿‡æœ€ç»ˆä¼šæ˜¯é›ªä¹ƒï¼Œï¼ˆé›ªä¹ƒ!ï¼‰ä½†æ˜¯â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>æˆ‘è§‰å¾—è¿™ä»¶éœ€è¦å‘ä¸€ç¯‡æ¥åº†ç¥ä¸€ä¸‹ã€‚è™½ç„¶ä»å¤´åˆ°å°¾æˆ‘å°±æ²¡æ€€ç–‘è¿‡æœ€ç»ˆä¼šæ˜¯é›ªä¹ƒï¼Œï¼ˆé›ªä¹ƒ!ï¼‰ä½†æ˜¯ç»“å±€ä¸€å‡ºï¼Œè¿˜æ˜¯éå¸¸æ¬£æ…°ã€‚</p>
<p>çœŸå¥½å•Š.jpgã€‚</p>
<p>æ˜¯æ—¶å€™å†ä¹°ä¸€å¥—æ¥æ”¶è—äº†ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æ•°ä½DP</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/digital-dp/" />
            <id>https://blog.kanari.moe/study/digital-dp/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-11-06T19:46:23+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<h2 id="ä¾‹é¢˜-4-hdu2089-ä¸è¦62">ä¾‹é¢˜-4 HDU2089 ä¸è¦62</h2>
<p>ç»Ÿè®¡æ•°ä½ä¸­æ²¡æœ‰å‡ºç°4å’Œ62çš„æ•°å­—ä¸ªæ•°ã€‚</p>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>ä¸è¦4ï¼Œå¯ä»¥åœ¨4æ—¶ç›´æ¥ä¸è½¬ç§»ã€‚å¯¹äº62ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªä¸Šä¸€ä¸ªæ•°å­—å¡«äº†å•¥ï¼Œå°±å¯ä»¥åƒ4ä¸€æ ·åˆ¤æ–­äº†ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="ä¾‹é¢˜-4-hdu2089-ä¸è¦62">ä¾‹é¢˜-4 HDU2089 ä¸è¦62</h2>
<p>ç»Ÿè®¡æ•°ä½ä¸­æ²¡æœ‰å‡ºç°4å’Œ62çš„æ•°å­—ä¸ªæ•°ã€‚</p>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>ä¸è¦4ï¼Œå¯ä»¥åœ¨4æ—¶ç›´æ¥ä¸è½¬ç§»ã€‚å¯¹äº62ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªä¸Šä¸€ä¸ªæ•°å­—å¡«äº†å•¥ï¼Œå°±å¯ä»¥åƒ4ä¸€æ ·åˆ¤æ–­äº†ã€‚</p>
<h3 id="ä»£ç ">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">cache</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">digits</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">last</span><span class="p">,</span><span class="kt">int</span> <span class="n">lim</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">cache</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">last</span><span class="p">])</span><span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">last</span><span class="p">];</span>

    <span class="kt">int</span> <span class="n">maxd</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">lim</span><span class="p">)</span><span class="n">maxd</span><span class="o">=</span><span class="n">digits</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">maxd</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">last</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="o">==</span><span class="mi">62</span> <span class="o">||</span> <span class="n">i</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">res</span><span class="o">+=</span><span class="n">solve</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="n">maxd</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span><span class="n">cache</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">last</span><span class="p">]</span><span class="o">=</span><span class="n">res</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">SOLVE</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
        <span class="n">digits</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
        <span class="n">x</span><span class="o">/=</span><span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>



<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ll</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">cache</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">cache</span><span class="p">));</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="n">r</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">r</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">SOLVE</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="n">SOLVE</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¾‹é¢˜-3-hdu3555">ä¾‹é¢˜-3 HDU3555</h2>
<p>ç»Ÿè®¡æ‰€æœ‰å‡ºç°è¿‡49çš„æ•°å­—çš„ä¸ªæ•°ã€‚</p>
<h3 id="åˆ†æ-1">åˆ†æ</h3>
<p>ç»Ÿè®¡æ‰€æœ‰æ²¡å‡ºç°è¿‡49çš„æ•°å­—ï¼Œå°±å’Œä¸Šä¸€é“ä¸€æ ·äº†ã€‚</p>
<h3 id="ä»£ç -1">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">50</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">digits</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">last</span><span class="p">,</span><span class="kt">int</span> <span class="n">lim</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">f</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">last</span><span class="p">])</span><span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">last</span><span class="p">];</span>

    <span class="kt">int</span> <span class="n">maxd</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">lim</span><span class="p">)</span><span class="n">maxd</span><span class="o">=</span><span class="n">digits</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">maxd</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">last</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="o">==</span><span class="mi">49</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">res</span><span class="o">+=</span><span class="n">solve</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="n">maxd</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">last</span><span class="p">]</span><span class="o">=</span><span class="n">res</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">SOLVE</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
        <span class="n">digits</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
        <span class="n">x</span><span class="o">/=</span><span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">));</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">r</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">r</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">r</span><span class="o">-</span><span class="n">SOLVE</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¾‹é¢˜-2-poj3252">ä¾‹é¢˜-2 POJ3252</h2>
<p>The cows, as you know, have no fingers or thumbs and thus are unable to play Scissors, Paper, Stoneï¿½ (also known as ï¿½Rock, Paper, Scissorsï¿½, ï¿½Ro, Sham, Boï¿½, and a host of other names) in order to make arbitrary decisions such as who gets to be milked first. They canï¿½t even flip a coin because itï¿½s so hard to toss using hooves.</p>
<p>They have thus resorted to &quot;round number&quot; matching. The first cow picks an integer less than two billion. The second cow does the same. If the numbers are both &quot;round numbers&quot;, the first cow wins,
otherwise the second cow wins.</p>
<p>A positive integer N is said to be a &quot;round number&quot; if the binary representation of N has as many or more zeroes than it has ones. For example, the integer 9, when written in binary form, is 1001. 1001 has two zeroes and two ones; thus, 9 is a round number. The integer 26 is 11010 in binary; since it has two zeroes and three ones, it is not a round number.</p>
<p>Obviously, it takes cows a while to convert numbers to binary, so the winner takes a while to determine. Bessie wants to cheat and thinks she can do that if she knows how many &quot;round numbers&quot; are in a given range.</p>
<p>Help her by writing a program that tells how many round numbers appear in the inclusive range given by the input (1 â‰¤ Start &lt; Finish â‰¤ 2,000,000,000).</p>
<h3 id="åˆ†æ-2">åˆ†æ</h3>
<p>è¿™é“é¢˜ç›®å°†ä¸Šç•Œæ‹†è§£ä¸ºäºŒè¿›åˆ¶æ•°ä½ã€‚</p>
<h3 id="ä»£ç -2">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">50</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">digits</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">len</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">one</span><span class="p">,</span><span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lim</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">pos</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="c1">//cout&lt;&lt;first&lt;&lt;&#34; &#34;&lt;&lt;one&lt;&lt;endl;
</span><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="n">first</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">first</span><span class="o">-</span><span class="n">one</span><span class="o">&gt;=</span><span class="n">one</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">f</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">one</span><span class="p">][</span><span class="n">first</span><span class="p">])</span><span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">one</span><span class="p">][</span><span class="n">first</span><span class="p">];</span>

    <span class="kt">int</span> <span class="n">maxd</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">lim</span><span class="p">)</span><span class="n">maxd</span><span class="o">=</span><span class="n">digits</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">maxd</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">res</span><span class="o">+=</span><span class="n">solve</span><span class="p">(</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">one</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">),(</span><span class="n">i</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">first</span><span class="o">?</span> <span class="nl">pos</span> <span class="p">:</span> <span class="n">first</span><span class="p">),</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="n">maxd</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">one</span><span class="p">][</span><span class="n">first</span><span class="p">]</span><span class="o">=</span><span class="n">res</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">SOLVE</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
        <span class="n">digits</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">x</span><span class="o">/=</span><span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">));</span>
    <span class="n">ll</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="n">r</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">SOLVE</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="n">SOLVE</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¾‹é¢˜-1-hdu3652">ä¾‹é¢˜-1 HDU3652</h2>
<p>A wqb-number, or B-number for short, is a non-negative integer whose decimal form contains the sub- string &quot;13&quot; and can be divided by 13. For example, 130 and 2613 are wqb-numbers, but 143 and 2639 are not. Your task is to calculate how many wqb-numbers from 1 to n for a given integer n.</p>
<h3 id="åˆ†æ-3">åˆ†æ</h3>
<p>ç»´æŠ¤é¢å¤–2ä¸ªçŠ¶æ€ï¼Œä¸€ä¸ªçŠ¶æ€è®°å½•æ¨¡13çš„ä½™æ•°ï¼Œå¦ä¸€ä¸ªè¿›è¡Œç¼–ç ï¼š1ä¸ºä¸Šä¸€ä½ä¸º1ï¼Œ3ä¸ºå·²ç»å‡ºç°è¿‡13ï¼Œ0ä¸ºå…¶ä»–ã€‚ä¹‹åå°†è½¬ç§»æ¡ä»¶æè¿°æ¸…æ¥šå°±å¯ä»¥äº†ã€‚</p>
<h3 id="ä»£ç -3">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="mi">5</span><span class="p">][</span><span class="mi">20</span><span class="p">];</span>
<span class="n">ll</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">ptr</span><span class="p">,</span><span class="kt">int</span> <span class="n">last</span><span class="p">,</span><span class="kt">int</span> <span class="n">mod</span><span class="p">,</span><span class="kt">bool</span> <span class="n">lim</span><span class="p">){</span>
	<span class="c1">//cout&lt;&lt;&#34;arrive&#34;&lt;&lt;ptr&lt;&lt;&#34; &#34;&lt;&lt;last&lt;&lt;&#34; &#34;&lt;&lt;mod&lt;&lt;&#34; &#34;&lt;&lt;lim&lt;&lt;endl;
</span><span class="c1"></span>	<span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">last</span><span class="o">==</span><span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="n">mod</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">last</span><span class="p">][</span><span class="n">mod</span><span class="p">])</span><span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">last</span><span class="p">][</span><span class="n">mod</span><span class="p">];</span>

	<span class="kt">int</span> <span class="n">maxx</span><span class="o">=</span><span class="n">lim</span><span class="o">?</span><span class="n">num</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">:</span><span class="mi">9</span><span class="p">;</span>
	<span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">maxx</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">last</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="n">res</span><span class="o">+=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="n">mod</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">13</span><span class="p">,</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="n">maxx</span><span class="p">);</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">last</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="n">res</span><span class="o">+=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="n">mod</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">13</span><span class="p">,</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="n">maxx</span><span class="p">);</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">+=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">mod</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">13</span><span class="p">,</span><span class="n">lim</span><span class="o">&amp;&amp;</span><span class="n">i</span><span class="o">==</span><span class="n">maxx</span><span class="p">);</span>
		<span class="k">else</span> <span class="n">res</span><span class="o">+=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,(</span><span class="n">mod</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">13</span><span class="p">,</span><span class="n">lim</span><span class="o">&amp;&amp;</span><span class="n">i</span><span class="o">==</span><span class="n">maxx</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">last</span><span class="p">][</span><span class="n">mod</span><span class="p">]</span><span class="o">=</span><span class="n">res</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="n">ll</span> <span class="n">r</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="p">){</span>
		<span class="n">num</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span><span class="o">=</span><span class="n">r</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
		<span class="n">r</span><span class="o">/=</span><span class="mi">10</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">));</span>
	<span class="n">ll</span> <span class="n">r</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">r</span><span class="p">){</span>
		<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">solve</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¾‹é¢˜0-hdu3709">ä¾‹é¢˜0 HDU3709</h2>
<p>A balanced number is a non-negative integer that can be balanced if a pivot is placed at some digit. More specifically, imagine each digit as a box with weight indicated by the digit. When a pivot is placed at some digit of the number, the distance from a digit to the pivot is the offset between it and the pivot. Then the torques of left part and right part can be calculated. It is balanced if they are the same. A balanced number must be balanced with the pivot at some of its digits. For example, 4139 is a balanced number with pivot fixed at 3. The torqueses are 4<em>2 + 1</em>1 = 9 and 9*1 = 9, for left part and right part, respectively. Itï¿½s your job to calculate the number of balanced numbers in a given range [x, y].</p>
<h3 id="åˆ†æ-4">åˆ†æ</h3>
<p>è¿™é¢˜æœ‰ç‚¹éº»çƒ¦â€¦â€¦</p>
<p>å°†æ æ†åœ¨å“ªä¸é¢˜ç›®åˆ†ç¦»å‡ºæ¥ï¼Œæšä¸¾æ æ†å®šåœ¨ä½•å¤„ã€‚å†ç»´æŠ¤æ˜¯å¦å¹³è¡¡ã€‚å¹³è¡¡ä¸å¦è¿˜æ˜¯æŒºå¥½è€ƒè™‘çš„ï¼Œä»¥æ æ†ä¸º0ï¼Œå·¦å³å„èµ‹å€¼æ­£ä¸è´Ÿçš„æƒå€¼ï¼Œå½“åˆ°è¾¾è¾¹æ¥åå…¨æ†é‡é‡ä¸º0æ—¶å³ä¸ºå¹³è¡¡ã€‚</p>
<blockquote>
<p>æœ‰ä¸€ä¸ªå°å‘ï¼Œå°±æ˜¯0ã€‚å¦‚æœè¿™ä¸ªæ•°å­—å…¨tmå¡«0çš„æ—¶å€™ï¼Œä¸ç®¡æ æ†å®šåœ¨å“ªï¼Œå®ƒéƒ½å¹³è¡¡â€¦â€¦ä½ å½“ç„¶å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå‰å¯¼é›¶æ ‡å¿—ï¼Œå°†æ‰€æœ‰0éƒ½å»æ‰æœ€åå†åŠ ä¸Šã€‚è¿˜æœ‰ä¸€ç§åŠæ³•å°±æ˜¯æœ€åå†å°†é‡å¤çš„0å‡å»ï¼Œç›¸æ¯”èµ·æ¥æ›´åŠ ç®€å•ã€‚</p>
</blockquote>
<h3 id="ä»£ç -4">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">20</span><span class="p">][</span><span class="mi">2010</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">ptr</span><span class="p">,</span><span class="kt">bool</span> <span class="n">lim</span><span class="p">,</span><span class="kt">int</span> <span class="n">piv</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="n">l</span><span class="o">==</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">piv</span><span class="p">][</span><span class="n">l</span><span class="p">])</span><span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">piv</span><span class="p">][</span><span class="n">l</span><span class="p">];</span>

	<span class="kt">int</span> <span class="n">maxx</span><span class="o">=</span><span class="n">lim</span><span class="o">?</span><span class="n">num</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">:</span><span class="mi">9</span><span class="p">;</span>

	<span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">maxx</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">res</span><span class="o">+=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">==</span><span class="n">maxx</span><span class="p">,</span><span class="n">piv</span><span class="p">,</span><span class="n">l</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="n">piv</span><span class="p">));</span>
	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">piv</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="n">res</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="n">ll</span> <span class="n">r</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="p">){</span>
		<span class="n">num</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span><span class="o">=</span><span class="n">r</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
		<span class="n">r</span><span class="o">/=</span><span class="mi">10</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">ptr</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">ans</span><span class="o">+=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ans</span><span class="o">-</span><span class="n">ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">f</span><span class="p">));</span>
		<span class="n">ll</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="n">r</span><span class="p">;</span>
		<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">solve</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">l</span><span class="o">?-</span><span class="n">solve</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¾‹é¢˜1-cf55d">ä¾‹é¢˜1 CF55D</h2>
<p>Volodya is an odd boy and his taste is strange as well. It seems to him that a positive integer number is beautiful if and only if it is divisible by each of its nonzero digits. We will not argue with this and just count the quantity of beautiful numbers in given ranges.</p>
<h3 id="åˆ†æ-5">åˆ†æ</h3>
<p>ç»´æŠ¤æ•°å­—å¯¹0-9æ¯ä¸ªæ•°å­—çš„æ¨¡ï¼Œä½†æ˜¯è¿™æ ·è¿˜éœ€è¦ç»´æŠ¤æŸäº›æ•°å­—æ˜¯å¦å‡ºç°ï¼Œç»§ç»­è€ƒè™‘ã€‚å½“æ•°å­—èƒ½åŒæ—¶è¢«$a$å’Œ$b$æ•´é™¤ï¼Œç­‰ä»·ä¸ºå…¶èƒ½å¤Ÿè¢«å®ƒä¿©çš„æœ€å°å…¬å€æ•°æ•´é™¤ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„é—®é¢˜å¯ä»¥ç¨å¾®ç®€åŒ–ä¸€ä¸‹äº†ã€‚ç»´æŠ¤å·²ç»å¡«å†™çš„æ•°ä½çš„æœ€å°å…¬å€æ•°ï¼Œå¹¶ç»´æŠ¤æ•°å­—å’Œã€‚åˆ°è¾¾è¾¹ç•Œæ—¶ï¼Œåªæœ‰æ»¡è¶³æ¡ä»¶æ‰è®¡æ•°ã€‚</p>
<blockquote>
<p>è¿™é“é¢˜è¿˜æœ‰ä¸€ç‚¹éº»çƒ¦ï¼Œå°±æ˜¯å†…å­˜å®ƒä¸å¤Ÿç”¨ã€‚æŒ‰ç…§åˆ†æï¼Œè‡³å°‘éœ€è¦å¼€$2520\times 2520$ï¼Œè¿˜è¦å†åŠ ä¸Šä¸ªæ•°ä½é•¿åº¦ã€‚å†…å­˜å°±ç‚¸äº†ã€‚å®é™…ä¸Šï¼Œæœ€å°å…¬å€æ•°ä»…æœ‰äº†äº†å‡ ä¸ªï¼Œå¯ä»¥äº‹å…ˆæ±‚å‡ºå¹¶å…ˆç¼–ç ï¼Œå°±èƒ½é™ä½ä¸€ç»´çŠ¶æ€ã€‚</p>
</blockquote>
<h3 id="ä»£ç -5">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">2620</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAX_LCM</span> <span class="o">=</span> <span class="mi">2520</span><span class="p">;</span>
<span class="c1">//posä½æ•°ä½™restæ¨¡Â·10Â·çš„æ–¹æ¡ˆ
</span><span class="c1"></span><span class="n">ll</span> <span class="n">cache</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="n">MAXN</span><span class="p">][</span><span class="mi">50</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">digits</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">lcmref</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="o">!</span><span class="n">b</span> <span class="o">?</span> <span class="nl">a</span> <span class="p">:</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">init_lcm</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">temp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">lcm</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lcmref</span><span class="p">[</span><span class="n">temp</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="c1">//cout &lt;&lt; temp &lt;&lt; endl;
</span><span class="c1"></span>            <span class="n">lcmref</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span><span class="o">=++</span><span class="n">idx</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rest</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">lim</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rest</span> <span class="o">%</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">cache</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">rest</span><span class="p">][</span><span class="n">lcmref</span><span class="p">[</span><span class="n">l</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">rest</span><span class="p">][</span><span class="n">lcmref</span><span class="p">[</span><span class="n">l</span><span class="p">]];</span>

    <span class="n">ll</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">maxd</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lim</span><span class="p">)</span>
        <span class="n">maxd</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">maxd</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">solve</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">rest</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">MAX_LCM</span><span class="p">,</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nl">l</span> <span class="p">:</span> <span class="n">lcm</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">maxd</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span>
        <span class="n">cache</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">rest</span><span class="p">][</span><span class="n">lcmref</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">SOLVE</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">ptr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">digits</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">init_lcm</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">kase</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">cache</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">cache</span><span class="p">));</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ll</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">;</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">SOLVE</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">SOLVE</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¾‹é¢˜2">ä¾‹é¢˜2</h2>
<p>æ±‚$[l,r]$åŒºé—´å†…çš„æ‰€æœ‰æ»¡è¶³ä»¥ä¸‹è¦æ±‚çš„æ•°çš„å¹³æ–¹å’Œã€‚</p>
<ol>
<li>æ•°ä½ä¸Šæ²¡æœ‰$7$</li>
<li>ä¸æ˜¯$7$çš„å€æ•°</li>
<li>æ•°ä½å’Œä¸æ˜¯$7$çš„å€æ•°</li>
</ol>
<p>åŒºé—´ä¸º$10^{18}$çº§åˆ«ï¼Œè¯·å¯¹ç­”æ¡ˆå–æ¨¡$10^{9}+7$ã€‚</p>
<h3 id="åˆ†æ-6">åˆ†æ</h3>
<p>è¿™é¢˜æŒºç‹ çš„â€¦â€¦é¦–å…ˆçœ‹å¦‚ä½•åˆ¤æ–­ä¸Šé¢çš„3ä¸ªæ¡ä»¶ã€‚</p>
<ul>
<li>æ•°ä½ä¸Šæ²¡æœ‰$7$ï¼Œå¯ä»¥ç›´æ¥åœ¨æšä¸¾å¡«æ•°æ—¶è·³è¿‡$7$ã€‚</li>
<li>é * çš„å€æ•°ï¼Œå¯ä»¥ç»´æŠ¤å·²å¡«æ•°å­—çš„å–æ¨¡ã€‚å–æ¨¡ä¸º$0$åˆ™ä¸ºå€æ•°ã€‚</li>
<li>æ•°ä½å’Œï¼Œä»ç„¶å¯ä»¥ç›´æ¥ç»´æŠ¤ã€‚</li>
</ul>
<p>è¿™æ ·å°±å¯ä»¥æ­£ç¡®çš„åˆ¤æ–­æŸä¸ªæ•°æ˜¯ä¸æ˜¯æ»¡è¶³æ¡ä»¶ã€‚æ¥ä¸‹æ¥æ˜¯å¹³æ–¹å’Œã€‚</p>
<p>å½“ä»¥æ•°ä½æ¥è€ƒè™‘å¹³æ–¹å’Œæ—¶ï¼Œé—®é¢˜å°±ç¨å¾®å˜å¾—å¤æ‚äº†ã€‚å‡è®¾æˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸‹ä¸€ä¸ªçŠ¶æ€çš„å¹³æ–¹å’Œä¸º$x_n$ï¼Œå¦‚ä½•å¾—åˆ°å½“å‰ä½$x$çš„å¹³æ–¹å’Œã€‚</p>
<p>å‡è®¾å½“å‰ä½$ptr$å¡«äº†$i$ã€‚å…¶æ•°ä½æ‰€è¡¨è¾¾çš„æ„ä¹‰æ˜¯$10^{p}i$ï¼Œé‚£ä¹ˆä»¥è¯¥ä½ä¸ä¸‹ä¸€çŠ¶æ€çš„å¹³æ–¹å’Œï¼Œéœ€è¦ä¸‹ä¸€çŠ¶æ€çš„<strong>å’Œ</strong>ï¼Œå®šä¸º$s_n$ã€‚å¯ä»¥å¾—åˆ°</p>
<div>$$
(10^p i+s_n)^2=10^{2p}i^2+2 \cdot 10^pis_n+s_n^2
$$</div>
<p>å¦å¤–ï¼Œå½“å‰ä½çš„å‡ºç°æ¬¡æ•°åœ¨å®é™…è®¡ç®—æ—¶éœ€è¦è€ƒè™‘è¿›å»ã€‚é‚£ä¹ˆï¼Œè¿˜éœ€è¦ç»´æŠ¤ä¸‹ä¸€çŠ¶æ€çš„<strong>ä¸ªæ•°</strong>ï¼Œè®°$cnt$ã€‚é‚£ä¹ˆï¼Œä¸Šå¼éœ€è¦ä¿®æ”¹</p>
<div>$$
10^{2p}i^2 \cdot cnt_n+2 \cdot 10^pis_n+s_n^2
$$</div>
<p>åä¸¤é¡¹ä¸ä¹˜ä»¥$cnt$æ˜¯å› ä¸ºå®ƒä»¬æœ¬èº«å°±å·²ç»æ˜¯åŒ…æ‹¬äº†ä¸‹ä¸€çŠ¶æ€çš„æ‰€æœ‰è®¡æ•°ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä»¥æ•°ä½ä¸ºè§’åº¦çš„å¹³æ–¹å’Œç»´æŠ¤åŠæ³•ã€‚</p>
<h3 id="ä»£ç -6">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">22</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">MOD</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">Status</span><span class="p">{</span>
	<span class="n">ll</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="n">ll</span> <span class="n">sum</span><span class="p">,</span><span class="n">sqsum</span><span class="p">;</span>
	<span class="n">Status</span><span class="p">(</span><span class="n">ll</span> <span class="n">cnt</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ll</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ll</span> <span class="n">sqsum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="n">cnt</span><span class="p">(</span><span class="n">cnt</span><span class="p">),</span><span class="n">sum</span><span class="p">(</span><span class="n">sum</span><span class="p">),</span><span class="n">sqsum</span><span class="p">(</span><span class="n">sqsum</span><span class="p">){}</span>
<span class="p">}</span> <span class="n">f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="mi">9</span><span class="o">*</span><span class="mi">20</span><span class="p">][</span><span class="mi">10</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span>
	<span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">MOD</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Status</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">ptr</span><span class="p">,</span><span class="kt">int</span> <span class="n">sum</span><span class="p">,</span><span class="kt">int</span> <span class="n">mod</span><span class="p">,</span><span class="kt">bool</span> <span class="n">lim</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">){</span>
		<span class="k">return</span> <span class="n">Status</span><span class="p">(</span><span class="n">sum</span><span class="o">%</span><span class="mi">7</span><span class="o">!=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">mod</span><span class="o">!=</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span> <span class="o">&amp;&amp;</span> <span class="o">~</span><span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">sum</span><span class="p">][</span><span class="n">mod</span><span class="p">].</span><span class="n">cnt</span><span class="p">)</span><span class="k">return</span> <span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">sum</span><span class="p">][</span><span class="n">mod</span><span class="p">];</span>

	<span class="kt">int</span> <span class="n">maxx</span><span class="o">=</span><span class="n">lim</span><span class="o">?</span><span class="n">num</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">:</span><span class="mi">9</span><span class="p">;</span>
	<span class="n">Status</span> <span class="n">res</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">maxx</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">7</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
		<span class="n">Status</span> <span class="n">nex</span><span class="o">=</span><span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">sum</span><span class="o">+</span><span class="n">i</span><span class="p">,(</span><span class="n">mod</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">7</span><span class="p">,</span><span class="n">lim</span><span class="o">&amp;&amp;</span><span class="n">i</span><span class="o">==</span><span class="n">maxx</span><span class="p">);</span>
		<span class="n">res</span><span class="p">.</span><span class="n">cnt</span><span class="o">+=</span><span class="n">nex</span><span class="p">.</span><span class="n">cnt</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">cnt</span><span class="o">%=</span><span class="n">MOD</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">sum</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">sum</span><span class="o">%</span><span class="n">MOD</span><span class="o">+</span><span class="n">qpow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">nex</span><span class="p">.</span><span class="n">cnt</span><span class="o">%</span><span class="n">MOD</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">sum</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">sum</span><span class="o">+</span><span class="n">nex</span><span class="p">.</span><span class="n">sum</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">sqsum</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">sqsum</span><span class="o">+</span><span class="n">nex</span><span class="p">.</span><span class="n">cnt</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">qpow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">MOD</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">sqsum</span><span class="o">=</span><span class="p">((</span><span class="n">res</span><span class="p">.</span><span class="n">sqsum</span><span class="o">+</span><span class="n">nex</span><span class="p">.</span><span class="n">sqsum</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">qpow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">ptr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">MOD</span><span class="o">*</span><span class="n">nex</span><span class="p">.</span><span class="n">sum</span><span class="o">%</span><span class="n">MOD</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">lim</span><span class="p">)</span><span class="n">f</span><span class="p">[</span><span class="n">ptr</span><span class="p">][</span><span class="n">sum</span><span class="p">][</span><span class="n">mod</span><span class="p">]</span><span class="o">=</span><span class="n">res</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>


<span class="n">ll</span> <span class="nf">solve</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="p">){</span>
		<span class="n">num</span><span class="p">[</span><span class="o">++</span><span class="n">ptr</span><span class="p">]</span><span class="o">=</span><span class="n">n</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
		<span class="n">n</span><span class="o">/=</span><span class="mi">10</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">dfs</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">).</span><span class="n">sqsum</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	<span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
		<span class="n">ll</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="n">r</span><span class="p">;</span>
		<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">((</span><span class="n">solve</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">l</span><span class="o">?</span><span class="n">solve</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span><span class="mi">0</span><span class="p">))</span><span class="o">%</span><span class="n">MOD</span><span class="o">+</span><span class="n">MOD</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="æ•°ä½dp">æ•°ä½DP</h2>
<p>ä¸Šé¢è¿™é“é¢˜ç›®å¤§æ¦‚ç®—æ˜¯æš´éœ²äº†æ•°ä½DPä¸­éœ€è¦è€ƒè™‘çš„äº‹æƒ…ã€‚æ•°ä½DPèƒ½å¤Ÿä¸»è¦èƒ½å¤Ÿç»Ÿè®¡æŸ2ä¸ªæ•°å­—åŒºé—´å†…æ»¡è¶³æŸäº›æ¡ä»¶çš„æ•°å­—çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸ªæ•°ã€å’Œã€å¹³æ–¹å’Œâ€¦â€¦</p>
<p>é¦–å…ˆæ•°ä½DPä¸æ˜¯å•ç‹¬è€ƒè™‘æ¯ä¸€ä¸ªæ•°å­—ï¼Œè€Œæ˜¯ä»¥æ•°ä½ä¸ºå•ä½çš„è€ƒè™‘ã€‚è¿™æ ·åœ¨è€ƒè™‘æ¡ä»¶æ»¡è¶³å’Œå„ç±»ä¿¡æ¯çš„ç»´æŠ¤æ—¶ï¼Œå°±éœ€è¦è½¬ä¸€è½¬ã€‚</p>
<p>å…ˆæ¥çœ‹è®°å¿†åŒ–æœç´¢ã€‚æ¯”è¾ƒç›´è§‚ï¼ˆ</p>
<h3 id="è®¡æ•°åŸºç¡€">è®¡æ•°åŸºç¡€</h3>
<p>åˆå§‹åŒ–çš„å€¼ä»ä½•è€Œæ¥ã€‚å½“æ•°ä½DPåˆ°è¾¾äº†è¾¹ç•Œï¼Œå°±æ˜¯è¦è€ƒè™‘åˆå§‹åŒ–çš„ä½ç½®ã€‚ä¸€èˆ¬ä¸ºæ»¡è¶³æ¡ä»¶ç½®$1$ã€‚</p>
<h3 id="æ»¡è¶³æ¡ä»¶">æ»¡è¶³æ¡ä»¶</h3>
<p>è¿™æ˜¯æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„çŠ¶æ€ã€‚ä¾‹å¦‚ä¸Šé¢æåˆ°çš„ã€‚</p>
<ul>
<li>æ•°ä½æ²¡æœ‰æŸæ•°ï¼šç›´æ¥ä¸è½¬ç§»ã€‚</li>
<li>æ•°ä½å’Œï¼šç›´æ¥ç»´æŠ¤ä¸€ç»´æ•°ä½å’Œã€‚</li>
<li>å€æ•°å…³ç³»ï¼šä»¥é€’æ¨æ–¹å¼ç»´æŠ¤å–æ¨¡ã€‚</li>
<li>æ•°å­—å‡ºç°æ¬¡æ•°ï¼šä½¿ç”¨çŠ¶å‹æ¥å¯¹æ¬¡æ•°ç¼–ç ã€‚ä¾‹å¦‚ï¼Œå¯¹æ¯ä¸€ç§æ•°å­—ç»´æŠ¤ç©ºé—´ä¸º3çš„çŠ¶æ€ï¼ˆ0ï¼Œå¥‡æ•°ï¼Œå¶æ•°ï¼‰ã€‚</li>
</ul>
<p>å…¶å®è¿˜å¯èƒ½æœ‰å¾ˆå¤šï¼Œä¸»è¦è€ƒè™‘çš„é—®é¢˜æ˜¯è¯¥çŠ¶æ€ç»è¿‡ç¼–ç åèƒ½ä¸èƒ½ä¿å­˜ä¸‹æ¥ï¼Œä¸¤ä¸ªçŠ¶æ€ä¹‹é—´èƒ½ä¸èƒ½é€’æ¨è¿‡å»ã€‚</p>
<h3 id="è®¡æ•°">è®¡æ•°</h3>
<p>å¿…é¡»è€ƒè™‘$n-1$åˆ°$n$<strong>ä½</strong>ä¹‹é—´çš„è½¬ç§»å…³ç³»ã€‚é¦–å…ˆä¸€å®šä¼šç»´æŠ¤æ»¡è¶³æ€§è´¨çš„æ•°å­—ä¸ªæ•°ï¼Œä¹‹åæ¯ä¸€ä¸ªä½çš„è®¡ç®—éƒ½éœ€è¦è€ƒè™‘ä¸‹ä¸€çŠ¶æ€çš„ä¸ªæ•°ã€‚</p>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Liaoning Shipâ€™s Voyage</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/liaoning-ships-voyage/" />
            <id>https://blog.kanari.moe/code/liaoning-ships-voyage/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-27T14:13:44+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>Liaoning ship, which named after a province of China, is the first aircraft carrier commissioned into the People's Liberation Army Navy. It was bought from Ukraine as a stripped hulk and was rebuilt by China as an important part of Chinaâ€™s blue water Navy plan. Liaoning ship has sailed far into the Pacific Ocean for serval times, which shows the power and resolve of China to defend her integrity of territory.</p>
<p>Now Liaoning ship is on a new voyage to the Atlantic Ocean for a maneuver! The vast maneuver region on the ocean can be seen as an nÃ—n grid which has nÃ—n crosspoints. Each crosspoint stands for a check point of the maneuver region. Liaoning starts from the bottom-left check point whose coordinate is (0,0), and its destination is the upper-right checkpoint whose coordinate is (n-1,n-1). The positive side of the x axis points to the right, and the positive side of the y axis points up. All check pointsâ€™ coordinates are integral. During each move, Liaoning can go from one check point to its adjacent 8 check points along a straight line, and each move takes Liaoning one day. Some check points are not available to go due to the bad weather. And, as you know, on the Atlantic Ocean, there is a Bermuda Triangle in which many ships and planes were missing. Liaoning canâ€™t take risk to go into that triangle. Of course, Liaoning canâ€™t go outside the maneuver region. Please figure out a route for Liaoning to reach its destination as soon as possible.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å®é™…ä¸Šæœ¬ä½“æ˜¯ä¸ªDijkstraï¼Œä½†æ˜¯ä¸¤ç‚¹æ˜¯å¦ç›¸è¿éœ€è¦ä½¿ç”¨åˆ°è®¡ç®—å‡ ä½•çš„ä¸œè¥¿ã€‚é‡ç‚¹å°±åœ¨äºå¦‚ä½•åˆ¤æ–­è¡Œè¿›è¿‡ç¨‹æ˜¯å¦ç©¿è¿‡äº†ç™¾æ…•å¤§ä¸‰è§’ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Liaoning ship, which named after a province of China, is the first aircraft carrier commissioned into the People's Liberation Army Navy. It was bought from Ukraine as a stripped hulk and was rebuilt by China as an important part of Chinaâ€™s blue water Navy plan. Liaoning ship has sailed far into the Pacific Ocean for serval times, which shows the power and resolve of China to defend her integrity of territory.</p>
<p>Now Liaoning ship is on a new voyage to the Atlantic Ocean for a maneuver! The vast maneuver region on the ocean can be seen as an nÃ—n grid which has nÃ—n crosspoints. Each crosspoint stands for a check point of the maneuver region. Liaoning starts from the bottom-left check point whose coordinate is (0,0), and its destination is the upper-right checkpoint whose coordinate is (n-1,n-1). The positive side of the x axis points to the right, and the positive side of the y axis points up. All check pointsâ€™ coordinates are integral. During each move, Liaoning can go from one check point to its adjacent 8 check points along a straight line, and each move takes Liaoning one day. Some check points are not available to go due to the bad weather. And, as you know, on the Atlantic Ocean, there is a Bermuda Triangle in which many ships and planes were missing. Liaoning canâ€™t take risk to go into that triangle. Of course, Liaoning canâ€™t go outside the maneuver region. Please figure out a route for Liaoning to reach its destination as soon as possible.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å®é™…ä¸Šæœ¬ä½“æ˜¯ä¸ªDijkstraï¼Œä½†æ˜¯ä¸¤ç‚¹æ˜¯å¦ç›¸è¿éœ€è¦ä½¿ç”¨åˆ°è®¡ç®—å‡ ä½•çš„ä¸œè¥¿ã€‚é‡ç‚¹å°±åœ¨äºå¦‚ä½•åˆ¤æ–­è¡Œè¿›è¿‡ç¨‹æ˜¯å¦ç©¿è¿‡äº†ç™¾æ…•å¤§ä¸‰è§’ã€‚</p>
<p>ç„¶åå°±WAäº†8å‘ã€‚</p>
<p>å®é™…åˆ¤æ–­æ—¶ä¼šæœ‰å¾ˆå¤šé—®é¢˜ã€‚ä¾‹å¦‚ä»è¾¹ä¸Šç»è¿‡ï¼Œä»å¤–ç•Œåˆ°è¾¹ï¼Œä»è¾¹åˆ°è¾¹ï¼Œä»è¾¹åˆ°å¤–ç•Œï¼Œä»å¤–ç•Œåˆ°ç‚¹ï¼Œä»ç‚¹åˆ°å¤–ç•Œï¼Œä»è¾¹ç©¿è¿‡ç‚¹â€¦â€¦å¦‚æœä¸€å¼€å§‹é€‰æ‹©çš„åˆ¤æ–­æ–¹æ³•æœ‰é”…çš„è¯ï¼Œä¹‹åå°±æ”¹ä¸å‡ºæ¥äº†ï¼Œåªèƒ½WAâ€¦â€¦</p>
<p>æœ€ç»ˆæƒ³å‡ºæ¥çš„è§£å†³åŠæ³•æ˜¯æ‹¿åˆ°è¡Œè¿›çº¿æ®µä¸ä¸‰è§’å½¢ä¸‰è¾¹çš„äº¤ç‚¹ï¼Œè¿æ¥äº¤ç‚¹æ„é€ æ–°çº¿æ®µåï¼Œåˆ¤æ–­çº¿æ®µä¸­ç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ï¼›å¹¶åŒæ—¶åˆ¤æ–­èµ·ç‚¹ç»ˆç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ã€‚è¿™æ ·å°±èƒ½é¿å…æ‰å¤æ‚çš„è®¨è®ºã€‚</p>
<p>å…¶æ¬¡ï¼Œé¡ºä¾¿æŠŠå·²ç»åœ¨ä¸‰è§’å½¢å†…çš„æ•´ç‚¹å…¨éƒ¨æ ‡è®°äº†ä¸èƒ½è®¿é—®ã€‚</p>
<p>è¿™æ ·å°±è¿‡äº†ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>æ¿å­åˆ¤ç‚¹åœ¨çº¿æ®µéƒ¨åˆ†æœ‰é—®é¢˜ï¼Œè¦æ”¹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">30</span><span class="p">;</span>


<span class="kt">bool</span> <span class="n">fuck</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">EPS</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">PI</span><span class="o">=</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">sgn</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;-</span><span class="n">EPS</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="n">EPS</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">struct</span> <span class="nc">Vec</span><span class="p">{</span>
    <span class="kt">double</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span><span class="c1">//never change it yourself unless you dont need polar angle.
</span><span class="c1"></span>    <span class="kt">double</span> <span class="n">_polar</span><span class="p">;</span><span class="c1">// make cache to accumulate speed as atan is too slow.
</span><span class="c1"></span>
    <span class="n">Vec</span><span class="p">(){</span>
        <span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">Vec</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">,</span><span class="kt">double</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span><span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">){</span>
        <span class="n">_polar</span><span class="o">=</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="nf">dot</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="nf">cross</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="nf">len</span><span class="p">(){</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sqlen</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="nf">sqlen</span><span class="p">(){</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">Vec</span> <span class="nf">normalize</span><span class="p">(){</span>
        <span class="kt">double</span> <span class="n">l</span><span class="o">=</span><span class="n">len</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">Vec</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">l</span><span class="p">,</span><span class="n">y</span><span class="o">/</span><span class="n">l</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Vec</span> <span class="nf">rotate</span><span class="p">(</span><span class="kt">double</span> <span class="n">angle</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">Vec</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">Vec</span> <span class="k">operator</span> <span class="o">*</span> <span class="p">(</span><span class="kt">double</span> <span class="n">factor</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="nf">Vec</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">factor</span><span class="p">,</span><span class="n">y</span><span class="o">*</span><span class="n">factor</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="k">operator</span> <span class="o">*</span> <span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="nf">cross</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Vec</span> <span class="k">operator</span> <span class="o">-</span> <span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="nf">Vec</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Vec</span> <span class="k">operator</span> <span class="o">+</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="nf">Vec</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="nf">polar</span><span class="p">()</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">_polar</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="nf">leftby</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">sgn</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="nf">samed</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">sgn</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">sgn</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">polar</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">polar</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
		<span class="k">return</span> <span class="nf">sgn</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span><span class="n">sgn</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="n">ostream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">out</span><span class="p">,</span><span class="k">const</span> <span class="n">Vec</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
    <span class="n">out</span><span class="o">&lt;&lt;</span><span class="s">&#34;(&#34;</span><span class="o">&lt;&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="o">&lt;&lt;</span><span class="s">&#34;,&#34;</span><span class="o">&lt;&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="o">&lt;&lt;</span><span class="s">&#34;)&#34;</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">typedef</span> <span class="n">Vec</span> <span class="n">Point</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Line</span><span class="p">{</span>
    <span class="n">Point</span> <span class="n">pos</span><span class="p">;</span>
    <span class="n">Vec</span> <span class="n">dirc</span><span class="p">;</span>
    <span class="n">Line</span><span class="p">(</span><span class="n">Point</span> <span class="n">pos</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">Vec</span> <span class="n">dirc</span><span class="o">=</span><span class="n">Vec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">:</span><span class="n">pos</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span><span class="n">dirc</span><span class="p">(</span><span class="n">dirc</span><span class="p">){}</span>
    <span class="k">static</span> <span class="n">Line</span> <span class="nf">fromPoints</span><span class="p">(</span><span class="n">Point</span> <span class="n">a</span><span class="p">,</span><span class="n">Point</span> <span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">double</span> <span class="nf">getarea</span><span class="p">(</span><span class="k">const</span> <span class="n">Line</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">abs</span><span class="p">(</span><span class="n">dirc</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">dirc</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="c1">// è·å¾—å‚çº¿
</span><span class="c1"></span>    <span class="n">Line</span> <span class="nf">getppd</span><span class="p">(){</span>
        <span class="k">return</span> <span class="n">Line</span><span class="p">(</span><span class="n">pos</span><span class="o">+</span><span class="n">dirc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span><span class="n">dirc</span><span class="p">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">PI</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="c1">//TODO: what will happen if they have no intersection,-nan
</span><span class="c1"></span>    <span class="n">Point</span> <span class="nf">getintersection</span><span class="p">(</span><span class="k">const</span> <span class="n">Line</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="n">Vec</span> <span class="n">down</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">pos</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">pos</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">aa</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">dirc</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">down</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">bb</span><span class="o">=</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">dirc</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">dirc</span><span class="p">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">pos</span><span class="o">+</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">dirc</span><span class="o">*</span><span class="p">(</span><span class="n">aa</span><span class="o">/</span><span class="n">bb</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="nf">point_on_line</span><span class="p">(</span><span class="n">Point</span> <span class="n">point</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">dirc</span><span class="p">.</span><span class="n">samed</span><span class="p">(</span><span class="n">point</span><span class="o">-</span><span class="n">pos</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sgn</span><span class="p">((</span><span class="n">point</span><span class="o">-</span><span class="n">pos</span><span class="p">).</span><span class="n">sqlen</span><span class="p">()</span><span class="o">-</span><span class="n">dirc</span><span class="p">.</span><span class="n">sqlen</span><span class="p">())</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="nf">on_ver</span><span class="p">(</span><span class="n">Point</span> <span class="n">point</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sgn</span><span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">sgn</span><span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sgn</span><span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">pos</span><span class="p">.</span><span class="n">x</span><span class="o">+</span><span class="n">dirc</span><span class="p">.</span><span class="n">x</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">sgn</span><span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="n">pos</span><span class="p">.</span><span class="n">y</span><span class="o">+</span><span class="n">dirc</span><span class="p">.</span><span class="n">y</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">double</span> <span class="nf">get_distance</span><span class="p">(</span><span class="n">Point</span> <span class="n">point</span><span class="p">){</span>
        <span class="n">Line</span> <span class="n">ppd</span><span class="o">=</span><span class="n">getppd</span><span class="p">();</span>
        <span class="n">ppd</span><span class="p">.</span><span class="n">pos</span><span class="o">=</span><span class="n">point</span><span class="p">;</span>

        <span class="n">Point</span> <span class="n">intersection</span><span class="o">=</span><span class="n">getintersection</span><span class="p">(</span><span class="n">ppd</span><span class="p">);</span>

        <span class="n">ppd</span><span class="p">.</span><span class="n">dirc</span><span class="o">=</span><span class="n">intersection</span><span class="o">-</span><span class="n">point</span><span class="p">;</span>
        <span class="n">Vec</span> <span class="n">v</span><span class="o">=</span><span class="n">intersection</span><span class="o">-</span><span class="n">pos</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">point</span><span class="o">-</span><span class="n">pos</span><span class="p">)</span><span class="o">/</span><span class="n">v</span><span class="p">.</span><span class="n">len</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="kt">double</span> <span class="nf">get_distance</span><span class="p">(</span><span class="n">Line</span> <span class="n">line</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">get_distance</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">pos</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">Point</span> <span class="n">points</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="n">Line</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

<span class="kt">char</span> <span class="n">game</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">double</span> <span class="nf">get_area</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">points</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">){</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">points</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">points</span><span class="p">.</span><span class="n">end</span><span class="p">(),[](</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">polar</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">polar</span><span class="p">();</span>
    <span class="p">});</span>
    <span class="n">Point</span> <span class="n">base</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">Point</span> <span class="n">last</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kt">double</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">points</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Vec</span> <span class="n">a</span><span class="o">=</span><span class="n">last</span><span class="o">-</span><span class="n">base</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">base</span><span class="p">;</span>
        <span class="n">res</span><span class="o">+=</span><span class="n">a</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

        <span class="n">last</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="c1">//add the last point(also the first point)
</span><span class="c1"></span>    <span class="n">Vec</span> <span class="n">a</span><span class="o">=</span><span class="n">last</span><span class="o">-</span><span class="n">base</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">base</span><span class="p">;</span>
    <span class="n">res</span><span class="o">+=</span><span class="n">a</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">in_triangle</span><span class="p">(</span><span class="n">Point</span> <span class="n">p</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fuck</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Line</span><span class="o">::</span><span class="n">fromPoints</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">],</span><span class="n">points</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">]).</span><span class="n">point_on_line</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">double</span> <span class="n">areas</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">ps</span><span class="p">;</span>
        <span class="n">ps</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">]);</span>
        <span class="n">ps</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">points</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">]);</span>
        <span class="n">ps</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
        <span class="n">areas</span><span class="o">+=</span><span class="n">get_area</span><span class="p">(</span><span class="n">ps</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">ps</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">ps</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="k">return</span> <span class="n">sgn</span><span class="p">(</span><span class="n">areas</span><span class="o">-</span><span class="n">get_area</span><span class="p">(</span><span class="n">ps</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">has_intersetct</span><span class="p">(</span><span class="n">Line</span> <span class="n">line</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fuck</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> 
    <span class="n">Point</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
    <span class="kt">bool</span> <span class="n">flg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sgn</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">dirc</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">triangle</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">dirc</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">line</span><span class="p">.</span><span class="n">getintersection</span><span class="p">(</span><span class="n">triangle</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">point_on_line</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">||</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">line</span><span class="p">.</span><span class="n">pos</span><span class="p">)</span> <span class="n">flg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">in_triangle</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">pos</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">in_triangle</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">pos</span><span class="o">+</span><span class="n">line</span><span class="p">.</span><span class="n">dirc</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">Line</span> <span class="n">l</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="n">flg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">{</span>
		<span class="n">l</span><span class="o">=</span><span class="n">Line</span><span class="o">::</span><span class="n">fromPoints</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">in_triangle</span><span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">pos</span><span class="o">+</span><span class="n">l</span><span class="p">.</span><span class="n">dirc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="n">flg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">{</span>
		<span class="n">l</span><span class="o">=</span><span class="n">Line</span><span class="o">::</span><span class="n">fromPoints</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">in_triangle</span><span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">pos</span><span class="o">+</span><span class="n">l</span><span class="p">.</span><span class="n">dirc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="n">flg</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">{</span>
		<span class="n">l</span><span class="o">=</span><span class="n">Line</span><span class="o">::</span><span class="n">fromPoints</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">in_triangle</span><span class="p">(</span><span class="n">l</span><span class="p">.</span><span class="n">pos</span><span class="o">+</span><span class="n">l</span><span class="p">.</span><span class="n">dirc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="nc">v4q</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">step</span><span class="p">;</span>
    <span class="n">v4q</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">int</span> <span class="n">j</span><span class="p">,</span><span class="kt">int</span> <span class="n">step</span><span class="p">)</span><span class="o">:</span><span class="n">i</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">j</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">step</span><span class="p">(</span><span class="n">step</span><span class="p">){}</span>

    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">v4q</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">step</span><span class="o">&gt;</span><span class="n">other</span><span class="p">.</span><span class="n">step</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">dist</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">solve</span><span class="p">(){</span>
    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">v4q</span><span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span>
    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v4q</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dist</span><span class="p">));</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">vis</span><span class="p">));</span>
    <span class="n">dist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">pq</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
        <span class="n">v4q</span> <span class="n">cur</span><span class="o">=</span><span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span><span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

        <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="p">][</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="p">][</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="c1">//printf(&#34;now:%d %d\n&#34;,cur.i,cur.j);
</span><span class="c1"></span>        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">nlen</span><span class="p">,</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">nlen</span><span class="p">,</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">==</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="err">#</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;)</span><span class="k">continue</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">has_intersetct</span><span class="p">(</span><span class="n">Line</span><span class="o">::</span><span class="n">fromPoints</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Point</span><span class="p">(</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span><span class="k">continue</span><span class="p">;</span>
               <span class="c1">//cout&lt;&lt;&#34;arrive &#34;&lt;&lt;i&lt;&lt;&#34;,&#34;&lt;&lt;j;
</span><span class="c1"></span>                <span class="k">if</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="n">dist</span><span class="p">[</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="p">][</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
                    <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">dist</span><span class="p">[</span><span class="n">cur</span><span class="p">.</span><span class="n">i</span><span class="p">][</span><span class="n">cur</span><span class="p">.</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                    <span class="c1">//cout&lt;&lt;&#34; and update it to &#34;&lt;&lt;dist[i][j];
</span><span class="c1"></span>                    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v4q</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]));</span>
                <span class="p">}</span>
                <span class="c1">//cout&lt;&lt;endl;
</span><span class="c1"></span>            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">dist</span><span class="p">[</span><span class="n">nlen</span><span class="p">][</span><span class="n">nlen</span><span class="p">];</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
<span class="c1">//	freopen(&#34;in.txt&#34;,&#34;r&#34;,stdin);
</span><span class="c1">//	freopen(&#34;out.txt&#34;,&#34;w&#34;,stdout);
</span><span class="c1"></span>    <span class="k">while</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">){</span>
    	<span class="n">fuck</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">triangle</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Line</span><span class="o">::</span><span class="n">fromPoints</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">],</span><span class="n">points</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sgn</span><span class="p">(</span><span class="n">triangle</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">].</span><span class="n">dirc</span><span class="p">.</span><span class="n">cross</span><span class="p">(</span><span class="n">triangle</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">].</span><span class="n">dirc</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">fuck</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//solve triangle
</span><span class="c1"></span>        
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">in_triangle</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="err">#</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="cm">/*
</span><span class="cm">        for(int i=nlen;i&gt;=1;i--){
</span><span class="cm">            for(int j=1;j&lt;=nlen;j++){
</span><span class="cm">                cout&lt;&lt;game[i][j];
</span><span class="cm">            }
</span><span class="cm">            cout&lt;&lt;endl;
</span><span class="cm">        }
</span><span class="cm">        */</span>
        
        

        <span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="n">solve</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="o">!=</span><span class="mh">0x3f3f3f3f</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
        <span class="k">else</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;-1</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CCPC2017æ­å·] Heathrock</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/ccpc2017hangzhou-heathrock/" />
            <id>https://blog.kanari.moe/code/ccpc2017hangzhou-heathrock/</id>
            <updated>2020-04-08T20:50:16+08:00</updated>
            <published>2019-10-23T19:13:47+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>è¿™é¢˜æ„å¤ªé•¿äº†ï¼Œæˆ‘æ‡’å¾—å¤åˆ¶ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¢â€¦â€¦å…¶å®å°±æ˜¯çˆ†æœæ¨¡æ‹Ÿã€‚ä½†æ˜¯çŠ¶æ€æ¯”è¾ƒå¤šï¼Œéœ€è¦è®°åŒæ–¹ç”Ÿå‘½å€¼ï¼Œ3ä¸ªéšä»çš„ç”Ÿå‘½ï¼Œå½“å‰åœºæ•°ï¼Œé­”åŠ›ï¼Œä½“åŠ›ï¼Œä»¥åŠä¸€äº›ç„å­¦ä¼˜åŒ–ã€‚</p>
<ul>
<li>è‡ªé€‰ç›®æ ‡çš„ç‰Œä¸€å®šä¼šæ”¾åœ¨å›åˆçš„è¾ƒåå‡ºï¼Œå› ä¸ºå…¶ä¸ä¼šç´¯åŠ é­”åŠ›ã€‚</li>
<li>å¦‚æœå‰©ä¸‹çš„ç‰Œå…¨è¸¢è„¸ä¹Ÿè¸¢ä¸æ­»ï¼Œç›´æ¥è¿”å›ã€‚</li>
</ul>
<p>ä¹‹åå°±èƒ½è·‘å¾—é£å¿«ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>è¿™é¢˜æ„å¤ªé•¿äº†ï¼Œæˆ‘æ‡’å¾—å¤åˆ¶ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¢â€¦â€¦å…¶å®å°±æ˜¯çˆ†æœæ¨¡æ‹Ÿã€‚ä½†æ˜¯çŠ¶æ€æ¯”è¾ƒå¤šï¼Œéœ€è¦è®°åŒæ–¹ç”Ÿå‘½å€¼ï¼Œ3ä¸ªéšä»çš„ç”Ÿå‘½ï¼Œå½“å‰åœºæ•°ï¼Œé­”åŠ›ï¼Œä½“åŠ›ï¼Œä»¥åŠä¸€äº›ç„å­¦ä¼˜åŒ–ã€‚</p>
<ul>
<li>è‡ªé€‰ç›®æ ‡çš„ç‰Œä¸€å®šä¼šæ”¾åœ¨å›åˆçš„è¾ƒåå‡ºï¼Œå› ä¸ºå…¶ä¸ä¼šç´¯åŠ é­”åŠ›ã€‚</li>
<li>å¦‚æœå‰©ä¸‹çš„ç‰Œå…¨è¸¢è„¸ä¹Ÿè¸¢ä¸æ­»ï¼Œç›´æ¥è¿”å›ã€‚</li>
</ul>
<p>ä¹‹åå°±èƒ½è·‘å¾—é£å¿«ã€‚</p>
<p>{% asset_img &quot;1.png&quot; %}</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>ä¸€å¼€å§‹è¾“å‡ºäº†&quot;YES&quot;ï¼Œæ·¦ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Card</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">damage</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cost</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">power</span><span class="p">;</span>

    <span class="n">Card</span><span class="p">(){}</span>
    <span class="n">Card</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">,</span><span class="kt">int</span> <span class="n">damage</span><span class="p">,</span><span class="kt">int</span> <span class="n">cost</span><span class="p">,</span><span class="kt">int</span> <span class="n">power</span><span class="p">)</span><span class="o">:</span><span class="n">type</span><span class="p">(</span><span class="n">type</span><span class="p">),</span><span class="n">damage</span><span class="p">(</span><span class="n">damage</span><span class="p">),</span><span class="n">cost</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span><span class="n">power</span><span class="p">(</span><span class="n">power</span><span class="p">){}</span>
<span class="p">}</span> <span class="n">cards</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">used</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">md1</span><span class="p">,</span><span class="n">md2</span><span class="p">,</span><span class="n">md3</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">mx1</span><span class="p">,</span><span class="n">mx2</span><span class="p">,</span><span class="n">mx3</span><span class="p">;</span>

<span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans_cards</span><span class="p">,</span><span class="n">ans_target</span><span class="p">;</span>
<span class="kt">bool</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">stone</span><span class="p">,</span><span class="kt">int</span> <span class="n">power</span><span class="p">,</span><span class="kt">int</span> <span class="n">bl_me</span><span class="p">,</span><span class="kt">int</span> <span class="n">bl_en</span><span class="p">,</span><span class="kt">int</span> <span class="n">m1</span><span class="p">,</span><span class="kt">int</span> <span class="n">m2</span><span class="p">,</span><span class="kt">int</span> <span class="n">m3</span><span class="p">,</span><span class="kt">int</span> <span class="n">depth</span><span class="p">,</span><span class="kt">bool</span> <span class="n">nearend</span><span class="o">=</span><span class="nb">false</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">stone</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">depth</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">bl_en</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nb">true</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">depth</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">stone</span><span class="o">==</span><span class="mi">10</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m1</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">bl_me</span><span class="o">-=</span><span class="n">md1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">bl_me</span><span class="o">-=</span><span class="n">md2</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m3</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">bl_me</span><span class="o">-=</span><span class="n">md3</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">m1</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="n">m1</span><span class="o">=</span><span class="n">mx1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m2</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="n">m2</span><span class="o">=</span><span class="n">mx2</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">m3</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="n">m3</span><span class="o">=</span><span class="n">mx3</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">bl_me</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

    <span class="c1">//full attacking to owner cannot kill it.
</span><span class="c1"></span>    <span class="kt">int</span> <span class="n">fullattack</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">fakepower</span><span class="o">=</span><span class="n">power</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">unusd_lian</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">used</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">fakepower</span><span class="o">+=</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">power</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">unusd_lian</span><span class="o">++</span><span class="p">;</span>
        <span class="n">fullattack</span><span class="o">+=</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">damage</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fullattack</span><span class="o">+</span><span class="n">fakepower</span><span class="o">*</span><span class="p">(</span><span class="n">unusd_lian</span><span class="p">)</span><span class="o">&lt;</span><span class="n">bl_en</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">used</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">Card</span> <span class="o">&amp;</span><span class="n">card</span><span class="o">=</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">reald</span><span class="o">=</span><span class="n">card</span><span class="p">.</span><span class="n">damage</span><span class="o">+</span><span class="n">power</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;</span><span class="n">stone</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>

        <span class="n">used</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">nearend</span> <span class="o">&amp;&amp;</span> <span class="n">card</span><span class="p">.</span><span class="n">type</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span><span class="n">power</span><span class="o">+</span><span class="n">card</span><span class="p">.</span><span class="n">power</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">,</span><span class="n">m1</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">m2</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">m3</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">depth</span><span class="p">)){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">nearend</span> <span class="o">&amp;&amp;</span> <span class="n">card</span><span class="p">.</span><span class="n">type</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span><span class="n">power</span><span class="o">+</span><span class="n">card</span><span class="p">.</span><span class="n">power</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">m3</span><span class="p">,</span><span class="n">depth</span><span class="p">)){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">card</span><span class="p">.</span><span class="n">type</span><span class="o">==</span><span class="mi">3</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span><span class="n">power</span><span class="o">+</span><span class="n">card</span><span class="p">.</span><span class="n">power</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">m3</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="mi">1</span><span class="p">)){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="n">m1</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span><span class="n">power</span><span class="o">+</span><span class="n">card</span><span class="p">.</span><span class="n">power</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">,</span><span class="n">m1</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">m3</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="mi">1</span><span class="p">)){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="n">m2</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span><span class="n">power</span><span class="o">+</span><span class="n">card</span><span class="p">.</span><span class="n">power</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">m3</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="mi">1</span><span class="p">)){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="n">m3</span><span class="o">&gt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">dfs</span><span class="p">(</span><span class="n">stone</span><span class="o">-</span><span class="n">card</span><span class="p">.</span><span class="n">cost</span><span class="p">,</span><span class="n">power</span><span class="o">+</span><span class="n">card</span><span class="p">.</span><span class="n">power</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">m3</span><span class="o">-</span><span class="n">reald</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="mi">1</span><span class="p">)){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">used</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">dfs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">,</span><span class="n">m3</span><span class="p">,</span><span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)){</span>
        <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">mc1</span><span class="p">,</span><span class="n">mc2</span><span class="p">,</span><span class="n">mc3</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">used</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">used</span><span class="p">));</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">ans_cards</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="n">ans_cards</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">ans_target</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="n">ans_target</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>

        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">bl_me</span><span class="o">&gt;&gt;</span><span class="n">bl_en</span><span class="p">;</span>

        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">md1</span><span class="o">&gt;&gt;</span><span class="n">mc1</span><span class="o">&gt;&gt;</span><span class="n">mx1</span><span class="p">;</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">md2</span><span class="o">&gt;&gt;</span><span class="n">mc2</span><span class="o">&gt;&gt;</span><span class="n">mx2</span><span class="p">;</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">md3</span><span class="o">&gt;&gt;</span><span class="n">mc3</span><span class="o">&gt;&gt;</span><span class="n">mx3</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="o">=</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">damage</span><span class="o">=</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">power</span><span class="o">=</span><span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">type</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">type</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">type</span><span class="o">==</span><span class="mi">1</span> <span class="o">||</span> <span class="n">type</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
                <span class="kt">int</span> <span class="n">cost</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
                <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">cost</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">y</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span><span class="o">=</span><span class="n">type</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="o">=</span><span class="n">cost</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">damage</span><span class="o">=</span><span class="n">x</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">power</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="kt">int</span> <span class="n">cost</span><span class="p">,</span><span class="n">x</span><span class="p">;</span>
                <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">cost</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span><span class="o">=</span><span class="n">type</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">cost</span><span class="o">=</span><span class="n">cost</span><span class="p">;</span>
                <span class="n">cards</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">damage</span><span class="o">=</span><span class="n">x</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">ans_cards</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">ans_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dfs</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bl_me</span><span class="p">,</span><span class="n">bl_en</span><span class="p">,</span><span class="n">mc1</span><span class="p">,</span><span class="n">mc2</span><span class="p">,</span><span class="n">mc3</span><span class="p">,</span><span class="mi">0</span><span class="p">)){</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;Yes</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;No</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="kt">int</span> <span class="n">block</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">ans_cards</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
            <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pack_ans</span><span class="p">,</span><span class="n">pack_target</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">ans_cards</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">ans_cards</span><span class="p">.</span><span class="n">top</span><span class="p">()</span><span class="o">!=-</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">pack_ans</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ans_cards</span><span class="p">.</span><span class="n">top</span><span class="p">());</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="n">pack_target</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ans_target</span><span class="p">.</span><span class="n">top</span><span class="p">());</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">ans_cards</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
                <span class="n">ans_cards</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
                <span class="n">ans_target</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">if</span><span class="p">(</span><span class="n">pack_ans</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="k">continue</span><span class="p">;</span>

            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pack_ans</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">pack_ans</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pack_ans</span><span class="p">.</span><span class="n">front</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
                <span class="n">pack_ans</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
            <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">pack_target</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pack_target</span><span class="p">.</span><span class="n">front</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="p">;</span>
                <span class="n">pack_target</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
            <span class="n">block</span><span class="o">++</span><span class="p">;</span>            
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">block</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">){</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;0</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
            <span class="n">block</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E6%90%9C%E7%B4%A2/" term="æœç´¢" label="æœç´¢" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CCPC 2017] Master of Sequence</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/ccpc-2017-master-of-sequence/" />
            <id>https://blog.kanari.moe/code/ccpc-2017-master-of-sequence/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-21T15:37:14+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[ç»™å‡º2ä¸ªæ•°åˆ—ï¼Œ${a_i},{b_i}$.è¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œ ä¿®æ”¹æ•°åˆ—açš„ç¬¬iä¸ªä¸ºx ä¿®æ”¹â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ç»™å‡º2ä¸ªæ•°åˆ—ï¼Œ${a_i},{b_i}$.è¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œ</p>
<ol>
<li>ä¿®æ”¹æ•°åˆ—açš„ç¬¬iä¸ªä¸ºx</li>
<li>ä¿®æ”¹æ•°åˆ—bçš„ç¬¬iä¸ªä¸ºx</li>
<li>ç»™å‡ºkï¼Œæ±‚æœ€å°çš„tï¼Œæ»¡è¶³$\sum \lfloor \frac {t-b_i}{a_i} \rfloor \ge k$</li>
</ol>
<p>æ“ä½œæ•°ä¸å¤šäº100000ï¼Œæ“ä½œ3ä¸å¤šäº1000ï¼›æ•°åˆ—é•¿åº¦ä¸å¤šäº10000ï¼Œ<strong>açš„å€¼åŸŸä¸å¤§äº1000</strong>ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å°†$\lfloor \frac {t-b_i}{a_i} \rfloor$æ‹†å¼€ï¼Œè§‚å¯Ÿå‰åå¯èƒ½å‡ºç°çš„å·®ã€‚</p>
<div>$$
\lfloor \frac {t}{a_i} \rfloor - \lfloor \frac {b_i}{a_i} \rfloor
$$</div>
<p>è®¾$t=k_1a_i+c_1,b_i=k_2a_i+c_2$ï¼Œä»£å…¥è§‚å¯Ÿã€‚</p>
<div>$$
\begin{aligned}
\lfloor \frac {t-b_i}{a_i} \rfloor&=\lfloor \frac {(k_1-k_2)a_i+c_1-c_2}{a_i} \rfloor \\
\end{aligned}
$$</div>
<p>å¯ä»¥å‘ç°ï¼Œå½“æŠŠå¼å­æ‹†å¼€æ—¶ï¼Œæœ‰2ç§æƒ…å†µã€‚</p>
<ul>
<li>$c_1 &gt; c_2$ï¼Œå•¥äº‹æ²¡æœ‰ã€‚</li>
<li>$c_1 &lt; c_2$ï¼Œæ‹†å¼€åä¼šå¤šç»Ÿè®¡ä¸€ä¸ª1ã€‚</li>
</ul>
<p>äº‹å…ˆç»Ÿè®¡${b_i}$æ¨¡$a$çš„ä½™æ•°ï¼Œé‚£ä¹ˆæœ‰$t$åå°±èƒ½å¿«é€Ÿæ•°å‡ºç¬¬2ç§æƒ…å†µçš„æ•°é‡ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXA</span><span class="o">=</span><span class="mi">1010</span><span class="p">,</span><span class="n">MAXB</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span><span class="n">mlen</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXB</span><span class="p">],</span><span class="n">acnt</span><span class="p">[</span><span class="n">MAXA</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">b</span><span class="p">[</span><span class="n">MAXB</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">fts</span><span class="p">[</span><span class="n">MAXA</span><span class="p">][</span><span class="n">MAXA</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">pre</span><span class="p">[</span><span class="n">MAXA</span><span class="p">][</span><span class="n">MAXA</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">force</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">){</span>
	<span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">fts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">MAXA</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
		<span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">fts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="n">base</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="n">ll</span> <span class="n">k</span><span class="p">,</span><span class="n">ll</span> <span class="n">t</span><span class="p">){</span>
	<span class="n">ll</span> <span class="n">res</span><span class="o">=-</span><span class="n">base</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">1000</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">res</span><span class="o">+=</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">acnt</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="kt">int</span> <span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="o">%</span><span class="n">i</span><span class="p">;</span>
		<span class="n">ll</span> <span class="n">offset</span><span class="o">=</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1000</span><span class="p">]</span><span class="o">-</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>
		<span class="n">res</span><span class="o">-=</span><span class="n">offset</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span><span class="o">&gt;=</span><span class="n">k</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
	<span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">acnt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">acnt</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>
		<span class="n">base</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">fts</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">fts</span><span class="p">));</span>
		
		<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="o">&gt;&gt;</span><span class="n">mlen</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">acnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">fts</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
			<span class="n">base</span><span class="o">+=</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">1000</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="n">force</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
		<span class="p">}</span>

		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">mlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
			<span class="kt">int</span> <span class="n">opt</span><span class="p">;</span>
			<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">opt</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
				<span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
				<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">y</span><span class="p">;</span>

				<span class="n">acnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
				<span class="n">fts</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]][</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">%</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
				<span class="n">base</span><span class="o">-=</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
				<span class="n">force</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>

				<span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>
				<span class="n">fts</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]][</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">%</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
				<span class="n">acnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
				<span class="n">base</span><span class="o">+=</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
				<span class="n">force</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>

				
			<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
				<span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
				<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">y</span><span class="p">;</span>

				<span class="n">fts</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]][</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">%</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
				<span class="n">base</span><span class="o">-=</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
				<span class="n">force</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>

				<span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>

				<span class="n">fts</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]][</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">%</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
				<span class="n">force</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
				<span class="n">base</span><span class="o">+=</span><span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
			<span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">3</span><span class="p">){</span>
				<span class="kt">int</span> <span class="n">qk</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">qk</span><span class="p">;</span>
				<span class="n">ll</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mf">1e13</span><span class="p">;</span>
				<span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
					<span class="n">ll</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
					<span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">qk</span><span class="p">,</span><span class="n">mid</span><span class="p">)){</span>
						<span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
					<span class="p">}</span><span class="k">else</span> <span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">i</span><span class="o">=</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
					<span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">qk</span><span class="p">,</span><span class="n">i</span><span class="p">)){</span>
						<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CFEDU74 E] Keyboard Purchase</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cfedu74-e-keyboard-purchase/" />
            <id>https://blog.kanari.moe/code/cfedu74-e-keyboard-purchase/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-09T15:38:03+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>å½“åœ¨ä½¿ç”¨ä¸€æŒ‡ç¦…é”®å…¥ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½ éœ€è¦ä¸åœçš„ç§»åŠ¨æ‰‹æŒ‡ã€‚æ¯”å¦‚è¯´è¾“å…¥â€œafâ€ï¼Œæ‰‹æŒ‡éœ€è¦è·¨è¿‡3ä¸ªé”®ï¼ˆåŒ…æ‹¬ç»ˆç‚¹ï¼‰è¾“å…¥â€œaâ€å’Œâ€œfâ€ã€‚</p>
<p>é’ˆå¯¹ä¸€ä¸ªç»å¸¸è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥å®šåˆ¶ä¸€ä¸ªé•¿æ¡é”®ç›˜ï¼Œä½¿å¾—åœ¨è¿™ä¸ªé”®ç›˜ä¸Šè¾“å…¥å­—ç¬¦ä¸²éœ€è¦ç§»åŠ¨çš„è·ç¦»æœ€çŸ­ã€‚</p>
<p>ç»™å‡ºå­—ç¬¦ä¸²é•¿åº¦$n$ä¸å­—å…¸å¤§å°$k$ï¼ˆå°å†™å­—æ¯çš„å‰$k$ä¸ªï¼‰ï¼Œç»™å‡ºæœ€ä¼˜æƒ…å†µä¸‹æ‰‹æŒ‡éœ€è¦ç§»åŠ¨çš„è·ç¦»ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é“é¢˜å’Œä¹‹å‰é‚£é“marbleså¾ˆåƒâ€¦â€¦æˆ–è€…è¯´çŠ¶å‹éƒ½æŒºåƒçš„ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>å½“åœ¨ä½¿ç”¨ä¸€æŒ‡ç¦…é”®å…¥ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½ éœ€è¦ä¸åœçš„ç§»åŠ¨æ‰‹æŒ‡ã€‚æ¯”å¦‚è¯´è¾“å…¥â€œafâ€ï¼Œæ‰‹æŒ‡éœ€è¦è·¨è¿‡3ä¸ªé”®ï¼ˆåŒ…æ‹¬ç»ˆç‚¹ï¼‰è¾“å…¥â€œaâ€å’Œâ€œfâ€ã€‚</p>
<p>é’ˆå¯¹ä¸€ä¸ªç»å¸¸è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥å®šåˆ¶ä¸€ä¸ªé•¿æ¡é”®ç›˜ï¼Œä½¿å¾—åœ¨è¿™ä¸ªé”®ç›˜ä¸Šè¾“å…¥å­—ç¬¦ä¸²éœ€è¦ç§»åŠ¨çš„è·ç¦»æœ€çŸ­ã€‚</p>
<p>ç»™å‡ºå­—ç¬¦ä¸²é•¿åº¦$n$ä¸å­—å…¸å¤§å°$k$ï¼ˆå°å†™å­—æ¯çš„å‰$k$ä¸ªï¼‰ï¼Œç»™å‡ºæœ€ä¼˜æƒ…å†µä¸‹æ‰‹æŒ‡éœ€è¦ç§»åŠ¨çš„è·ç¦»ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é“é¢˜å’Œä¹‹å‰é‚£é“marbleså¾ˆåƒâ€¦â€¦æˆ–è€…è¯´çŠ¶å‹éƒ½æŒºåƒçš„ã€‚</p>
<p>é¢˜ç›®å³ä¾æ¬¡å†³å®šé”®ç›˜çš„ä¸‹ä¸€ä¸ªæŒ‰é”®è£…å•¥ï¼Œå¹¶åœ¨åŸå­—ç¬¦ä¸²é‡Œè®¡ç®—éœ€è¦ç§»åŠ¨çš„æ¬¡æ•°ã€‚è®¾$f(S)$è¡¨ç¤ºå·²ç»è€ƒè™‘äº†é›†åˆ$S$é‡Œæ‰€æœ‰çš„æŒ‰é”®ã€‚ä¸è¿‡ä»”ç»†æ€è€ƒä¸€ä¸‹å‘ç°è¿™ä¸ªä»£ä»·éœ€è¦çŸ¥é“å…ˆå‰å®‰è£…çš„æŒ‰é”®çš„é¡ºåºï¼Œè€Œè¿™ä¸ªé¡ºåºæ˜¾ç„¶ä¸èƒ½åŠ å…¥åˆ°çŠ¶æ€é‡Œï¼Œè¿™æ˜¯æ— æ³•æ¥å—çš„ã€‚å¿…é¡»è¦é€šè¿‡åˆ«çš„æ–¹å¼æ¥è®¡ç®—ã€‚</p>
<p>ç„¶åæˆ‘åˆå¡äº†ã€‚</p>
<p>è¿™æ˜¯æ²¡è§è¿‡çš„è½¬ç§»æ–¹å¼â€¦â€¦è€ƒè™‘æœ¬è½®æ²¡æœ‰æ’å…¥é”®Aï¼Œé‚£ä¹ˆä¸€å®šå°±<strong>æ’å…¥äº†åˆ«çš„é”®B</strong>ï¼Œé‚£ä¹ˆï¼Œè¿™æ¬¡å¯¹äºäº‹ä»¶â€œæ’Aâ€çš„<strong>ä¸€æ¬¡delay</strong>ä¼šå¯¼è‡´åŸä¸²é‡ŒAå’Œç›¸é‚»<strong>åœ¨é”®ç›˜ä¸Šå·²ç¡®å®šä½ç½®çš„</strong>å­—æ¯é—´çš„è½¬ç§»å¤š<strong>ä¸€ä¸ª</strong>ä»£ä»·ã€‚</p>
<p>æœ‰ç§æ¨¡ç³Šçš„æ„Ÿè§‰ã€‚ä¹‹å‰é‚£ä¸ªé¢˜ç›®æ˜¯è®¡ç®—å½“å‰å…ƒç´ å’Œå·²æœ‰å…ƒç´ ä¹‹é—´çš„ä»£ä»·ï¼›è¿™ä¸ªæ˜¯è®¡ç®—å·²æœ‰å…ƒç´ å’Œæœªæœ‰å…ƒç´ ä¹‹é—´çš„ç´¯è¿›å¼ä»£ä»·ã€‚æä¸å¤ªæ¸…æ¥šè¿™ä¸ª$f(S)$ç°åœ¨ä»£è¡¨çš„æ˜¯ä»€ä¹ˆäº†â€¦ä¸çŸ¥å¯å¦æœ‰äººæŒ‡å¯¼ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXK</span><span class="o">=</span><span class="mi">21</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span><span class="n">klen</span><span class="p">;</span>
<span class="n">string</span> <span class="n">inp</span><span class="p">;</span>
 
<span class="kt">int</span> <span class="n">cost</span><span class="p">[</span><span class="n">MAXK</span><span class="p">][</span><span class="n">MAXK</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">20</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="o">&gt;&gt;</span><span class="n">klen</span><span class="p">;</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">inp</span><span class="p">;</span>
 
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cost</span><span class="p">[</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;][</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">cost</span><span class="p">[</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;][</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="n">a</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
 
 
    <span class="n">memset</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dp</span><span class="p">));</span>
    <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
 
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">klen</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">scost</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">klen</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="n">j</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span><span class="k">continue</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">klen</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">((</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="n">k</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
                <span class="n">scost</span><span class="o">+=</span><span class="n">cost</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">klen</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">((</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="n">j</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">)]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">)],</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">scost</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
 
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">dp</span><span class="p">[(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">klen</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
 
    
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF EDU72D] Coloring Edges</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf-edu72d-coloring-edges/" />
            <id>https://blog.kanari.moe/code/cf-edu72d-coloring-edges/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-06T18:49:19+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[You are given a directed graph with n vertices and m directed edges without self-loops or multiple edges. Let's denote the k-coloring of a digraph as following: you color each edge in one of k colors. The k-coloring is good if andâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>You are given a directed graph with n vertices and m directed edges without self-loops or multiple edges.</p>
<p>Let's denote the k-coloring of a digraph as following: you color each edge in one of k colors. The k-coloring is good if and only if there no cycle formed by edges of same color.</p>
<p>Find a good k-coloring of given digraph with minimum possible k.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å¯¹æˆ‘è¿™ä¸ªèœé¸¡æ¥è¯´ï¼Œå»æŸ“è‰²è¿”ç¥–è¾¹çš„æ“ä½œå¹¶ä¸æ€ä¹ˆæ˜¾ç„¶â€¦â€¦ç®—äº†â€¦â€¦</p>
<p>æ²¡èƒ½åšæŒåªæœ‰2ç§é¢œè‰²çš„çŒœæƒ³ã€‚æŒ‚åŸå¢™ã€‚</p>
<p>æ²¡å¿…è¦æŒ‚ä»£ç ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF585E] Marbles</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf585e-marbles/" />
            <id>https://blog.kanari.moe/code/cf585e-marbles/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-05T22:18:45+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Monocarp has arranged n colored marbles in a row. The color of the i-th marble is ai. Monocarp likes ordered things, so he wants to rearrange marbles in such a way that all marbles of the same color form a contiguos segmentâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Monocarp has arranged n colored marbles in a row. The color of the i-th marble is ai. Monocarp likes ordered things, so he wants to rearrange marbles in such a way that all marbles of the same color form a contiguos segment (and there is only one such segment for each color).</p>
<p>In other words, Monocarp wants to rearrange marbles so that, for every color j, if the leftmost marble of color j is l-th in the row, and the rightmost marble of this color has position r in the row, then every marble from l to r has color j.</p>
<p>To achieve his goal, Monocarp can do the following operation any number of times: choose two neighbouring marbles, and swap them.</p>
<p>You have to calculate the minimum number of operations Monocarp has to perform to rearrange the marbles. Note that the order of segments of marbles having equal color does not matter, it is only required that, for every color, all the marbles of this color form exactly one contiguous segment.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é“é¢˜çš„ç¿»è¯‘å°±æ˜¯â€œé‡æ–°ç¡®å®šæ¯ä¸ªé¢œè‰²çš„æƒå€¼ï¼Œä½¿å¾—é€†åºå¯¹æœ€å°‘â€ã€‚</p>
<p>ç„¶åæˆ‘å°±å¡äº†ï¼Œç°åœ¨æˆ‘ä¹Ÿä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šä¸ºå•¥å¯ä»¥dpï¼Œåªæ˜¯çŸ¥é“èƒ½dpã€‚</p>
<p>é€‰æ‹©çŠ¶æ€$f(S)$è¡¨ç¤ºé›†åˆ$S$å·²ç»å…¨éƒ¨åˆ†é…æƒå€¼æ—¶äº§ç”Ÿçš„æœ€å°‘é€†åºå¯¹ã€‚æšä¸¾ä¸‹ä¸€ä¸ªé¢œè‰²ï¼Œç»™äºˆä¸‹ä¸€ä¸ªï¼ˆè¾ƒå°ï¼‰æƒå€¼ï¼Œå¹¶è®¡ç®—ä»£ä»·ã€‚</p>
<div>$$
f(S+\{i\})=min\{f(S)+w\}
$$</div>
<p>æ¥ä¸‹æ¥æ˜¯wçš„å¤„ç†ã€‚æˆ‘ä»¬éœ€è¦çš„æ˜¯åœ¨å½“å‰é¢œè‰²çš„æ‰€æœ‰ç‚¹å‰çš„<strong>å·²ç»æ‹¥æœ‰æ–°æƒå€¼</strong>çš„ç‚¹æ•°ç›®ï¼Œè¿™å¯ä»¥äº‹å…ˆé¢„å¤„ç†ã€‚é¢„å¤„ç†é¢œè‰²iå‰é¢œè‰²jçš„pairæ•°å³å¯ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>ä¸å°å¿ƒæŠŠptræ‰”åˆ°äº†é‡Œå±‚å¾ªç¯é‡ŒTäº†å‘â€¦</p>
<p>æ˜æ˜ç¬¬ä¸€æ­¥å®Œäº‹éƒ½å¾ˆç›´ç™½äº†ï¼Œå°±æ˜¯éå¾—è¢«å¡ä¸€ä¸‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iomanip&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stack&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">400010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXC</span><span class="o">=</span><span class="mi">21</span><span class="p">;</span>
 
<span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pos</span><span class="p">[</span><span class="n">MAXC</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">cnt</span><span class="p">[</span><span class="n">MAXC</span><span class="p">][</span><span class="n">MAXC</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">tick</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">newColor</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
 
<span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">MAXC</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
 
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">newColor</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">newColor</span><span class="p">));</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">newColor</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="n">newColor</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">tick</span><span class="o">++</span><span class="p">;</span>
        <span class="n">pos</span><span class="p">[</span><span class="n">newColor</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]]].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
 
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">tick</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">tick</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="n">j</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">ptr</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">while</span><span class="p">(</span><span class="n">ptr</span><span class="o">&lt;</span><span class="n">pos</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">pos</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">ptr</span><span class="p">]</span><span class="o">&lt;</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">])</span><span class="n">ptr</span><span class="o">++</span><span class="p">;</span>
                <span class="n">ptr</span><span class="o">--</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ptr</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">pos</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">ptr</span><span class="p">]</span><span class="o">&lt;</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]){</span>
                    <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
 
 
    <span class="n">memset</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span><span class="mh">0x3f</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dp</span><span class="p">));</span>
    <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">tick</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">tick</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">((</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="n">j</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">ll</span> <span class="n">diff</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">tick</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">((</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="n">k</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">diff</span><span class="o">+=</span><span class="n">cnt</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">)]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">)],</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">diff</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
 
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">dp</span><span class="p">[(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">tick</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF585D] Ticket Game</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf585d-ticket-game/" />
            <id>https://blog.kanari.moe/code/cf585d-ticket-game/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-05T15:13:52+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Monocarp and Bicarp live in Berland, where every bus ticket consists of n digits (n is an even number). During the evening walk Monocarp and Bicarp found a ticket where some of the digits have been erased. The number of digits thatâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Monocarp and Bicarp live in Berland, where every bus ticket consists of n digits (n is an even number). During the evening walk Monocarp and Bicarp found a ticket where some of the digits have been erased. The number of digits that have been erased is even.</p>
<p>Monocarp and Bicarp have decided to play a game with this ticket. Monocarp hates happy tickets, while Bicarp collects them. A ticket is considered happy if the sum of the first $\frac n2$ digits of this ticket is equal to the sum of the last $\frac n2$ digits.</p>
<p>Monocarp and Bicarp take turns (and Monocarp performs the first of them). During each turn, the current player must replace any erased digit with any digit from 0 to 9. The game ends when there are no erased digits in the ticket.</p>
<p>If the ticket is happy after all erased digits are replaced with decimal digits, then Bicarp wins. Otherwise, Monocarp wins. You have to determine who will win if both players play optimally.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>åœ¨åšè¿™é“é¢˜çš„æ—¶å€™ï¼Œæˆ‘å‘ç°äº†å®é™…ä¸Šå½±å“ç­”æ¡ˆçš„åªå’Œä¸¤è¾¹çš„ å·²çŸ¥æ•°çš„å’Œ ä»¥åŠæœªçŸ¥ä½çš„æ•°ç›®æœ‰å…³ï¼Œå‘ç°äº†è·èƒœçš„æ ¹æœ¬æ˜¯å‰åä¸¤éƒ¨åˆ†å’Œçš„å·®å€¼å¤§å°ï¼Œå‘ç°äº†å…ˆæ‰‹çš„ç›®çš„æ˜¯<strong>æ‰©å¤§å·®å€¼</strong>ä½¿å¾—åæ‰‹æ— æ³•é€šè¿‡æŸç§æ–¹å¼è¿½èµ¶ã€‚</p>
<p>ä½†æ˜¯åˆ°è¿™æˆ‘å°±å¡ä½äº†ã€‚æ·¦ï¼Œä¸ºä»€ä¹ˆæˆ‘è¿™ä¹ˆèœã€‚</p>
<p>æ¥ä¸‹æ¥è¦è€ƒè™‘çš„æ˜¯<strong>ä¼˜åŠ¿</strong>ï¼Œåœ¨è¿™é“é¢˜é‡Œä¼˜åŠ¿å°±æ˜¯å·®å€¼ã€‚å…ˆæ‰‹çš„ç›®çš„æ˜¯æ‰©å¤§ä¼˜åŠ¿ï¼Œåœ¨å¤§çš„ä¸€è¾¹å¢å¤§ä¼šåŠ å¤§ä¼˜åŠ¿ï¼Œè€Œåœ¨å°çš„ä¸€è¾¹ç½®0ä¸ä¼šæ‰©å¤§ä¼˜åŠ¿ï¼›åæ‰‹è¦<strong>å‡å°ä¼˜åŠ¿</strong>ï¼ŒåŒæ ·çš„åŠæ³•å°±æ˜¯åœ¨å°çš„ä¸€ä¾§ç½®æ•°æ¥è¿½èµ¶å¦ä¸€ä¾§ï¼Œåœ¨å¤§çš„ä¸€ä¾§ç½®0ä¸ä¼šæ›´å¥½ã€‚</p>
<p>é‚£ä¹ˆï¼Œåˆå¯ä»¥å¾—å‡ºå…ˆæ‰‹æ‰©å¤§ä¼˜åŠ¿æœ€å¥½çš„åŠæ³•æ˜¯ç½®9ï¼ˆæœ€å¤§ï¼‰ã€‚é‚£ä¹ˆæ¸¸æˆæœ€å¼€å§‹çš„å‡ æ­¥ï¼Œå°±æ˜¯åŒæ–¹åœ¨ä¸¤ä¾§å¡«å†™9ã€‚ç›´åˆ°æŸä¾§ä¸å†æœ‰ç©ºä½ã€‚</p>
<p>æ­¤æ—¶ï¼Œå¦‚æœç©ºä½åœ¨å¤§çš„ä¸€ä¾§ï¼Œå…ˆæ‰‹å¿…èµ¢ã€‚å¦‚æœç©ºä½åœ¨å°çš„ä¸€ä¾§ï¼Œç»§ç»­è®¨è®ºå¦‚ä¸‹</p>
<div>$$
x_1+x_2+\cdots+x_n=C
$$</div>
<p>é¦–å…ˆ$2|n$æ˜¾ç„¶ã€‚</p>
<p>å½“Cä¸æ˜¯9çš„å€æ•°æ—¶ï¼Œå…ˆæ‰‹æ€»æœ‰åŠæ³•è®©æœ€ç»ˆç»“æœåç¦»ã€‚å› æ­¤è¯¥æƒ…å†µåªæœ‰å½“$\frac n2 \times 9 = n$æ—¶åæ‰‹æ‰èƒ½è·èƒœã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>å«–äº†é˜Ÿå‹çš„â€¦æˆ‘çxxæçš„ç»“è®ºWA23äº†â€¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span><span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">200005</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="o">?&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;)</span> <span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
		<span class="k">else</span> <span class="n">sum</span><span class="o">+=</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;;</span>
	<span class="p">}</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="o">?&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;)</span> <span class="n">cnt</span><span class="o">--</span><span class="p">;</span>
		<span class="k">else</span> <span class="n">sum</span><span class="o">-=</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;;</span>
	<span class="p">}</span>
	<span class="c1">//cout&lt;&lt;cnt&lt;&lt;&#34; &#34;&lt;&lt;sum&lt;&lt;endl;
</span><span class="c1"></span>	<span class="k">if</span><span class="p">(</span><span class="n">sum</span><span class="o">*</span><span class="mi">2</span><span class="o">==-</span><span class="n">cnt</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span> <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Bicarp&#34;</span><span class="p">);</span>
	<span class="k">else</span> <span class="n">puts</span><span class="p">(</span><span class="s">&#34;Monocarp&#34;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">åç¼€è‡ªåŠ¨æœº</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/sam/" />
            <id>https://blog.kanari.moe/study/sam/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-10-04T20:44:30+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[å¦‚ä½ æ‰€è§ï¼Œåç¼€è‡ªåŠ¨æœºã€‚ ç„¶è€Œå°±nmçœ‹ä¸æ‡‚ï¼Œå…ˆçœ‹ä¸æ‡‚å®ƒçš„å›¾æ˜¯å•¥ï¼Œåˆçœ‹ä¸æ‡‚å®ƒçš„è¾¹æ˜¯å•¥ï¼Œç°åœ¨â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>å¦‚ä½ æ‰€è§ï¼Œåç¼€è‡ªåŠ¨æœºã€‚</p>
<blockquote>
<p>ç„¶è€Œå°±nmçœ‹ä¸æ‡‚ï¼Œå…ˆçœ‹ä¸æ‡‚å®ƒçš„å›¾æ˜¯å•¥ï¼Œåˆçœ‹ä¸æ‡‚å®ƒçš„è¾¹æ˜¯å•¥ï¼Œç°åœ¨è¿˜æ˜¯çœ‹ä¸æ‡‚å®ƒçš„è¾¹æ˜¯å’‹æ‰¾å‡ºæ¥çš„ã€‚å¯æ˜¯å’±ä¸æƒ³æä¸æ¸…æ¥šå®ƒæ˜¯å¹²å˜›çš„å°±ç›´æ¥ç”¨å•Šé ã€‚</p>
</blockquote>
<p>åç¼€è‡ªåŠ¨æœºé¦–å…ˆæ˜¯è‡ªåŠ¨æœºã€‚ä¸€ä¸ªå­—ç¬¦ä¸²Sçš„åç¼€è‡ªåŠ¨æœºèƒ½æ¥å—Sçš„æ‰€æœ‰åç¼€ã€‚åŸºäºå®ƒçš„è¿™ä¸ªæ€§è´¨ï¼Œå®ƒèƒ½å¤Ÿåšåˆ°ï¼š</p>
<ul>
<li>æŸ¥è¯¢å­ä¸²æ˜¯å¦å‡ºç°ï¼šè¿™æ˜¾ç„¶è·‘ä¸€æ¬¡ï¼Œèƒ½åœ¨è‡ªåŠ¨æœºä¸Šè·‘å®Œå°±æ˜¯å‡ºç°è¿‡ã€‚</li>
<li>ç»Ÿè®¡ä¸åŒå­ä¸²çš„æ•°é‡ï¼šè‡ªåŠ¨æœºä¸Šæ¯æ¡ä¸åŒçš„è·¯å¾„å¯¹åº”ä¸€ä¸ªä¸åŒçš„å­ä¸²ã€‚å®šä¹‰$d(x)$ä¸ºä»¥xä¸ºèµ·ç‚¹çš„è·¯å¾„æ•°ç›®ï¼Œé€’æ¨å³å¯ã€‚</li>
<li>è®¡ç®—æ‰€æœ‰ä¸åŒå­ä¸²çš„é•¿åº¦æ€»å’Œï¼šå¾—åˆ°ä¸Šé¢çš„$d$ã€‚ä»¥xä¸ºèµ·ç‚¹ï¼Œæ¯æ¡è·¯å¾„éƒ½ä¼šè®©å­ä¸²<strong>æ€»</strong>é•¿åº¦å¢åŠ <strong>è·¯å¾„ä¸ª</strong>ã€‚ä¾ç„¶æ˜¯é€’æ¨ã€‚</li>
<li>å­—å…¸åºç¬¬kå°å­ä¸²ï¼šå½“ä½ æœ‰è·¯å¾„æ•°äº†ï¼Œåªéœ€è¦æŒ‰ç…§å­—å…¸åºå¯¹èŠ‚ç‚¹æ’åºï¼Œç„¶ååƒç¼–ç ä¸€æ ·æ‰¾ã€‚</li>
<li>æœ€å°å¾ªç¯ç§»ä½ï¼šæŒ‡å°†åŸå­—ç¬¦ä¸²é¦–å°¾ç›¸æ¥ç§»ä½ï¼Œæ‰¾åˆ°å­—å…¸åºæœ€å°çš„ä¸€ä¸ªã€‚å°†å­—ç¬¦ä¸²$S$æ–­ç¯æˆé“¾$SS$ï¼Œç„¶åå»ºç«‹SAMï¼Œè´ªå¿ƒæ‰¾æœ€å°ç›´åˆ°é•¿åº¦è¾¾åˆ°$|S|$å³å¯ã€‚</li>
<li>å¤šç»„å­ä¸²å‡ºç°æ¬¡æ•°ï¼šdfsé¢„å¤„ç†æ¯ä¸ªèŠ‚ç‚¹çš„ç»ˆç‚¹é›†åˆå¤§å°ã€‚åœ¨è‡ªåŠ¨æœºä¸ŠæŸ¥æ‰¾ä¸²$P$å¯¹åº”çš„èŠ‚ç‚¹,å­˜åœ¨åˆ™ç­”æ¡ˆä¸ºè¯¥èŠ‚ç‚¹çš„ç»ˆç‚¹é›†åˆå¤§å°ï¼›ä¸å­˜åœ¨ç­”æ¡ˆä¸º$0$.</li>
<li>æ‰€æœ‰å‡ºç°ä½ç½®ï¼šéå†æ ‘ï¼Œä¸€æ—¦å‘ç°ç»ˆç‚¹ç›´æ¥è¾“å‡ºã€‚</li>
</ul>
<h2 id="å»ºç«‹">å»ºç«‹</h2>
<p>æœ€æš´åŠ›çš„æ–¹å¼æ˜¯å»ºç«‹ä¸€ä¸ªO(n^2)çº§åˆ«çš„è‡ªåŠ¨æœºï¼Œä¸è¿‡é‚£ä¸ªå¤æ‚åº¦å°±æ²¡ä»€ä¹ˆæ„ä¹‰äº†ã€‚åç¼€è‡ªåŠ¨æœºéœ€è¦æ»¡è¶³çŠ¶æ€æ•°æœ€å°‘ï¼Œä¸ºçº¿æ€§çº§åˆ«ï¼Œä¸”è½¬ç§»ï¼ˆè¾¹ï¼‰ä¹Ÿä¸ºçº¿æ€§çº§åˆ«ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æŠ˜è…¾äº†ã€‚</p>
<p>å®šä¹‰ä¸²Sçš„$endpos(x)$ä¸ºä¸€ä¸ªé›†åˆï¼Œå…ƒç´ ä¸ºxåœ¨å…¶å†…å‡ºç°çš„æ‰€æœ‰ä½ç½®çš„ç»“å°¾ä¸‹æ ‡ã€‚</p>
<h2 id="èµ„æ–™">èµ„æ–™</h2>
<ul>
<li><a href="https://saisumit.wordpress.com/2016/01/26/suffix-automaton/">å‚è€ƒèµ„æ–™</a></li>
<li>2015å¹´å›½å®¶é›†è®­é˜Ÿè®ºæ–‡</li>
</ul>
<h3 id="å­ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®">å­ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</h3>
<p>å¯¹SAMä¸­æ‰€æœ‰çŠ¶æ€é¢„å¤„ç†firstposï¼ˆç¬¬ä¸€æ¬¡å‡ºç°è¯¥çŠ¶æ€çš„æœ«ç«¯ä½ç½®ï¼Œä¹Ÿå°±æ˜¯endposé›†åˆçš„æœ€å°å…ƒç´ ï¼‰ã€‚</p>
<p>æ‰©å±•æºå‡½æ•°ä¸º<code>sam_extend()</code>ã€‚åˆ›å»ºæ–°çŠ¶æ€<code>cur</code>æ—¶ï¼Œä»¤</p>
<div>$$
firstpos(cur)=len(cur)-1
$$</div>
<p>å½“<code>q</code>å¤åˆ¶åˆ°<code>clone</code>æ—¶ï¼Œä»¤</p>
<div>$$
firstpos(clone)=firstpos(q)
$$</div>
<p>éœ€è¦çš„ç­”æ¡ˆå°±æ˜¯$firstpos(t)-|P|+1$ï¼Œ$t$ä¸ºå­—ç¬¦ä¸²$P$çš„çŠ¶æ€ã€‚æ¯æ¬¡æŸ¥è¯¢éœ€è¦$O(|P|)$</p>
<h3 id="æœ€çŸ­æœªå‡ºç°å­—ç¬¦ä¸²">æœ€çŸ­æœªå‡ºç°å­—ç¬¦ä¸²</h3>
<p>åŠ¨æ€è§„åˆ’ã€‚</p>
<p>è®©$d_v$ä¸ºèŠ‚ç‚¹$v$çš„ç­”æ¡ˆã€‚å¦‚æœä¸å­˜åœ¨ä½¿ç”¨å­—ç¬¦é›†ä¸­è‡³å°‘ä¸€ä¸ªå­—ç¬¦çš„è½¬ç§»ï¼Œé‚£ä¹ˆ$d_v=1$ï¼Œå¦åˆ™</p>
<div>$$
d_v=1+\min_{w:(v,w,c) \in SAM} d_w
$$</div>
<p>å­—ç¬¦ä¸²å¯ä»¥ç”±è½¬ç§»æ¨å›å»ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF589C] primes and multiplication</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf589c-primes-and-multiplication/" />
            <id>https://blog.kanari.moe/code/cf589c-primes-and-multiplication/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-09-30T09:04:32+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[è®¾$primes(x)$ä¸ºxçš„è´¨å› æ•°çš„é›†åˆã€‚ è®¾$g(x,p)$è¡¨ç¤ºå¯ä»¥æ•´é™¤xçš„æœ€å¤§çš„â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>è®¾$primes(x)$ä¸ºxçš„è´¨å› æ•°çš„é›†åˆã€‚</p>
<p>è®¾$g(x,p)$è¡¨ç¤ºå¯ä»¥æ•´é™¤xçš„æœ€å¤§çš„$p^k$ã€‚</p>
<p>è®¾$f(x,y)$è¡¨ç¤ºå°†xä½œåˆ†è§£åå¯¹æ¯ä¸ªè´¨å› å­ä½œç”¨åˆ°1åˆ°yä¸Šæ±‚$g$çš„ä¹˜ç§¯ã€‚</p>
<p>æ±‚$f(x,n)$</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>â€¦â€¦æœ€åä½ ä¼šå‘ç°ï¼Œè¿™é¢˜å°±æ˜¯æ±‚é˜¶ä¹˜è´¨å› å­çš„ä¹˜ç§¯ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1010</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">P</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>
 
<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>
 
<span class="kt">void</span> <span class="nf">unpack</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">b</span><span class="o">=</span><span class="n">x</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="n">x</span><span class="o">/=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="mi">1</span><span class="p">)</span><span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">get</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">ll</span> <span class="n">num</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="p">){</span>
        <span class="n">res</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="o">+</span><span class="n">n</span><span class="o">/</span><span class="n">num</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">n</span><span class="o">/=</span><span class="n">num</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
    <span class="n">unpack</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
 
    <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="nl">item</span><span class="p">:</span><span class="n">primes</span><span class="p">){</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">*</span><span class="n">qpow</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">item</span><span class="p">),</span><span class="n">P</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">%</span><span class="n">P</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CCPC2019 ç§¦çš‡å²›] Angel Beats</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/ccpc2019-qinhuangdao-angel-beats/" />
            <id>https://blog.kanari.moe/code/ccpc2019-qinhuangdao-angel-beats/</id>
            <updated>2020-04-08T20:50:43+08:00</updated>
            <published>2019-09-29T21:02:19+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[ç»™å‡ºä¸€äº›ç‚¹ï¼Œè¯¢é—®å¯¹äºç‚¹$(x,y)$ï¼Œæ±‚å…¶èƒ½å’Œå·²çŸ¥ç‚¹å½¢æˆå¤šå°‘ä¸ªç›´è§’ä¸‰è§’å½¢ã€‚ åˆ†æ é¦–å…ˆï¼Œâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ç»™å‡ºä¸€äº›ç‚¹ï¼Œè¯¢é—®å¯¹äºç‚¹$(x,y)$ï¼Œæ±‚å…¶èƒ½å’Œå·²çŸ¥ç‚¹å½¢æˆå¤šå°‘ä¸ªç›´è§’ä¸‰è§’å½¢ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¦–å…ˆï¼Œå¯¹äºè¯¢é—®çš„ç‚¹ï¼Œç›´æ¥åŠ å…¥é›†åˆç¦»çº¿æ“ä½œå°±å¯ä»¥ã€‚è¿™é“é¢˜å°±å˜æˆäº†å•çº¯çš„æ±‚ä¸‰è§’å½¢ã€‚ä¸€å¼€å§‹æˆ‘è·Ÿæ±‚é”è§’ä¸‰è§’å½¢é‚£é“é¢˜ä¸€æ ·åšï¼Œç„¶åå†™å¾—åˆæ¶å¿ƒåˆä¸çŸ¥é“å“ªé‡Œå‡ºäº†bugæ”¹ä¸å‡ºæ¥ã€‚</p>
<p>åæ¥ï¼Œå®é™…ä¸Šå¯ä»¥äº‹å…ˆç›´æ¥æšä¸¾2ç‚¹æŒ‰ç…§æ–œç‡ç»Ÿè®¡è¾¹æ•°ï¼Œå¯¹æ¯ä¸ªæŸ¥è¯¢$lg(n^2)$æŸ¥è¯¢ï¼Œä¼šçœå¾ˆå¤šäº‹ã€‚</p>
<p>ä¹‹åçš„å°±æ˜¯å¾ˆæ˜¾ç„¶çš„ï¼šæŸ¥è¯¢ç‚¹ä½œä¸ºç›´è§’æ‰«ä¸€éï¼ŒæŸ¥è¯¢ç‚¹ä½œä¸ºéç›´è§’æ‰«ä¸€éã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>æ·¦ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span><span class="lnt">97
</span><span class="lnt">98
</span><span class="lnt">99
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">2010</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">Point</span>
<span class="p">{</span>
    <span class="n">ll</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">Point</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span> <span class="n">ll</span> <span class="n">y</span><span class="p">)</span> <span class="o">:</span> <span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">){};</span>
    <span class="n">Point</span><span class="p">(){}</span>

    <span class="n">Point</span> <span class="nf">normalize</span><span class="p">()</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">Point</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Point</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="k">const</span>
    <span class="p">{</span>
        <span class="c1">//å°†çº¿æŒ‰ç…§æ–œç‡æ’åºï¼Œä»¥åœ¨mapä¸­ç»Ÿè®¡åˆ°ä¸€èµ·ã€‚
</span><span class="c1"></span>        <span class="n">Point</span> <span class="n">a</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(),</span> <span class="n">b</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">normalize</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="k">using</span> <span class="n">Vec</span> <span class="o">=</span> <span class="n">Point</span><span class="p">;</span>

<span class="n">Point</span> <span class="n">origin</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">queries</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">ans</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">map</span><span class="o">&lt;</span><span class="n">Vec</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">mp</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="k">nullptr</span><span class="p">);</span>
    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="k">nullptr</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">qlen</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">nlen</span> <span class="o">&gt;&gt;</span> <span class="n">qlen</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">ans</span><span class="p">));</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">origin</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">origin</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">qlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">queries</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">queries</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">mp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="n">Vec</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">origin</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">origin</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">mp</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">qlen</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Vec</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">queries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">origin</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mp</span><span class="p">[</span><span class="n">Vec</span><span class="p">(</span><span class="o">-</span><span class="n">temp</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">temp</span><span class="p">.</span><span class="n">x</span><span class="p">)];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="cm">/*
</span><span class="cm">        cout&lt;&lt;&#34;====not====&#34;&lt;&lt;endl;
</span><span class="cm">        for(int i=0;i&lt;qlen;i++){
</span><span class="cm">            cout&lt;&lt;ans[i]&lt;&lt;&#34;\t&#34;;
</span><span class="cm">        }
</span><span class="cm">        cout&lt;&lt;endl&lt;&lt;&#34;====not====&#34;&lt;&lt;endl;
</span><span class="cm">        */</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">qlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">mp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Vec</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">origin</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">queries</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mp</span><span class="p">[</span><span class="n">Vec</span><span class="p">(</span><span class="o">-</span><span class="n">temp</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">temp</span><span class="p">.</span><span class="n">x</span><span class="p">)];</span>
                <span class="n">mp</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">qlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/" term="è®¡ç®—å‡ ä½•" label="è®¡ç®—å‡ ä½•" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[CF1221F] Choose a Sequence</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/cf1221f-choose-a-sequence/" />
            <id>https://blog.kanari.moe/code/cf1221f-choose-a-sequence/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-09-23T23:46:44+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>Petya recently found a game &quot;Choose a Square&quot;. In this game, there areÂ nnÂ points numbered fromÂ 11Â toÂ nnÂ on an infinite field. TheÂ ii-th point has coordinatesÂ (xi,yi)Â and costÂ ci.</p>
<p>You have to choose a square such that its sides are parallel to coordinate axes, the lower left and upper right corners belong to the lineÂ y=x, and all corners have integer coordinates.</p>
<p>The score you get is the sum of costs of the points covered by the selected square minus the length of the side of the square. Note that the length of the side can be zero.</p>
<p>Petya asks you to calculate the maximum possible score in the game that can be achieved by placing exactly one square.</p>
<p>{% asset_img a.png %}</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é“é¢˜å…¶å®å’Œå¤šæ ¡çš„Snowy Smileï¼ˆé¢˜æ–‡æ— å…³ï¼‰æŒºåƒçš„ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Petya recently found a game &quot;Choose a Square&quot;. In this game, there areÂ nnÂ points numbered fromÂ 11Â toÂ nnÂ on an infinite field. TheÂ ii-th point has coordinatesÂ (xi,yi)Â and costÂ ci.</p>
<p>You have to choose a square such that its sides are parallel to coordinate axes, the lower left and upper right corners belong to the lineÂ y=x, and all corners have integer coordinates.</p>
<p>The score you get is the sum of costs of the points covered by the selected square minus the length of the side of the square. Note that the length of the side can be zero.</p>
<p>Petya asks you to calculate the maximum possible score in the game that can be achieved by placing exactly one square.</p>
<p>{% asset_img a.png %}</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é“é¢˜å…¶å®å’Œå¤šæ ¡çš„Snowy Smileï¼ˆé¢˜æ–‡æ— å…³ï¼‰æŒºåƒçš„ã€‚</p>
<p>éœ€è¦è½¬åŒ–æ¡ä»¶ã€‚æ­£æ–¹å½¢å…¨éƒ¨ä½äºåæ ‡ç³»ç¬¬ä¸€è±¡é™çš„å¹³åˆ†çº¿ä¸Šï¼Œå¯ä»¥è¡¨ç¤ºä¸º$(l,r)$è¿™ç§å½¢å¼ã€‚ä¸€ä¸ªåœ¨æ­£æ–¹å½¢å†…çš„ç‚¹$(x,y)$(å‡è®¾$x &lt; y$,ç”±äºè¿™ä¸ªé¢˜ç›®çš„ç‰¹æ€§ï¼Œä¸æ»¡è¶³æ—¶å¯ä»¥ç›´æ¥è°ƒæ¢)æ»¡è¶³çš„æ¡ä»¶ä¸º</p>
<div>$$l \leq x \leq y \leq r$$</div>
<p>ç”±æ­¤ï¼Œè¿™é“é¢˜å°±å˜æˆäº†äºŒç»´ååºã€‚æœ¬æ¥çš„æœ¬æ¥ï¼Œä¸Šä¸ªé•¿å¾—åƒæ ‘çŠ¶æ•°ç»„ä¸€ç±»çš„ä¸œè¥¿å°±è§£å†³äº†ã€‚</p>
<p>å°†ç‚¹æŒ‰ç…§ç¬¬ä¸€ç»´æ’åºï¼Œä»å¤§åˆ°å°æšä¸¾ï¼Œåœ¨æ•°æ®ç»“æ„ä¸­ç»´æŠ¤ç»“å°¾åˆ°rçš„å‰ç¼€å’Œæœ€å¤§å€¼ï¼Œå¹¶æŸ¥è¯¢ï¼Œæ›´æ–°å…¨å±€ç­”æ¡ˆã€‚ä¸è¿‡è¿™ä¸ªé¢˜ç›®è¿˜è¦æ±‚æƒå€¼è¦å‡å»æ­£æ–¹å½¢è¾¹é•¿wã€‚</p>
<div>$$f(r)-(r-l)=l+[f(r)-r]$$</div>
<p>ç»´æŠ¤æœ€å¤§å€¼ï¼Œyåˆ†å¼€ï¼Œåªåœ¨pushupæ—¶åˆåœ¨ä¸€èµ·ã€‚</p>
<p>ç„¶åè¿˜è¦ç¦»æ•£åŒ–â€¦â€¦</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>è¿™é¢˜ç»™æˆ‘æ•´è‡ªé—­äº†ï¼Œæˆ‘æƒ³ç”¨çº¿æ®µæ ‘å•ç‚¹ä¿®æ”¹æ¥é­”å¹»ç»´æŠ¤æˆ‘éœ€è¦çš„æ•°æ®ï¼ŒåŠ åŠ å‡å‡ã€‚ç»“æœå‘ç°2ç§ç»´æŠ¤æ–¹å¼éƒ½æœ‰æ— æ³•è§£å†³çš„é—®é¢˜ã€‚æœ€ååªèƒ½æ‰“tagã€‚</p>
<p>çº¿æ®µæ ‘ç»´æŠ¤$f(n)$ä¸ºåˆ°$n$ä¸ºæ­¢çš„å‰ç¼€å’Œã€‚æ¯æ¬¡åŠ ç‚¹ä»¥$x$ä¸ºç»„ï¼Œå¯¹å·²æœ‰ç‚¹å‡å»æ–°å¢çº¿æ®µçš„é•¿åº¦ï¼Œå†åŠ ä¸Šæ–°ç‚¹çš„å½±å“ã€‚é‚£ä¹ˆåœ¨çº¿æ®µæ ‘ä¸Šç»´æŠ¤çš„å°±æ˜¯ç­”æ¡ˆã€‚å–å‡ºæœ€å¤§å€¼å³å¯ã€‚</p>
<p>ä»£ç å†™å¾—åˆé•¿åˆä¸‘ï¼Œä¸è¿‡è¿‡äº†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">500010</span><span class="o">*</span><span class="mi">4</span><span class="p">;</span>

<span class="n">ll</span> <span class="n">tag</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">dMax</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">dy</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="n">n</span><span class="o">=++</span><span class="n">idx</span><span class="p">;</span>
    <span class="n">dy</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">);</span>
    <span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">pushdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="k">return</span><span class="p">;</span>
    <span class="n">tag</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">tag</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">dMax</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="n">dMax</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">+=</span><span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>

    <span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">collect</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">dMax</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span><span class="o">&gt;</span><span class="n">dMax</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]){</span>
        <span class="n">dMax</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">dMax</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]];</span>
        <span class="n">dy</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">dy</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]];</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">dMax</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">dMax</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]];</span>
        <span class="n">dy</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">dy</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]];</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="n">tag</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
        <span class="n">dMax</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="n">collect</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="k">return</span> <span class="nf">make_pair</span><span class="p">(</span><span class="n">dMax</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">dy</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">pushdown</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="p">);</span>
    
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">res</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="o">-</span><span class="mh">0x3f3f3f3f</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]));</span>

    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">struct</span> <span class="nc">Point</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">;</span>
<span class="p">}</span> <span class="n">points</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">nums</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">root</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="cm">/*
</span><span class="cm">    build(root,1,10);
</span><span class="cm">    int opt;
</span><span class="cm">    while(cin&gt;&gt;opt){
</span><span class="cm">        if(opt==1){
</span><span class="cm">            int l,r,x;cin&gt;&gt;l&gt;&gt;r&gt;&gt;x;
</span><span class="cm">            modify(l,r,x,1,10,root);
</span><span class="cm">        }
</span><span class="cm">        if(opt==2){
</span><span class="cm">            int l,r;cin&gt;&gt;l&gt;&gt;r;
</span><span class="cm">            cout&lt;&lt;query(l,r,1,10,root).first&lt;&lt;&#34; &#34;&lt;&lt;query(l,r,1,10,root).second&lt;&lt;endl;
</span><span class="cm">        }
</span><span class="cm">    }
</span><span class="cm">    */</span>
    

    <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="o">&gt;&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
        <span class="n">nums</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
        <span class="n">nums</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">nums</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
    <span class="k">auto</span> <span class="n">rit</span><span class="o">=</span><span class="n">unique</span><span class="p">(</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">nums</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">rit</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
        <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">rit</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">sort</span><span class="p">(</span><span class="n">points</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">points</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">nlen</span><span class="p">,[](</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="o">!=</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="kt">int</span> <span class="n">len</span><span class="o">=</span><span class="n">rit</span><span class="o">-</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">len</span><span class="p">);</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">lastit</span><span class="o">=</span><span class="n">rit</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="o">=</span><span class="n">make_pair</span><span class="p">(</span><span class="o">-</span><span class="mh">0x3f3f3f3f</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">pairl</span><span class="o">=-</span><span class="mh">0x3f3f3f3f</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">thisx</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
        <span class="c1">//auto it=lower_bound(nums.begin(),rit,points[i].x);
</span><span class="c1"></span>        <span class="k">auto</span> <span class="n">it</span><span class="o">=</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="n">thisx</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(;</span><span class="n">lastit</span><span class="o">!=</span><span class="n">it</span><span class="p">;</span><span class="n">lastit</span><span class="o">--</span><span class="p">){</span>
            <span class="n">modify</span><span class="p">(</span><span class="n">lastit</span><span class="o">-</span><span class="n">nums</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">len</span><span class="p">,</span><span class="o">*</span><span class="p">(</span><span class="n">lastit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-*</span><span class="n">lastit</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
            <span class="c1">//cout&lt;&lt;&#34;cost &#34;&lt;&lt;*(lastit-1)-*lastit&lt;&lt;&#34; from &#34;&lt;&lt;lastit-nums.begin()&lt;&lt;&#34; to &#34;&lt;&lt;len&lt;&lt;endl;
</span><span class="c1"></span>        <span class="p">}</span>
        <span class="cm">/*
</span><span class="cm">        for(int j=0;j&lt;=len;j++){
</span><span class="cm">            cout&lt;&lt;query(j,j,0,len,root).first&lt;&lt;&#34;\t&#34;;
</span><span class="cm">        }
</span><span class="cm">        cout&lt;&lt;endl;
</span><span class="cm">        */</span>
        <span class="k">while</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span> <span class="o">&amp;&amp;</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="o">==</span><span class="n">thisx</span><span class="p">){</span>
            <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p</span><span class="o">=</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">modify</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="n">p</span><span class="p">.</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
            <span class="c1">//cout&lt;&lt;&#34;add &#34;&lt;&lt;p.w&lt;&lt;&#34; from &#34;&lt;&lt;p.y&lt;&lt;&#34; to &#34;&lt;&lt;len&lt;&lt;endl;
</span><span class="c1"></span>            <span class="n">i</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">i</span><span class="o">--</span><span class="p">;</span>
        <span class="cm">/*
</span><span class="cm">        for(int j=0;j&lt;=len;j++){
</span><span class="cm">            auto temp2=query(j,j,0,len,root);
</span><span class="cm">            cout&lt;&lt;temp2.first&lt;&lt;&#34;,&#34;&lt;&lt;temp2.second&lt;&lt;&#34;\t&#34;;
</span><span class="cm">        }
</span><span class="cm">        cout&lt;&lt;endl;
</span><span class="cm">        */</span>

        <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">temp</span><span class="o">=</span><span class="n">query</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">len</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="o">&lt;=</span><span class="n">temp</span><span class="p">){</span>
            <span class="n">ans</span><span class="o">=</span><span class="n">temp</span><span class="p">;</span>
            <span class="n">pairl</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="n">thisx</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">pairl</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="o">&lt;&lt;</span><span class="n">pairl</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="o">&lt;&lt;</span><span class="n">nums</span><span class="p">[</span><span class="n">ans</span><span class="p">.</span><span class="n">second</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="o">&lt;&lt;</span><span class="n">nums</span><span class="p">[</span><span class="n">ans</span><span class="p">.</span><span class="n">second</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="mi">0</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;*</span><span class="n">nums</span><span class="p">.</span><span class="n">rbegin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="o">&lt;&lt;*</span><span class="n">nums</span><span class="p">.</span><span class="n">rbegin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="o">&lt;&lt;*</span><span class="n">nums</span><span class="p">.</span><span class="n">rbegin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="s">&#34; &#34;</span><span class="o">&lt;&lt;*</span><span class="n">nums</span><span class="p">.</span><span class="n">rbegin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä½¿ç”¨Mathematicaç»˜åˆ¶è‚¡ç¥¨ç›¸å…³æ›²çº¿</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/mathematica-in-stocks/" />
            <id>https://blog.kanari.moe/code/mathematica-in-stocks/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-09-20T09:33:52+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[Mathematicaæ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚è™½ç„¶æ—©æœ‰è€³é—»åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°å¼ºå¤§åˆ°è¿™ç§åœ°æ­¥ã€‚ åŸâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Mathematicaæ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚è™½ç„¶æ—©æœ‰è€³é—»åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°å¼ºå¤§åˆ°è¿™ç§åœ°æ­¥ã€‚</p>
<p>åŸæœ¬å› ä¸ºè¯¾ç¨‹åŸå› ï¼Œç ”ç©¶äº†ä¸€ä¸‹å¦‚ä½•åœ¨Mathematicaé‡Œç»˜åˆ¶è‚¡ç¥¨æ•°æ®ã€‚ä¸è¿‡ç°åœ¨<strong>åœæ­¢</strong>ï¼Œåªå®Œæˆäº†ä¸€å°éƒ¨åˆ†ã€‚å‰©ä¸‹çš„â€¦â€¦æƒ³æŠ˜è…¾çš„è¯ï¼ŒæŒ‰ç…§å·²ç»æœ‰çš„ä»£ç ï¼Œèƒ½å®¹æ˜“æ”¹å‡ºæ¥å…¶ä»–åŠŸèƒ½ã€‚</p>
<h2 id="æ•°æ®æ¥æº">æ•°æ®æ¥æº</h2>
<p>é¦–å…ˆè¦è¯´çš„æ˜¯ï¼ŒMathematicaä¸­<strong>è‡ªè¡Œæä¾›</strong>äº†éæƒå¨çš„é‡‘èæ•°æ®ã€‚è¿™å¯¹æˆ‘ä»¬å¾ˆæ–¹ä¾¿ã€‚</p>
<p>ä½¿ç”¨å‘½ä»¤<code>FinancialData</code>,å°±å¯ä»¥è·å–å¤§é‡éœ€è¦çš„æ•°æ®ã€‚å…·ä½“å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ã€‚ä¸è¿‡é—®é¢˜æ˜¯ï¼Œä¸çŸ¥ä½•ç§åŸå› ï¼Œè¯¥å‡½æ•°å¯¹æ·±æ²ªè‚¡ç¥¨æ”¯æŒå¾ˆå·®ï¼Œæ‰€ä»¥åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œå¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨è¯¥å‡½æ•°ï¼Œæ¯”è¾ƒå¯æƒœâ€¦â€¦</p>
<p>æˆ‘ä»¬éœ€è¦å®ç°è‡ªå·±çš„æ•°æ®å¤„ç†ã€‚</p>
<p>ç»è¿‡ä¸€ç•ªå¯»æ‰¾åï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªåŸºäºPythonçš„è¯åˆ¸æ•°æ®å¹³å°<code>baostock</code>ã€‚ç»è¿‡ç®€å•çš„å°è£…åï¼ŒMathematicaå°±å¯ä»¥ä½¿ç”¨Pythonä»å¹³å°ä¸Šæ‹‰å–æ•°æ®äº†ã€‚</p>
<p>è¿™ä¸ªä¾‹å­åªèƒ½æ‹‰å–æ—¥Kã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="w">
</span><span class="w"></span><span class="n">BeginPackage</span><span class="p">[</span><span class="s">&#34;StockLink`&#34;</span><span class="p">]</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">StockLink</span><span class="err">::</span><span class="n">usage</span><span class="o">=</span><span class="s">&#34;StockLink&#34;</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">CloseLink</span><span class="err">::</span><span class="n">usage</span><span class="o">=</span><span class="s">&#34;CloseLink&#34;</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">DailyKLine</span><span class="err">::</span><span class="n">usage</span><span class="o">=</span><span class="s">&#34;Get KLine data&#34;</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">CandlestickData</span><span class="err">::</span><span class="n">usage</span><span class="o">=</span><span class="s">&#34;adjust KLine data to fit Candlestick Chart&#34;</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="n">TradingChartData</span><span class="err">::</span><span class="n">usage</span><span class="o">=</span><span class="s">&#34;adjust KLine data to fit Trading Chart&#34;</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">Begin</span><span class="p">[</span><span class="s">&#34;`Private`&#34;</span><span class="p">]</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">StockLink</span><span class="p">[]</span><span class="o">:=</span><span class="n">Module</span><span class="p">[{</span><span class="n">conn</span><span class="p">},</span><span class="w">
</span><span class="w"></span><span class="n">conn</span><span class="o">=</span><span class="n">StartExternalSession</span><span class="p">[</span><span class="s">&#34;Python&#34;</span><span class="p">];</span><span class="w">
</span><span class="w"></span><span class="n">ExternalEvaluate</span><span class="p">[</span><span class="n">conn</span><span class="p">,</span><span class="err">&#34;</span><span class="w">
</span><span class="w"></span><span class="n">import</span><span class="w"> </span><span class="n">baostock</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">bs</span><span class="w">
</span><span class="w"></span><span class="n">lg</span><span class="o">=</span><span class="n">bs</span><span class="err">.</span><span class="n">login</span><span class="p">()</span><span class="w">
</span><span class="w"></span><span class="err">&#34;</span><span class="p">];</span><span class="w">
</span><span class="w"></span><span class="n">conn</span><span class="w">
</span><span class="w"></span><span class="p">];</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">CloseLink</span><span class="p">[</span><span class="nv">conn_</span><span class="p">]</span><span class="o">:=</span><span class="n">Module</span><span class="p">[{},</span><span class="w">
</span><span class="w"></span><span class="n">ExternalEvaluate</span><span class="p">[</span><span class="n">conn</span><span class="p">,</span><span class="err">&#34;</span><span class="w">
</span><span class="w"></span><span class="n">bs</span><span class="err">.</span><span class="n">logout</span><span class="p">()</span><span class="w">
</span><span class="w"></span><span class="err">&#34;</span><span class="p">];</span><span class="w">
</span><span class="w"></span><span class="n">DeleteObject</span><span class="p">[</span><span class="n">conn</span><span class="p">];</span><span class="w">
</span><span class="w"></span><span class="p">];</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">MMAListToPythonList</span><span class="p">[</span><span class="nv">list_</span><span class="p">]</span><span class="o">:=</span><span class="n">StringReplace</span><span class="p">[</span><span class="n">ToString</span><span class="p">[</span><span class="n">list</span><span class="p">,</span><span class="n">InputForm</span><span class="p">],{</span><span class="s">&#34;\&#34;</span><span class="w"> </span><span class="s">&#34;-&gt;&#34;</span><span class="err">&#39;</span><span class="s">&#34;,&#34;</span><span class="p">{</span><span class="s">&#34;-&gt;&#34;</span><span class="p">[</span><span class="s">&#34;,&#34;</span><span class="p">}</span><span class="s">&#34;-&gt;&#34;</span><span class="p">]</span><span class="err">&#34;</span><span class="p">}];</span><span class="w">
</span><span class="w"></span><span class="n">DateObjectToStr</span><span class="p">[</span><span class="nv">date_</span><span class="p">]</span><span class="o">:=</span><span class="n">DateString</span><span class="p">[</span><span class="n">date</span><span class="p">,</span><span class="s">&#34;ISODate&#34;</span><span class="p">];</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">DailyKLine</span><span class="p">[</span><span class="nv">conn_</span><span class="p">,</span><span class="nv">code_</span><span class="p">,</span><span class="nv">startDate_</span><span class="p">,</span><span class="nv">endDate_</span><span class="p">]</span><span class="o">:=</span><span class="n">Module</span><span class="p">[{},</span><span class="w">
</span><span class="w"></span><span class="n">raw</span><span class="o">=</span><span class="n">ExternalEvaluate</span><span class="p">[</span><span class="n">conn</span><span class="p">,</span><span class="w">
</span><span class="w"></span><span class="n">StringTemplate</span><span class="p">[</span><span class="err">&#34;</span><span class="w">
</span><span class="w"></span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bs</span><span class="err">.</span><span class="nv">query_history_k_data_plus</span><span class="p">(</span><span class="err">&#39;``&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="err">&#39;</span><span class="n">date</span><span class="p">,</span><span class="n">open</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">close</span><span class="p">,</span><span class="n">preclose</span><span class="p">,</span><span class="n">volume</span><span class="p">,</span><span class="n">amount</span><span class="p">,</span><span class="n">adjustflag</span><span class="p">,</span><span class="n">turn</span><span class="p">,</span><span class="n">tradestatus</span><span class="p">,</span><span class="n">pctChg</span><span class="p">,</span><span class="n">isST</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="nv">start_date</span><span class="o">=</span><span class="err">&#39;``&#39;</span><span class="p">,</span><span class="w"> </span><span class="nv">end_date</span><span class="o">=</span><span class="err">&#39;``&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="n">frequency</span><span class="o">=</span><span class="err">&#39;</span><span class="n">d</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">adjustflag</span><span class="o">=</span><span class="err">&#39;</span><span class="mi">3</span><span class="err">&#39;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="nv">data_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="w"></span><span class="n">while</span><span class="w"> </span><span class="p">(</span><span class="n">rs</span><span class="err">.</span><span class="nv">error_code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0</span><span class="err">&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rs</span><span class="err">.</span><span class="n">next</span><span class="p">()</span><span class="err">:</span><span class="w">
</span><span class="w">    </span><span class="n">temp</span><span class="o">=</span><span class="n">rs</span><span class="err">.</span><span class="nv">get_row_data</span><span class="p">()</span><span class="w">
</span><span class="w">    </span><span class="nv">data_list</span><span class="p">[</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="err">:</span><span class="p">];</span><span class="w">
</span><span class="w"></span><span class="nv">data_list</span><span class="err">&#34;</span><span class="p">][</span><span class="n">code</span><span class="p">,</span><span class="n">DateObjectToStr</span><span class="p">[</span><span class="n">startDate</span><span class="p">],</span><span class="n">DateObjectToStr</span><span class="p">[</span><span class="n">endDate</span><span class="p">]]];</span><span class="w">
</span><span class="w"></span><span class="n">ToExpression</span><span class="p">[</span><span class="nv">#</span><span class="p">]</span><span class="o">&amp;</span><span class="w"> </span><span class="o">/@</span><span class="w"> </span><span class="n">raw</span><span class="w">
</span><span class="w"></span><span class="p">];</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">CandlestickData</span><span class="p">[</span><span class="nv">raw_</span><span class="p">]</span><span class="o">:=</span><span class="n">Table</span><span class="p">[{</span><span class="n">DateObject</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">raw</span><span class="p">[</span><span class="n">key</span><span class="p">][[</span><span class="mi">1</span><span class="o">;;</span><span class="mi">4</span><span class="p">]]},{</span><span class="n">key</span><span class="p">,</span><span class="n">Keys</span><span class="p">[</span><span class="n">raw</span><span class="p">]}];</span><span class="w">
</span><span class="w"></span><span class="n">TradingChartData</span><span class="p">[</span><span class="nv">raw_</span><span class="p">]</span><span class="o">:=</span><span class="n">Table</span><span class="p">[{</span><span class="n">DateObject</span><span class="p">[</span><span class="n">key</span><span class="p">],</span><span class="n">raw</span><span class="p">[</span><span class="n">key</span><span class="p">][[</span><span class="mi">1</span><span class="o">;;</span><span class="mi">5</span><span class="p">]]},{</span><span class="n">key</span><span class="p">,</span><span class="n">Keys</span><span class="p">[</span><span class="n">raw</span><span class="p">]}];</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">End</span><span class="p">[]</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">EndPackage</span><span class="p">[]</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="å›¾è¡¨ç»˜åˆ¶">å›¾è¡¨ç»˜åˆ¶</h2>
<p>åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œé¦–å…ˆéœ€è¦å¯¼å…¥è¯¥åº“ï¼Œå¹¶ä¸”åˆå§‹åŒ–é“¾æ¥åï¼Œçµæ´»ç»„åˆå„éƒ¨åˆ†åŠŸèƒ½å³å¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">NotebookDirectory</span><span class="p">[]</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s">&#34;StockLink.wl&#34;</span><span class="p">);</span><span class="w">
</span><span class="w"></span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StockLink</span><span class="p">[];</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="p">(</span><span class="err">:ä¾‹å¦‚è·å–æŸä¸ªæ—¥æœŸåŒºé—´å†…çš„æ•°æ®å¹¶è½¬åŒ–ï¼Œç»˜åˆ¶äº¤äº’å›¾æ ‡:</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="n">DailyKLine</span><span class="p">[</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;ss.000001&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">Today</span><span class="p">,</span><span class="w"> </span><span class="n">Today</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">TradingChartData</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">InteractiveTradingChart</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>è¾“å…¥æ—¥æœŸæ—¶ï¼Œå¯ä»¥ç›´æ¥æŒ‰<code>ctrl+=</code>ï¼Œåœ¨æ¡†ä¸­æè¿°æ—¶é—´ï¼Œæ¯”è¾ƒæ–¹ä¾¿ã€‚</p>
<h2 id="å¯èƒ½é‡åˆ°çš„é—®é¢˜">å¯èƒ½é‡åˆ°çš„é—®é¢˜</h2>
<p>å¦‚æœpythoné…ç½®ä¸å¯¹çš„è¯ï¼Œå¯èƒ½ä¼šå‡ºç°Mathematicaæ‰¾ä¸åˆ°pythonã€‚é—®é¢˜çš„è§£å†³æ–¹æ³•åœ¨å®˜æ–¹æ–‡æ¡£ä¸Šéå¸¸æ¸…æ™°ã€‚</p>
<p>ä¸è¿‡æˆ‘ä¸æŠ˜è…¾è‚¡ç¥¨ï¼Œå°±è¿™æ ·äº†ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">ä¸€äº›ç­›æ³•çš„é¢˜</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/some-sieve/" />
            <id>https://blog.kanari.moe/study/some-sieve/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-09-05T20:22:11+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<h2 id="æŠ€å·§">æŠ€å·§</h2>
<h3 id="è‡ªç„¶æº¢å‡º">è‡ªç„¶æº¢å‡º</h3>
<ul>
<li>è‡ªç„¶æº¢å‡ºä¸ä¼šå½±å“ä½ä½æ•°æ®,æ‰€ä»¥æœ‰çš„æ—¶å€™ä½ ä¸éœ€è¦å–æ¨¡,è€Œæ˜¯ä¸€ä¸ªunsigned.</li>
</ul>
<h3 id="é™¤æ³•å–æ¨¡">é™¤æ³•å–æ¨¡</h3>
<p>å¯¹äºå¼å­</p>
<div>$$
\frac {a \times b}{c} \mod p \equiv \frac{a \times b \mod cp}{c}
$$</div>
<h2 id="ç»†èŠ‚">ç»†èŠ‚</h2>
<ul>
<li>æ³¨æ„æ•°æ®ç±»å‹,ä¾‹å¦‚<code>6*(ll)(1&lt;&lt;30)</code>æ˜¯è¦å‡ºé—®é¢˜çš„</li>
<li>æ³¨æ„å‡½æ•°åœ¨$f(1)$ä½ç½®çš„å–å€¼,ä¸è¦å¿˜è®°åˆå§‹åŒ–</li>
</ul>
<h2 id="å•ç‚¹phiçš„æ±‚è§£">å•ç‚¹$\phi$çš„æ±‚è§£</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">ll</span> <span class="nf">euler_phi</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ll</span> <span class="n">m</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">);</span>
    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">/</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">n</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="divisor">Divisor</h2>
<p>Given $n$ and $m$ ($1 \leq n,m \leq 5 \times 10^4$),  please calculate</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="æŠ€å·§">æŠ€å·§</h2>
<h3 id="è‡ªç„¶æº¢å‡º">è‡ªç„¶æº¢å‡º</h3>
<ul>
<li>è‡ªç„¶æº¢å‡ºä¸ä¼šå½±å“ä½ä½æ•°æ®,æ‰€ä»¥æœ‰çš„æ—¶å€™ä½ ä¸éœ€è¦å–æ¨¡,è€Œæ˜¯ä¸€ä¸ªunsigned.</li>
</ul>
<h3 id="é™¤æ³•å–æ¨¡">é™¤æ³•å–æ¨¡</h3>
<p>å¯¹äºå¼å­</p>
<div>$$
\frac {a \times b}{c} \mod p \equiv \frac{a \times b \mod cp}{c}
$$</div>
<h2 id="ç»†èŠ‚">ç»†èŠ‚</h2>
<ul>
<li>æ³¨æ„æ•°æ®ç±»å‹,ä¾‹å¦‚<code>6*(ll)(1&lt;&lt;30)</code>æ˜¯è¦å‡ºé—®é¢˜çš„</li>
<li>æ³¨æ„å‡½æ•°åœ¨$f(1)$ä½ç½®çš„å–å€¼,ä¸è¦å¿˜è®°åˆå§‹åŒ–</li>
</ul>
<h2 id="å•ç‚¹phiçš„æ±‚è§£">å•ç‚¹$\phi$çš„æ±‚è§£</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">ll</span> <span class="nf">euler_phi</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ll</span> <span class="n">m</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">);</span>
    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">/</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">n</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="divisor">Divisor</h2>
<p>Given $n$ and $m$ ($1 \leq n,m \leq 5 \times 10^4$),  please calculate</p>
<h3 id="åˆ†æ">åˆ†æ</h3>
<p>ä¸‹é¢æ‰€æœ‰çš„é™¤æ³•éƒ½æ˜¯èˆå»å°æ•°çš„æ•´é™¤.</p>
<div>$$
\begin{aligned}
\sum_{i=1}^n\sum_{j=1}^m \sigma_0(ij) &= \sum_{i=1}^n\sum_{j=1}^m \sum_{p|i}\sum_{q|j}[p \perp q] \\
&=\sum_{i=1}^n\sum_{j=1}^m \sum_{p|i}\sum_{q|j}\sum_{d|(p,q)}\mu(d) \\
&=\sum_{i=1}^n\sum_{j=1}^m \sum_{p|i}\sum_{q|j}\sum_{d}\mu(d)[d|p][d|q] \\
&=\sum_d \mu(d)\sum_{i=1}^n\sum_{j=1}^m \sum_{pd} \sum_{qd}[pd|i][qd|j] \\
&=\sum_d \mu(d) \sum_{pd} \sum_{qd}\sum_{i=1}^{n/pd}\sum_{j=1}^{m/qd} \\
&=\sum_d \mu(d) \sum_{pd} \sum_{qd} \frac n {pd}\frac m {qd} \\
&=\sum_d \mu(d) \sum_p^{n/d} \frac n {pd} \sum_q^{m/d} \frac m {qd} \\
\end{aligned}
$$</div>
<p>è®¾$S(n)=\sum_{1\leq i \leq n} \frac n i$</p>
<div>$$
\begin{aligned}
\sum_{i=1}^n\sum_{j=1}^m \sigma_0(ij) &=\sum_d \mu(d)S(n/d)S(m/d)
\end{aligned}
$$</div>
<p>$n/d$çš„å–å€¼åœ¨ä¸€ä¸ªåŒºé—´ä¸­æ˜¯ç›¸åŒçš„,å› æ­¤å¯ä»¥æŠŠè¿™ä¸ªæ±‚å’Œå…¬å¼åˆ†å—è®¡ç®—.(åœ¨åˆ†å—å,éœ€è¦è·çŸ¥è¯¥æ®µåŒºåŸŸå†…$\mu$çš„å’Œ,æ‰€ä»¥éœ€è¦æ±‚å‰ç¼€å’Œ)ç”±äº$n/d$çš„å–å€¼ä¸º$O(\sqrt n)$çš„çº§åˆ«,å› æ­¤åœ¨çŸ¥é“$S$çš„å€¼çš„æƒ…å†µä¸‹,æ¯ä¸ªè¯¢é—®å¯ä»¥è¿™ä¸ªå¤æ‚åº¦ä¸­è®¡ç®—å‡ºæ¥.</p>
<p>å¯¹äº$\mu$,ä½¿ç”¨ç­›æ³•,å¹¶æ±‚å‡ºå…¶å‰ç¼€å’Œ.</p>
<p>å¯¹äº$S$,ç›´æ¥æš´åŠ›è®¡ç®—.</p>
<h3 id="ä»£ç ">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">50010</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">isn_p</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">mu</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">premu</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">init_prime</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">){</span>
    <span class="n">isn_p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">isn_p</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">primes</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">len</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">isn_p</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">premu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">premu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">premu</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>


<span class="n">ll</span> <span class="n">S</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">init_S</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">len</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">;</span><span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
	        <span class="c1">//remember this line
</span><span class="c1"></span>            <span class="n">r</span><span class="o">=</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">l</span><span class="p">);</span>
            <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="n">ll</span><span class="p">)(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">l</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">init_prime</span><span class="p">(</span><span class="mi">50000</span><span class="p">);</span>
    <span class="n">init_S</span><span class="p">(</span><span class="mi">50000</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>
        <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="c1">// the minimum one will fastly approach to 0, leading the extra parts of bigger one do nothing to the answer.
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">minn</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">minn</span><span class="p">;</span><span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">),</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">l</span><span class="p">));</span>
            <span class="n">ans</span><span class="o">+=</span><span class="n">S</span><span class="p">[</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">m</span><span class="o">/</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">premu</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">-</span><span class="n">premu</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="table">table</h2>
<p>ç»™å‡ºå¤šç»„$n,m,a$,æ±‚</p>
<div>$$
\sum_{i=1}^n \sum_{j=1}^m \sigma_1((i,j))[\sigma_1((i,j)) \geq a]
$$</div>
<h3 id="åˆ†æ-1">åˆ†æ</h3>
<blockquote>
<p>è¿™é“é¢˜è®©è°éƒ½èƒ½çœ‹å‡ºæ¥é‡ç‚¹æ˜¯å¦‚ä½•å¤„ç†æ¡ä»¶</p>
<div>$$[\sigma_1((i,j)) \geq a]$$</div>
</blockquote>
<p>å¯æ˜¯è¿™æˆ‘æ˜¾ç„¶ä¸çŸ¥é“è¯¥æ€ä¹ˆåš.</p>
<p>å¯¹è¯¢é—®ä½œä»¥$a$ä»å°åˆ°å¤§ç¦»çº¿å¤„ç†,è¯¢é—®å‰å…ˆå¤„ç†æ–°å¢$a$çš„å½±å“.</p>
<p>åœ¨å·²ç»æ»¡è¶³æ¡ä»¶çš„å‰æä¸‹å¯¹å…¬å¼ä½œåŒ–ç®€.</p>
<div>$$
\begin{aligned}
\sum_{i=1}^n \sum_{j=1}^m \sigma_1((i,j)) &= \sum_d \sum_{i=1}^n \sum_{j=1}^m \sigma_1(d)[(i,j)=d] \\
&=\sum_d \sum_{i\leq \frac nd}\sum_{j\leq \frac md}\sigma_1(d)[(i,j)=1] \\
&=\sum_d \sum_{i\leq \frac n{td}}\sum_{j\leq \frac m{td}}\sigma_1(d) \sum_t \mu(t) \\
&=\sum_d \sum_t \mu(t) \sigma_1(d)  \sum_{i\leq \frac n{td}}\sum_{j\leq \frac m{td}} 1 \\
&=\sum_T \lfloor \frac nT \rfloor \lfloor \frac mT \rfloor \sum_{d|T}\mu(t)\sigma_1(\frac Td)
\end{aligned}
$$</div>
<p>å¯ä»¥çœ‹åˆ°è¿˜æ˜¯å¥—è·¯,å¼•å…¥d,å¼•å…¥$\mu$,ä¹‹åèƒ¡ä¹±åŒ–ç®€.</p>
<p>æŒ‰ç…§è¿™ä¸ªå¼å­,éœ€è¦è®¡ç®—çš„å°±æ˜¯$g(x)=\sum_{d|T}\mu(t)\sigma_1(\frac Td)$çš„å‰ç¼€å’Œ.</p>
<p>æ¥ä¸‹æ¥æ˜¯å¦‚ä½•å¤„ç†æ¡ä»¶...</p>
<p>å½“$a$æ¯æ‰©å¤§ä¸€ç‚¹,å°±æœ‰ä¸€éƒ¨åˆ†$\mu(t)\sigma_1(\frac Td)$è¢«åŠ å…¥åˆ°å‡½æ•°$g$çš„å„ä¸ªéƒ¨åˆ†.ä½¿ç”¨ä¸€ç§æ•°æ®ç»“æ„æ¥ç»´æŠ¤$g$çš„å‰ç¼€å’Œ,ä¾‹å¦‚æ ‘çŠ¶æ•°ç»„.$a$æœ€å¤§åˆ°,æ¯æ¬¡å—åˆ°å½±å“çš„å°±æ˜¯$d$çš„å€æ•°,ä»¥æ­¤å¯ä»¥è®¡ç®—å‡ºæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º</p>
<div>$$
WTF
$$</div>
<p>è‡³æ­¤,é—®é¢˜å°±è§£å†³äº†.</p>
<h3 id="ä»£ç -1">ä»£ç </h3>
<p>åˆä¸‘åˆé•¿.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cassert&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXQ</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXFT</span><span class="o">=</span><span class="mi">400010</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">P</span><span class="o">=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">31</span><span class="p">;</span>


<span class="n">ll</span> <span class="n">FT</span><span class="p">[</span><span class="n">MAXFT</span><span class="p">];</span>
<span class="n">ll</span> <span class="nf">lowbit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">ftadd</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">pos</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">+=</span><span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">)){</span>
        <span class="n">FT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">FT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">ftget</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">pos</span><span class="p">;</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">-=</span><span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">)){</span>
        <span class="n">res</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="o">+</span><span class="n">FT</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">%</span><span class="n">p</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">%</span><span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">is_np</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">sigma</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">mu</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Sig</span><span class="p">{</span>
    <span class="n">ll</span> <span class="n">sigma</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="n">Sig</span><span class="p">(){}</span>
    <span class="n">Sig</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">ll</span> <span class="n">sigma</span><span class="p">)</span><span class="o">:</span><span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">sigma</span><span class="p">(</span><span class="n">sigma</span><span class="p">){}</span>
<span class="p">};</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">Sig</span><span class="o">&gt;</span> <span class="n">sigma_vec</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">is_np</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">sigma</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">is_np</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">primes</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">is_np</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sigma</span><span class="p">[</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
            <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">qpow</span><span class="p">(</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span><span class="o">*</span><span class="p">((</span><span class="n">ll</span><span class="p">)</span><span class="mi">1</span><span class="o">-</span><span class="n">qpow</span><span class="p">(</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">],(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
                <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">sigma_vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">Sig</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="nc">Q</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">ans</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">a</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">qs</span><span class="p">[</span><span class="n">MAXQ</span><span class="p">];</span>

<span class="n">ll</span> <span class="nf">f</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">ftget</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">curidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">mergea</span><span class="p">(</span><span class="kt">int</span> <span class="n">newa</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">curidx</span><span class="o">&lt;</span><span class="n">sigma_vec</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">curidx</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Sig</span> <span class="o">&amp;</span><span class="n">sig</span><span class="o">=</span><span class="n">sigma_vec</span><span class="p">[</span><span class="n">curidx</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sig</span><span class="p">.</span><span class="n">sigma</span><span class="o">&gt;</span><span class="n">newa</span><span class="p">)</span><span class="k">break</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">sig</span><span class="p">.</span><span class="n">x</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">+=</span><span class="n">sig</span><span class="p">.</span><span class="n">x</span><span class="p">){</span>
            <span class="n">ftadd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">sig</span><span class="p">.</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="n">sig</span><span class="p">.</span><span class="n">sigma</span><span class="o">%</span><span class="n">P</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">init</span><span class="p">(</span><span class="mi">100000</span><span class="p">);</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">sigma_vec</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">sigma_vec</span><span class="p">.</span><span class="n">end</span><span class="p">(),[](</span><span class="n">Sig</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="n">Sig</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">sigma</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">sigma</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="kt">int</span> <span class="n">qlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">qlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Q</span> <span class="o">&amp;</span><span class="n">q</span><span class="o">=</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">q</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">q</span><span class="p">.</span><span class="n">m</span><span class="p">,</span><span class="o">&amp;</span><span class="n">q</span><span class="p">.</span><span class="n">a</span><span class="p">);</span>
        <span class="n">q</span><span class="p">.</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span><span class="n">qs</span><span class="o">+</span><span class="n">qlen</span><span class="p">,[](</span><span class="n">Q</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">a</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Q</span> <span class="o">&amp;</span><span class="n">q</span><span class="o">=</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">a</span><span class="p">;</span>
        <span class="n">ll</span> <span class="o">&amp;</span><span class="n">ans</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">mergea</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">);</span><span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">),</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">l</span><span class="p">));</span>
            <span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">+</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span><span class="n">qs</span><span class="o">+</span><span class="n">qlen</span><span class="p">,[](</span><span class="n">Q</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">i</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">i</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span><span class="o">%</span><span class="n">P</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="product">product</h2>
<p>å®šä¹‰æ–æ³¢çº³å¦¾(?)(linuxè¿™è¾“å…¥æ³•å¤Ÿé­”æ€§)å‡½æ•°$f(x)$</p>
<p>æ±‚</p>
<div>$$
\prod_{i=1}^n \prod_{j=1}^m f((i,j))
$$</div>
<h3 id="åˆ†æ-2">åˆ†æ</h3>
<p>é¦–å…ˆ,å…ˆå¼•ä¸ª$d$æ˜¯æ²¡é”™äº†.</p>
<p>ä½†æ˜¯</p>
<p>è¿™é“é¢˜,æˆ‘åˆä¸ä¼š.æˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆå¤„ç†$\prod$...è”¡å°±å®Œäº‹äº†.</p>
<p>ç°åœ¨æ¥çœ‹,å½“å¼•å…¥ä¸€ä¸ª$d$å,åœ¨è¯¥æ±‚ç§¯å…¬å¼é‡Œå‡ºç°äº†ç›¸åŒé¡¹ç›¸ä¹˜.å°†è¯¥éƒ¨åˆ†çš„è®¡ç®—è°ƒæ•´ä¸ºå¹‚,å‰©ä¸‹çš„å°±åˆéƒ½ä¸€æ ·äº†.</p>
<div>$$
\begin{aligned}
\prod_{i=1}^n \prod_{j=1}^m f((i,j)) &= \prod_d f(d)^{\sum_{i\leq n} \sum_{j \leq m} [(i,j)=d]} \\
&=\prod_d f(d)^{\sum_{i\leq \frac nd} \sum_{j \leq \frac md} [(i,j)=1]} \\
&=\prod_d f(d)^{\sum_t \mu(t) \sum_{i\leq \frac n{td}} \sum_{j \leq \frac m{td}} 1 } \\
&=\prod_d \prod_t f(d)^{\mu(t) \sum_{i\leq \frac n{td}} \sum_{j \leq \frac m{td}} 1 } \\
&=\prod_T (\prod_{d|T}  f(d)^{\mu(\frac Tt)})^{\lfloor \frac nT \rfloor \lfloor \frac mT \rfloor }
\end{aligned}
$$</div>
<p>è®¾$g(x)=\prod_{d|T}  f(d)^{\mu(\frac Tt)}$,æ±‚å‰ç¼€å’Œå°±å®Œäº‹äº†.</p>
<blockquote>
<p>è¿™é“é¢˜éœ€è¦ä½¿ç”¨<strong>æ¬§æ‹‰å®šç†</strong>æ¥ä¼˜åŒ–æ±‚å¹‚çš„é€Ÿåº¦.</p>
</blockquote>
<h3 id="æ¬§æ‹‰å®šç†">æ¬§æ‹‰å®šç†</h3>
<p>å½“$(a,p)=1$,æœ‰ä»¥ä¸‹å¼å­</p>
<div>$$
a^b \equiv a^{b \mod \phi(p)} \pmod p
$$</div>
<p>å½“$(a,p)\neq 1$,æœ‰æ‰©å±•æ¬§æ‹‰å®šç†</p>
<div>$$
a^b \equiv a^{b \mod \phi(p)+ \phi(p)} \pmod p
$$</div>
<p>æ ¹æ®è¿™2ä¸ªå¼å­,å¯ä»¥åœ¨å¿«é€Ÿé™å¹‚,æ¥åŠ å¿«è¿ç®—.</p>
<h3 id="ä»£ç -2">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1000010</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">P</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="o">*</span><span class="n">a</span><span class="o">%</span><span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">get_inv</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">p</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">qpow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">is_np</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">inv_f</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">preg</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">inv_pg</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">mu</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">is_np</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">is_np</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">primes</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">is_np</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">inv_f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">get_inv</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">P</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">j</span><span class="o">/</span><span class="n">i</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="n">g</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">inv_f</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">j</span><span class="o">/</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">g</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
            <span class="c1">//when mu==0,nothing happens
</span><span class="c1"></span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">preg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">preg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">preg</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
    <span class="n">inv_pg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">inv_pg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">get_inv</span><span class="p">(</span><span class="n">preg</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">P</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">init</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span>
    <span class="c1">//cout&lt;&lt;&#34;done&#34;&lt;&lt;endl;
</span><span class="c1"></span>    <span class="cm">/*
</span><span class="cm">    
</span><span class="cm">    for(auto i:primes){
</span><span class="cm">        cout&lt;&lt;i&lt;&lt;&#34; &#34;;
</span><span class="cm">    }
</span><span class="cm">    cout&lt;&lt;endl;
</span><span class="cm">    
</span><span class="cm">    for(int i=1;i&lt;=20;i++){
</span><span class="cm">        cout&lt;&lt;g[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">    }
</span><span class="cm">    cout&lt;&lt;endl;
</span><span class="cm">    */</span>
    

    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">kase</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="n">m</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>

        <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">),</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">l</span><span class="p">));</span>
            <span class="n">ll</span> <span class="n">sum</span><span class="o">=</span><span class="n">preg</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">*</span><span class="n">inv_pg</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
            <span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">*</span><span class="n">qpow</span><span class="p">(</span><span class="n">sum</span><span class="p">,(</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">l</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">P</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">ans</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="phi3">phi3</h2>
<p>ç»™å‡º$n$,æ±‚</p>
<div>$$
(\sum_{i=1}^n\sum_{j=1}^n\sum_{k=1}^n \frac {\phi(i)\phi(j^2)\phi(k^3)}{\phi(i)\phi(j)\phi(k)} \phi((i,j,k))) \mod 2^{30}
$$</div>
<h3 id="åˆ†æ-3">åˆ†æ</h3>
<p>è¿™é“é¢˜é‡ç‚¹åœ¨äº</p>
<div>$$\frac {\phi(i)\phi(j^2)\phi(k^3)}{\phi(i)\phi(j)\phi(k)}$$</div>
<p>è¿™å †ä¸œè¥¿çš„åŒ–ç®€.å¾ˆæ˜¾ç„¶,æˆ‘åˆä¸ä¼š.</p>
<p>è§‚å¯Ÿ$\phi(n)$çš„å…¬å¼</p>
<div>$$
\phi(n)=n\prod_i(1-\frac 1{\phi(i)})
$$</div>
<p>å¯ä»¥å¾—å‡ºä¸Šé¢é‚£ä¸€å †ç­‰äº$jk^2$.å‰©ä¸‹çš„å°±åˆéƒ½ä¸€æ ·äº†.</p>
<div>$$
\begin{aligned}
\sum_{i=1}^n\sum_{j=1}^n\sum_{k=1}^n jk^2 \phi((i,j,k)) &=\sum_d\sum_{i=1}^n\sum_{j=1}^n\sum_{k=1}^n jk^2 \phi(d)[(i,j,k)=d] \\
&=\sum_d \sum_{t} \phi(d) \mu(t) t^3d^3 \sum_{i\leq \frac n{td}}\sum_{j \leq \frac n{td}}\sum_{k \leq \frac n{td}} jk^2 \\
&=\sum_T \sum_{i\leq \frac nT}\sum_{j \leq \frac nT} j\sum_{k \leq \frac nT}k^2 (T^3 \sum_{d|T} \phi(d) \mu(\frac Td))
\end{aligned} 
$$</div>
<p>è®¾$g(n)=\sum_{d|T} \phi(d) \mu(\frac Td)$,ç›´æ¥ç­›.æœ€åè®¡ç®—å‰ç¼€å’Œçš„æ—¶å€™å†ä¹˜ä¸Š$n^3$å°±å¯ä»¥äº†.</p>
<blockquote>
<p>è¿™é“é¢˜çš„å–æ¨¡è¿˜æœ‰è¿™ç§å¤„ç†æ–¹æ³•: ç›´æ¥å–æ•°ç»„ä¸º<code>unsigned</code>å¹¶è‡ªç„¶æº¢å‡º.<strong>äºŒè¿›åˆ¶å30ä½</strong>ä¸ä¼šå—åˆ°å½±å“.</p>
</blockquote>
<h3 id="ä»£ç -3">ä»£ç </h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ull</span><span class="o">=</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">10000010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">unsigned</span> <span class="n">P</span><span class="o">=</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">30</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">isnp</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primes</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">M</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">unsigned</span> <span class="n">Mt</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">unsigned</span> <span class="n">g</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">preg</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="n">isnp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">isnp</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="n">primes</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>

            <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Mt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">primes</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">newone</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="n">isnp</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">g</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">g</span><span class="p">[</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
            <span class="n">t</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">M</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="n">Mt</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">t</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">Mt</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="n">Mt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
                
                <span class="n">g</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">Mt</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">*</span><span class="p">(</span><span class="n">Mt</span><span class="p">[</span><span class="n">newone</span><span class="p">]</span><span class="o">+</span><span class="n">Mt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">primes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Mt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">preg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">preg</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">P</span><span class="o">*</span><span class="n">i</span><span class="o">%</span><span class="n">P</span><span class="o">*</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
        <span class="n">preg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">init</span><span class="p">(</span><span class="mi">10000000</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">kase</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
        <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">r</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">);</span>
            <span class="n">ull</span> <span class="n">lim</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="p">;</span>
            <span class="n">ull</span> <span class="n">sum1</span><span class="o">=</span><span class="n">lim</span><span class="o">*</span><span class="p">(</span><span class="n">lim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="n">ull</span> <span class="n">sum2</span><span class="o">=</span><span class="n">lim</span><span class="o">*</span><span class="p">(</span><span class="n">lim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">lim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">;</span>
            <span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">+</span><span class="n">lim</span><span class="o">*</span><span class="n">sum1</span><span class="o">%</span><span class="n">P</span><span class="o">*</span><span class="n">sum2</span><span class="o">%</span><span class="n">P</span><span class="o">*</span><span class="p">(</span><span class="n">preg</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">-</span><span class="n">preg</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">ans</span><span class="o">%</span><span class="n">P</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[HDU 6704] Kth Occurrence</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/hdu-6704-kth-occurrence/" />
            <id>https://blog.kanari.moe/code/hdu-6704-kth-occurrence/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-25T15:11:37+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>You are given a string S consisting of only lowercase english letters and some queries.</p>
<p>For each query (l,r,k), please output the starting position of the k-th occurence of the substring SlSl+1...Sr in S.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å¿«é€Ÿæ‰¾å‡ºæ‰€æœ‰å‡ºç°çš„å­ä¸²çš„ä½ç½®,å¯ä»¥ä½¿ç”¨åç¼€æ•°ç»„.è¿™äº›å­—ä¸²å‡ºç°åœ¨saçš„ä¸€ä¸ªè¿ç»­çš„åŒºé—´ä¸­.</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>You are given a string S consisting of only lowercase english letters and some queries.</p>
<p>For each query (l,r,k), please output the starting position of the k-th occurence of the substring SlSl+1...Sr in S.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å¿«é€Ÿæ‰¾å‡ºæ‰€æœ‰å‡ºç°çš„å­ä¸²çš„ä½ç½®,å¯ä»¥ä½¿ç”¨åç¼€æ•°ç»„.è¿™äº›å­—ä¸²å‡ºç°åœ¨saçš„ä¸€ä¸ªè¿ç»­çš„åŒºé—´ä¸­.</p>
<p>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯æ‰¾å‡ºè¿™äº›å‡ºç°ä½ç½®ä¸­çš„ç¬¬kå¤§,å¯ä»¥ä½¿ç”¨ä¸»å¸­æ ‘,ä»¥saå»ºæ ‘.</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>æ€è·¯æ¸…æ™°,ä½†è¿™ä»£ç å®ƒä¸å¥½å†™</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">100060</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ull</span><span class="o">=</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">sa</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">SA</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
        <span class="n">sa</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
            <span class="n">y</span><span class="p">[</span><span class="o">++</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">y</span><span class="p">[</span><span class="o">++</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">k</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
            <span class="n">sa</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">x</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="p">];</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">x</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="p">];</span>
            <span class="n">y</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span> <span class="o">?</span> <span class="nl">p</span> <span class="p">:</span> <span class="o">++</span><span class="n">p</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">tot</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">sum</span><span class="p">[(</span><span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">],</span> <span class="n">rt</span><span class="p">[</span><span class="n">MAXN</span> <span class="o">+</span> <span class="mi">10</span><span class="p">],</span> <span class="n">ls</span><span class="p">[(</span><span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">rs</span><span class="p">[(</span><span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="c1">//å»ºæ ‘
</span><span class="c1"></span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">root</span> <span class="o">=</span> <span class="o">++</span><span class="n">tot</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">root</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">ls</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
    <span class="n">rs</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">root</span><span class="p">;</span> <span class="c1">//è¿”å›è¯¥å­æ ‘çš„æ ¹èŠ‚ç‚¹
</span><span class="c1"></span><span class="p">}</span>
<span class="kt">int</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">root</span><span class="p">)</span> <span class="c1">//æ’å…¥æ“ä½œ
</span><span class="c1"></span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">dir</span> <span class="o">=</span> <span class="o">++</span><span class="n">tot</span><span class="p">;</span>
    <span class="n">ls</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[</span><span class="n">root</span><span class="p">],</span> <span class="n">rs</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">root</span><span class="p">],</span> <span class="n">sum</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dir</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
        <span class="n">ls</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">ls</span><span class="p">[</span><span class="n">dir</span><span class="p">]);</span>
    <span class="k">else</span>
        <span class="n">rs</span><span class="p">[</span><span class="n">dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">rs</span><span class="p">[</span><span class="n">dir</span><span class="p">]);</span>
    <span class="k">return</span> <span class="n">dir</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//left root, right root, querying l,r, the k-th
</span><span class="c1"></span><span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="c1">//æŸ¥è¯¢æ“ä½œ
</span><span class="c1"></span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">sum</span><span class="p">[</span><span class="n">ls</span><span class="p">[</span><span class="n">v</span><span class="p">]]</span> <span class="o">-</span> <span class="n">sum</span><span class="p">[</span><span class="n">ls</span><span class="p">[</span><span class="n">u</span><span class="p">]];</span> <span class="c1">//é€šè¿‡åŒºé—´å‡æ³•å¾—åˆ°å·¦å„¿å­çš„ä¿¡æ¯
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">l</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">)</span> <span class="c1">//è¯´æ˜åœ¨å·¦å„¿å­ä¸­
</span><span class="c1"></span>        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">ls</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
    <span class="k">else</span> <span class="c1">//è¯´æ˜åœ¨å³å„¿å­ä¸­
</span><span class="c1"></span>        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">rs</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">height</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">st</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">get_height</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">--</span><span class="n">k</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="n">k</span><span class="p">])</span> <span class="o">++</span><span class="n">k</span><span class="p">;</span>
        <span class="n">height</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">build_st</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">height</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">19</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">st</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">lcp</span><span class="p">(</span><span class="kt">int</span> <span class="n">ll</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rr</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ll</span><span class="p">],</span> <span class="n">r</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">rr</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="n">n</span> <span class="o">-</span> <span class="n">sa</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="n">log2</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">r</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span><span class="n">qlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="o">&gt;&gt;</span><span class="n">qlen</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">n</span><span class="o">=</span><span class="n">nlen</span><span class="p">;</span>
        <span class="n">SA</span><span class="p">();</span>
        <span class="n">n</span><span class="o">=</span><span class="n">nlen</span><span class="p">;</span>

        <span class="n">get_height</span><span class="p">();</span>
        <span class="n">build_st</span><span class="p">();</span>
        
        <span class="cm">/*
</span><span class="cm">        for(int i=1;i&lt;=nlen;i++)cout&lt;&lt;sa[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">        cout&lt;&lt;endl;
</span><span class="cm">        for(int i=1;i&lt;=nlen;i++)cout&lt;&lt;x[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">        cout&lt;&lt;endl;
</span><span class="cm">        */</span>

        <span class="n">tot</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">sum</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">sum</span><span class="p">));</span>
        <span class="n">rt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlen</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
            <span class="n">rt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">rt</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>

        <span class="k">while</span><span class="p">(</span><span class="n">qlen</span><span class="o">--</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">ql</span><span class="p">,</span><span class="n">qr</span><span class="p">,</span><span class="n">qk</span><span class="p">;</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">ql</span><span class="p">,</span><span class="o">&amp;</span><span class="n">qr</span><span class="p">,</span><span class="o">&amp;</span><span class="n">qk</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">sublen</span><span class="o">=</span><span class="n">qr</span><span class="o">-</span><span class="n">ql</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

            <span class="kt">int</span> <span class="n">ex_l</span><span class="p">,</span><span class="n">ex_r</span><span class="p">;</span>
            <span class="c1">//binary search
</span><span class="c1"></span>            <span class="p">{</span>
                <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">ql</span><span class="p">];</span>
                <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
                    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">lcp</span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">mid</span><span class="p">],</span> <span class="n">ql</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">sublen</span><span class="p">){</span>
                        <span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
                    <span class="p">}</span><span class="k">else</span> <span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">for</span><span class="p">(</span><span class="n">l</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">;</span><span class="n">l</span><span class="o">++</span><span class="p">){</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">lcp</span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">ql</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">sublen</span><span class="p">){</span>
                        <span class="n">ex_l</span><span class="o">=</span><span class="n">l</span><span class="p">;</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="p">{</span>
                <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">ql</span><span class="p">],</span><span class="n">r</span><span class="o">=</span><span class="n">nlen</span><span class="p">;</span>
                <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
                    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">lcp</span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">mid</span><span class="p">],</span> <span class="n">ql</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">sublen</span><span class="p">){</span>
                        <span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
                    <span class="p">}</span><span class="k">else</span> <span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">for</span><span class="p">(</span><span class="n">r</span><span class="p">;</span><span class="n">r</span><span class="o">&gt;=</span><span class="n">l</span><span class="p">;</span><span class="n">r</span><span class="o">--</span><span class="p">){</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">lcp</span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">ql</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">sublen</span><span class="p">){</span>
                        <span class="n">ex_r</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="c1">//cout&lt;&lt;ex_l&lt;&lt;&#34; &#34;&lt;&lt;ex_r&lt;&lt;endl;
</span><span class="c1"></span>            <span class="k">if</span><span class="p">(</span><span class="n">ex_r</span><span class="o">-</span><span class="n">ex_l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">qk</span><span class="p">){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;-</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">query</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span><span class="n">ex_l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rt</span><span class="p">[</span><span class="n">ex_r</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">qk</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">è®°ä¸€ä¸ªbug (HDU 6703)</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/a-wonderful-bug/" />
            <id>https://blog.kanari.moe/gossip/a-wonderful-bug/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-24T22:28:48+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[You are given an array a1,a2,...,an(âˆ€iâˆˆ[1,n],1â‰¤aiâ‰¤n). Initially, each element of the array isâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>You are given an array a1,a2,...,an(âˆ€iâˆˆ[1,n],1â‰¤aiâ‰¤n). Initially, each element of the array is <strong>unique</strong>.</p>
<p>Moreover, there are m instructions.</p>
<p>Each instruction is in one of the following two formats:</p>
<ol>
<li>(1,pos),indicating to change the value of apos to apos+10,000,000;</li>
<li>(2,r,k),indicating to ask the minimum value which is <strong>not equal</strong> to any ai ( 1â‰¤iâ‰¤r ) and **not less ** than k.</li>
</ol>
<p>Please print all results of the instructions in format 2.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é¢˜å¼ºåˆ¶åœ¨çº¿.é¦–å…ˆ1æ“ä½œç›¸å½“äºåˆ é™¤äº†è¿™ä¸ªæ•°.</p>
<p>dalaoè‡ªé—­äº†ä¸€ä¼šgetåˆ°äº†å®ƒçš„æ­£ç¡®åšæ³•,æˆ‘å°±ç›´æ¥æ‹¿æ¥ç”¨äº†.</p>
<p>ç»´æŠ¤ä¸€æƒå€¼çº¿æ®µæ ‘,ä½ç½®iå­˜å…¶åœ¨aä¸­å‡ºç°çš„ä½ç½®.é‚£ä¹ˆå½“1åˆ°råŒºé—´å†…å‡ºç°ä½ç½®çš„æœ€å¤§å€¼è¶…è¿‡äº†r,æ ¹æ®é¸½å·¢åŸç†,è‡³å°‘æœ‰ä¸€ä¸ªæ•°æœªè¢«é™åˆ¶.</p>
<p>åŠ ä¸Šä¸å°äºkçš„æ¡ä»¶,å°±æ˜¯kåˆ°rä¸­,æ‰¾åˆ°æœ€å°çš„ä¸€ä¸ªr,ä½¿å¾—å®ƒæ»¡è¶³ä¸Šé¢çš„æ¡ä»¶,è¾“å‡ºè¿™ä¸ªr.</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<p>ä¸€ä¸ªå¥‡è‘©çš„bug...</p>
<p>å½“ä½¿ç”¨äº†freadè¿™ç§å…ˆè¯»å®Œç¼“å†²åŒºå†å¤„ç†çš„å¿«é€Ÿè¯»å…¥è€Œåˆ æ¼äº†cinæ—¶...ä¼šæ˜¾è€Œæ˜“è§çš„é‡åˆ°bug.</p>
<p>ä½†æ˜¯,å› ä¸ºç¼“å†²åŒºçš„å­˜åœ¨,<strong>å°èŒƒå›´æ•°æ®è¢«å¿«ä¹çš„è¯»å…¥äº†ç¼“å†²åŒº,cinå¹¶ä¸ä¼šå®é™…å½±å“ä»€ä¹ˆ</strong>.ä¸€æ—¦é‡åˆ°å¤§èŒƒå›´æ•°æ®,cinæå‰è¯»å…¥äº†æ¥ä¸‹æ¥çš„æ•°æ®,å¯¼è‡´ç¬¬ä¸€ä¸ªç¼“å†²åŒºä¹‹å¤–çš„æ•°æ®å…¨éƒ¨å‡ºé”™...</p>
<p>è‰¹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">400000</span><span class="p">;</span>

<span class="k">namespace</span> <span class="n">IO</span>
<span class="p">{</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXSIZE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="o">*</span><span class="n">p2</span><span class="p">;</span>
<span class="cp">#define gc()                                                                 \
</span><span class="cp">    (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + fread(buf, 1, MAXSIZE, stdin), p1 == p2) \
</span><span class="cp">         ? EOF                                                               \
</span><span class="cp">         : *p1++)
</span><span class="cp"></span><span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rd</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">gc</span><span class="p">();</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">isdigit</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">gc</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">isdigit</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="n">c</span> <span class="o">^</span> <span class="mi">48</span><span class="p">),</span> <span class="n">c</span> <span class="o">=</span> <span class="n">gc</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">char</span> <span class="n">pbuf</span><span class="p">[</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">],</span> <span class="o">*</span><span class="n">pp</span> <span class="o">=</span> <span class="n">pbuf</span><span class="p">;</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">push</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pp</span> <span class="o">-</span> <span class="n">pbuf</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">fwrite</span><span class="p">(</span><span class="n">pbuf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">,</span> <span class="n">stdout</span><span class="p">),</span> <span class="n">pp</span> <span class="o">=</span> <span class="n">pbuf</span><span class="p">;</span>
    <span class="o">*</span><span class="n">pp</span><span class="o">++</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">write</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="kt">int</span> <span class="n">sta</span><span class="p">[</span><span class="mi">35</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
        <span class="n">sta</span><span class="p">[</span><span class="n">top</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">10</span><span class="p">,</span> <span class="n">x</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">top</span><span class="p">)</span>
        <span class="n">push</span><span class="p">(</span><span class="n">sta</span><span class="p">[</span><span class="o">--</span><span class="n">top</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span> <span class="c1">// namespace IO
</span><span class="c1">///////////////////////////////////////////////////////////////////////////////////////
</span><span class="c1"></span>
<span class="kt">int</span> <span class="n">dat</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">rc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kr">inline</span> <span class="kt">int</span> <span class="nf">imax</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">)</span><span class="k">return</span> <span class="n">a</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">collect</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]],</span> <span class="n">dat</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]]);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">++</span><span class="n">idx</span><span class="p">;</span>
    <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">imax</span><span class="p">(</span><span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">L</span><span class="p">,</span> <span class="kt">int</span> <span class="n">R</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
        <span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mid</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>

    <span class="n">collect</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">target</span><span class="p">,</span> <span class="kt">int</span> <span class="n">L</span><span class="p">,</span> <span class="kt">int</span> <span class="n">R</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&gt;</span><span class="n">r</span> <span class="o">||</span> <span class="n">R</span><span class="o">&lt;</span><span class="n">l</span> <span class="o">||</span> <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">target</span><span class="p">)</span><span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">==</span><span class="n">R</span><span class="p">)</span><span class="k">return</span> <span class="n">L</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">return</span> <span class="o">~</span><span class="n">res</span><span class="o">?</span><span class="nl">res</span><span class="p">:</span><span class="n">query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">root</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">qlen</span><span class="p">;</span>
        <span class="n">nlen</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
        <span class="n">qlen</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">nlen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
            <span class="n">a</span><span class="p">[</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nlen</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">lastans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">qlen</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">opt</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">opt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">int</span> <span class="n">pos</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
                <span class="n">pos</span> <span class="o">^=</span> <span class="n">lastans</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">num</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">&gt;</span><span class="n">nlen</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
                <span class="n">modify</span><span class="p">(</span><span class="mh">0x3f3f3f3f</span><span class="p">,</span> <span class="n">num</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="n">num</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nlen</span><span class="p">,</span> <span class="n">root</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="kt">int</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">;</span>
                <span class="n">t2</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
                <span class="n">t3</span><span class="o">=</span><span class="n">IO</span><span class="o">::</span><span class="n">rd</span><span class="p">();</span>
                <span class="c1">//cin &gt;&gt; t2 &gt;&gt; t3;
</span><span class="c1"></span>                <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">^</span> <span class="n">lastans</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">t3</span> <span class="o">^</span> <span class="n">lastans</span><span class="p">;</span>

                <span class="kt">int</span> <span class="n">t</span><span class="o">=</span><span class="n">query</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">nlen</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nlen</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">lastans</span><span class="o">=</span><span class="p">(</span><span class="o">~</span><span class="n">t</span><span class="o">?</span><span class="nl">t</span><span class="p">:</span><span class="n">nlen</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">OJçš„åç«¯</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/backend-of-oj/" />
            <id>https://blog.kanari.moe/code/backend-of-oj/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-22T14:43:39+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>å†…å®¹æœ‰å¤åˆ¶å’Œå‚è€ƒã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦ç”¨äºè®°å½•åœ¨æ¢ç´¢è¯„æµ‹ç³»ç»ŸReefæœŸé—´æˆ‘æ‰€å­¦çš„ä¸œè¥¿,ä»¥ä¾¿ä¹‹åæŸ¥é˜….</p>
<p>Reefé¢„è®¡ä¸»è¦æ”¯æŒè¿œç¨‹è¯„æµ‹</p>
<p>åŠ ä¸€ç‚¹æœ¬åœ°è¯„æµ‹.....</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>å†…å®¹æœ‰å¤åˆ¶å’Œå‚è€ƒã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦ç”¨äºè®°å½•åœ¨æ¢ç´¢è¯„æµ‹ç³»ç»ŸReefæœŸé—´æˆ‘æ‰€å­¦çš„ä¸œè¥¿,ä»¥ä¾¿ä¹‹åæŸ¥é˜….</p>
<p>Reefé¢„è®¡ä¸»è¦æ”¯æŒè¿œç¨‹è¯„æµ‹</p>
<p>åŠ ä¸€ç‚¹æœ¬åœ°è¯„æµ‹.....</p>
<p>ç»“æœä¸»è¦çš„ä¸œè¥¿éƒ½ç‰¹ä¹ˆæ˜¯æœ¬åœ°è¯„æµ‹çš„.</p>
<h2 id="æ€»ä½“æ¶æ„">æ€»ä½“æ¶æ„</h2>
<p>Reefé¢„è®¡å°†é‡‡ç”¨seccompä½œä¸ºç¬¬ä¸€é“å®‰å…¨å…³å¡,ä½¿ç”¨å¤šçº¿ç¨‹æ£€æµ‹ç¨‹åºè€—æ—¶/å†…å­˜ç­‰ä¿¡æ¯.</p>
<p>åœ¨å¤–å±‚ä½¿ç”¨dockerå°è£…å¹¶å†æ¬¡é™åˆ¶èµ„æº,æ¥å…¥é˜Ÿåˆ—ä»¥èƒ½å¤Ÿæ–¹ä¾¿çš„æ¨ªå‘æ‰©å±•.</p>
<h2 id="seccomp">seccomp</h2>
<p>seccompä¸ºlinuxç³»ç»Ÿä¸Šæ‰æœ‰çš„å®‰å…¨æŠ€æœ¯,å› æ­¤å¿…é¡»ä½¿ç”¨linux.åœ¨å®‰è£…å¿…è¦çš„å®‰è£…åŒ…å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ sudo apt install libseccomp2 libseccomp-dev seccomp
</code></pre></td></tr></table>
</div>
</div><p>å³å¯ä½¿ç”¨.</p>
<p>å½“ç„¶,åœ¨windowsä¸‹çš„Jobsä¼¼ä¹ä¹Ÿå¯ä»¥åˆ©ç”¨,ä½†æ˜¯æˆ‘ä¸å¤ªæ‡‚,å¾®è½¯æ–‡æ¡£å†™å¾—ä¹Ÿå¥‡æ€ª,è€Œä¸”è¿˜å¾—æ˜¯æœåŠ¡å™¨ç‰ˆæœ¬çš„windowsæ‰èƒ½ç”¨.</p>
<h3 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h3>
<p>seccompéœ€è¦ç”±ç¨‹åºä¸»åŠ¨åŠ è½½.å…¶ä½¿ç”¨æ–¹æ³•åŸºæœ¬ä¸ºä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="c1">//g++ -g test.c -o o -lseccomp
</span><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;seccomp.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;linux/seccomp.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
	<span class="c1">//åˆå§‹åŒ–ç­›é€‰å™¨
</span><span class="c1"></span>	<span class="n">scmp_filter_ctx</span> <span class="n">ctx</span><span class="p">;</span>
	<span class="n">ctx</span> <span class="o">=</span> <span class="n">seccomp_init</span><span class="p">(</span><span class="n">SCMP_ACT_ALLOW</span><span class="p">);</span><span class="c1">//flagæŒ‡æ˜é»˜è®¤é€šè¿‡
</span><span class="c1"></span>	<span class="c1">//æ·»åŠ æ‹¦æˆª,å¹¶æŒ‡æ˜ä¸€æ—¦æ‹¦æˆªå°±å°†ç¨‹åºkillæ‰.
</span><span class="c1"></span>	<span class="n">seccomp_rule_add</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">SCMP_ACT_KILL</span><span class="p">,</span> <span class="n">SCMP_SYS</span><span class="p">(</span><span class="n">execve</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
	<span class="c1">//å°†è§„åˆ™åŠ è½½æ³¨å…¥.
</span><span class="c1"></span>	<span class="n">seccomp_load</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>

	<span class="kt">char</span> <span class="o">*</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;/bin/sh&#34;</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">,</span><span class="nb">NULL</span><span class="p">};</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">envp</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">NULL</span><span class="p">};</span>
	<span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;i will give you a shell</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
	<span class="c1">//ç¨‹åºå°†ä¼šåœ¨æ­¤è¡Œå´©æºƒ.
</span><span class="c1"></span>	<span class="n">syscall</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="n">envp</span><span class="p">);</span><span class="c1">//execve
</span><span class="c1"></span>	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>seccomp_initæ˜¯åˆå§‹åŒ–çš„è¿‡æ»¤çŠ¶æ€,è¿™é‡Œç”¨çš„æ˜¯SCMP_ACT_ALLOW,è¡¨ç¤ºé»˜è®¤å…è®¸æ‰€æœ‰çš„syscacll.å¦‚æœåˆå§‹åŒ–çŠ¶æ€ä¸ºSCMP_ACT_KILL,åˆ™è¡¨ç¤ºé»˜è®¤ä¸å…è®¸æ‰€æœ‰çš„syscall.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cm">/**
</span><span class="cm"> * Kill the process
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_ACT_KILL		0x00000000U
</span><span class="cp"></span><span class="cm">/**
</span><span class="cm"> * Throw a SIGSYS signal
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_ACT_TRAP		0x00030000U
</span><span class="cp"></span><span class="cm">/**
</span><span class="cm"> * Return the specified error code
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_ACT_ERRNO(x)	(0x00050000U | ((x) &amp; 0x0000ffffU))
</span><span class="cp"></span><span class="cm">/**
</span><span class="cm"> * Notify a tracing process with the specified value
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_ACT_TRACE(x)	(0x7ff00000U | ((x) &amp; 0x0000ffffU))
</span><span class="cp"></span><span class="cm">/**
</span><span class="cm"> * Allow the syscall to be executed after the action has been logged
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_ACT_LOG		0x7ffc0000U
</span><span class="cp"></span><span class="cm">/**
</span><span class="cm"> * Allow the syscall to be executed
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_ACT_ALLOW		0x7fff0000U
</span></code></pre></td></tr></table>
</div>
</div><p>è§„åˆ™æ·»åŠ </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cm">/**
</span><span class="cm"> * Add a new rule to the filter
</span><span class="cm"> * @param ctx the filter context
</span><span class="cm"> * @param action the filter action
</span><span class="cm"> * @param syscall the syscall number
</span><span class="cm"> * @param arg_cnt the number of argument filters in the argument filter chain
</span><span class="cm"> * @param ... scmp_arg_cmp structs (use of SCMP_ARG_CMP() recommended)
</span><span class="cm"> *
</span><span class="cm"> * This function adds a series of new argument/value checks to the seccomp
</span><span class="cm"> * filter for the given syscall; multiple argument/value checks can be
</span><span class="cm"> * specified and they will be chained together (AND&amp;#039;d together) in the filter.
</span><span class="cm"> * If the specified rule needs to be adjusted due to architecture specifics it
</span><span class="cm"> * will be adjusted without notification.  Returns zero on success, negative
</span><span class="cm"> * values on failure.
</span><span class="cm"> *
</span><span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">seccomp_rule_add</span><span class="p">(</span><span class="n">scmp_filter_ctx</span> <span class="n">ctx</span><span class="p">,</span>
		     <span class="kt">uint32_t</span> <span class="n">action</span><span class="p">,</span> <span class="kt">int</span> <span class="n">syscall</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">arg_cnt</span><span class="p">,</span> <span class="p">...);</span>
</code></pre></td></tr></table>
</div>
</div><p>seccomp_rule_add(ctx, SCMP_ACT_KILL, SCMP_SYS(execve), 0);,arg_cntä¸º0,è¡¨ç¤ºç›´æ¥é™åˆ¶execve,ä¸ç®¡ä»–ä»€ä¹ˆå‚æ•°.</p>
<p>å¦‚æœarg_cntä¸ä¸º0,é‚£arg_cntè¡¨ç¤ºåé¢é™åˆ¶çš„å‚æ•°çš„ä¸ªæ•°,ä¹Ÿå°±æ˜¯åªæœ‰è°ƒç”¨execve,ä¸”å‚æ•°æ»¡è¶³è¦æ±‚æ—¶,æ‰ä¼šæ‹¦æˆªsyscall.</p>
<pre><code>seccomp_rule_add(ctx, SCMP_ACT_KILL, SCMP_SYS(write),1,SCMP_A2(SCMP_CMP_EQ,0x10));//ç¬¬2(ä»0)ä¸ªå‚æ•°ç­‰äº0x10
</code></pre><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for use in declaring rules
</span><span class="cm"> * @param arg the argument number, starting at 0
</span><span class="cm"> * @param op the comparison operator, e.g. SCMP_CMP_*
</span><span class="cm"> * @param datum_a dependent on comparison
</span><span class="cm"> * @param datum_b dependent on comparison, optional
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_CMP(...)		((struct scmp_arg_cmp){__VA_ARGS__})
</span><span class="cp"></span>
<span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for argument 0
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_A0(...)		SCMP_CMP(0, __VA_ARGS__)
</span><span class="cp"></span>
<span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for argument 1
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_A1(...)		SCMP_CMP(1, __VA_ARGS__)
</span><span class="cp"></span>
<span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for argument 2
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_A2(...)		SCMP_CMP(2, __VA_ARGS__)
</span><span class="cp"></span>
<span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for argument 3
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_A3(...)		SCMP_CMP(3, __VA_ARGS__)
</span><span class="cp"></span>
<span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for argument 4
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_A4(...)		SCMP_CMP(4, __VA_ARGS__)
</span><span class="cp"></span>
<span class="cm">/**
</span><span class="cm"> * Specify an argument comparison struct for argument 5
</span><span class="cm"> */</span>
<span class="cp">#define SCMP_A5(...)		SCMP_CMP(5, __VA_ARGS__)
</span><span class="cp"></span>


<span class="cm">/**
</span><span class="cm"> * Comparison operators
</span><span class="cm"> */</span>
<span class="k">enum</span> <span class="nc">scmp_compare</span> <span class="p">{</span>
	<span class="n">_SCMP_CMP_MIN</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCMP_CMP_NE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>		<span class="cm">/**&lt; not equal */</span>
	<span class="n">SCMP_CMP_LT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>		<span class="cm">/**&lt; less than */</span>
	<span class="n">SCMP_CMP_LE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>		<span class="cm">/**&lt; less than or equal */</span>
	<span class="n">SCMP_CMP_EQ</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>		<span class="cm">/**&lt; equal */</span>
	<span class="n">SCMP_CMP_GE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>		<span class="cm">/**&lt; greater than or equal */</span>
	<span class="n">SCMP_CMP_GT</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>		<span class="cm">/**&lt; greater than */</span>
	<span class="n">SCMP_CMP_MASKED_EQ</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>		<span class="cm">/**&lt; masked equality */</span>
	<span class="n">_SCMP_CMP_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**
</span><span class="cm"> * Argument datum
</span><span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">uint64_t</span> <span class="n">scmp_datum_t</span><span class="p">;</span>

<span class="cm">/**
</span><span class="cm"> * Argument / Value comparison definition
</span><span class="cm"> */</span>
<span class="k">struct</span> <span class="nc">scmp_arg_cmp</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">;</span>	<span class="cm">/**&lt; argument number, starting at 0 */</span>
	<span class="k">enum</span> <span class="nc">scmp_compare</span> <span class="n">op</span><span class="p">;</span>	<span class="cm">/**&lt; the comparison op, e.g. SCMP_CMP_* */</span>
	<span class="n">scmp_datum_t</span> <span class="n">datum_a</span><span class="p">;</span>
	<span class="n">scmp_datum_t</span> <span class="n">datum_b</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>ctxçš„å†…å®¹å¯ä»¥ä½¿ç”¨å‡½æ•°dumpå‡ºæ¥,ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨prctlå‘½ä»¤ç›¸å…³ç›´æ¥è½½å…¥,æ–¹ä¾¿ä½¿ç”¨?</p>
<h3 id="seccompè°ƒè¯•">seccompè°ƒè¯•</h3>
<p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯¼å‡ºæ‰€æœ‰å¯èƒ½çš„å‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">file</span><span class="o">=</span>syscall-names.h
<span class="nb">echo</span> <span class="s2">&#34;static const char *syscall_names[] = {&#34;</span> &gt; <span class="nv">$file</span>
<span class="nb">echo</span> <span class="s2">&#34;#include &lt;sys/syscall.h&gt;&#34;</span> <span class="p">|</span> cpp -dM <span class="p">|</span> grep <span class="p">&amp;</span><span class="c1">#039;^#define __NR_&amp;#039; | LC_ALL=C sed -r -n -e &amp;#039;s/^\#define[ \t]+__NR_([a-z0-9_]+)[ \t]+([0-9]+)(.*)/ [\2] = &#34;\1&#34;,/p&amp;#039; &gt;&gt; $file</span>
<span class="nb">echo</span> <span class="s2">&#34;};&#34;</span> &gt;&gt; <span class="nv">$file</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨å¦‚ä¸‹ä»£ç å¯¼å‡ºä¸€æ®µä»£ç æ‰€éœ€è¦çš„æƒé™.éµå¾ªæœ€å°æƒé™åŸåˆ™,è¯•éªŒä»£ç è¿è¡Œæ‰€éœ€è¦çš„æœ€å°‘æƒé™.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#define __USE_GNU 1
</span><span class="cp">#define _GNU_SOURCE 1
</span><span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/prctl.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;linux/types.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;linux/filter.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;linux/seccomp.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;seccomp.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stddef.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&#34;syscall-names.h&#34;</span><span class="cp">
</span><span class="cp">#if defined(__i386__)
</span><span class="cp">#define REG_RESULT	REG_EAX
</span><span class="cp">#define REG_SYSCALL	REG_EAX
</span><span class="cp">#define REG_ARG0	REG_EBX
</span><span class="cp">#define REG_ARG1	REG_ECX
</span><span class="cp">#define REG_ARG2	REG_EDX
</span><span class="cp">#define REG_ARG3	REG_ESI
</span><span class="cp">#define REG_ARG4	REG_EDI
</span><span class="cp">#define REG_ARG5	REG_EBP
</span><span class="cp">#elif defined(__x86_64__)
</span><span class="cp">#define REG_RESULT	REG_RAX
</span><span class="cp">#define REG_SYSCALL	REG_RAX
</span><span class="cp">#define REG_ARG0	REG_RDI
</span><span class="cp">#define REG_ARG1	REG_RSI
</span><span class="cp">#define REG_ARG2	REG_RDX
</span><span class="cp">#define REG_ARG3	REG_R10
</span><span class="cp">#define REG_ARG4	REG_R8
</span><span class="cp">#define REG_ARG5	REG_R9
</span><span class="cp">#endif
</span><span class="cp">#ifndef SYS_SECCOMP
</span><span class="cp">#define SYS_SECCOMP 1
</span><span class="cp">#endif
</span><span class="cp"></span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">msg</span><span class="o">=</span><span class="s">&#34;system call invalid: &#34;</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">write_uint</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tens</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">strcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&#34;0&#34;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">tens</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span> <span class="n">tens</span><span class="p">;</span> <span class="n">tens</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="o">++</span> <span class="n">width</span><span class="p">;</span>
    <span class="n">buf</span><span class="p">[</span><span class="n">width</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="err">\</span><span class="mi">0</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">tens</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span> <span class="n">tens</span><span class="p">;</span> <span class="n">tens</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">buf</span><span class="p">[</span><span class="o">--</span><span class="n">width</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="p">(</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span> <span class="o">+</span> <span class="p">(</span><span class="n">tens</span> <span class="o">%</span> <span class="mi">10</span><span class="p">));</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">helper</span><span class="p">(</span><span class="kt">int</span> <span class="n">nr</span><span class="p">,</span> <span class="n">siginfo_t</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">void_context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">255</span><span class="p">];</span>
    <span class="n">ucontext_t</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="p">(</span><span class="n">ucontext_t</span> <span class="o">*</span><span class="p">)(</span><span class="n">void_context</span><span class="p">);</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">syscall</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="o">-&gt;</span><span class="n">si_code</span> <span class="o">!=</span> <span class="n">SYS_SECCOMP</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="n">syscall</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">uc_mcontext</span><span class="p">.</span><span class="n">gregs</span><span class="p">[</span><span class="n">REG_SYSCALL</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">syscall</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">syscall_names</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">syscall_names</span><span class="p">[</span><span class="n">syscall</span><span class="p">]);</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&#34;(&#34;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">write_uint</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">strlen</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span> <span class="n">syscall</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">syscall</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">syscall_names</span><span class="p">))</span>
        <span class="n">strcat</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&#34;)&#34;</span><span class="p">);</span>
    <span class="n">strcat</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
    <span class="n">write</span><span class="p">(</span><span class="n">STDOUT_FILENO</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>
    <span class="n">_exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">install_helper</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="nc">sigaction</span> <span class="n">act</span><span class="p">;</span>
    <span class="n">sigset_t</span> <span class="n">mask</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">act</span><span class="p">));</span>
    <span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">);</span>
    <span class="n">sigaddset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span> <span class="n">SIGSYS</span><span class="p">);</span>
    <span class="n">act</span><span class="p">.</span><span class="n">sa_sigaction</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">helper</span><span class="p">;</span>
    <span class="n">act</span><span class="p">.</span><span class="n">sa_flags</span> <span class="o">=</span> <span class="n">SA_SIGINFO</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sigaction</span><span class="p">(</span><span class="n">SIGSYS</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">act</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">&#34;sigaction&#34;</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_UNBLOCK</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mask</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">&#34;sigprocmask&#34;</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="k">if</span><span class="p">(</span><span class="n">install_helper</span><span class="p">()){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;install helper failed&#34;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">scmp_filter_ctx</span> <span class="n">ctx</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">ctx</span> <span class="o">=</span> <span class="n">seccomp_init</span><span class="p">(</span><span class="n">SCMP_ACT_ALLOW</span><span class="p">);</span>

	<span class="n">seccomp_rule_add</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">SCMP_ACT_TRAP</span><span class="p">,</span> <span class="n">SCMP_SYS</span><span class="p">(</span><span class="n">execve</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">seccomp_load</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
	<span class="n">seccomp_release</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
	<span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&#34;something to stdout</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;/bin/sh&#34;</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">,</span><span class="nb">NULL</span><span class="p">};</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">envp</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">NULL</span><span class="p">};</span>
	<span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;i will give you a shell</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
	<span class="n">syscall</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="n">envp</span><span class="p">);</span><span class="c1">//execve
</span><span class="c1"></span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="æ³¨å…¥ç¨‹åº">æ³¨å…¥ç¨‹åº</h3>
<p>åˆšåˆšæåˆ°äº†seccompå¿…é¡»ç”±ç¨‹åºä¸»åŠ¨åŠ è½½,å› æ­¤éœ€è¦æœ‰ä¸€ä¸ªåŠæ³•å°†ä»£ç æ³¨å…¥åˆ°ç”¨æˆ·çš„ä»£ç ä¸­.</p>
<blockquote>
<p>ç­‰å¾…å®Œæˆ</p>
</blockquote>
<h3 id="å…¶ä»–è¯­è¨€">å…¶ä»–è¯­è¨€</h3>
<p>è¿™ç©æ„è²Œä¼¼è‡³å°‘èƒ½æ–¹ä¾¿çš„ç”¨åœ¨cç³»è¯­è¨€,javaå’Œpythonä¸Š.</p>
<h2 id="docker">Docker</h2>
<p>å‡†å¤‡ä½¿ç”¨Dockeré‡æ„æ•´ä¸ªOJ</p>
<h3 id="å¤šé˜¶æ®µæ„å»º">å¤šé˜¶æ®µæ„å»º</h3>
<p>ä½¿ç”¨Docker,å°†OJåˆ†è§£ä¸ºå¤šä¸ªé˜¶æ®µæ¥æ„å»º.</p>
<ol>
<li>å‰ç«¯æ„å»º</li>
<li>åç«¯æ„å»º</li>
<li>è¿è¡Œç¯å¢ƒæ„å»ºä¸ä»£ç æ•´åˆ</li>
<li>nginxæ„å»º</li>
</ol>
<h4 id="å‘½ä»¤">å‘½ä»¤</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Dockerfile" data-lang="Dockerfile"><span class="c">#...</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># ä½¿ç”¨phpä½œä¸ºåŸºç¡€,æŒ‡æ˜è¯¥æ„å»ºé˜¶æ®µä¸ºcodeisland</span><span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> php:alpine as codeisland</span><span class="err">
</span><span class="err"></span><span class="c"># åœ¨å®¹å™¨æ‰“åŒ…é˜¶æ®µå®‰è£…æ•°æ®åº“é©±åŠ¨</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> docker-php-ext-install pdo pdo_pgsql<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">PATH</span><span class="o">=</span>/app/laravel<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># ä»å…¶ä»–é˜¶æ®µå¤åˆ¶ä»£ç åˆ°æœ¬é˜¶æ®µ</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> --from<span class="o">=</span>DELETED /app/ <span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–å‘½ä»¤</span><span class="err">
</span><span class="err"></span><span class="c"># [DELETED]</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># æŒ‡æ˜å®¹å™¨çš„å·¥ä½œè·¯å¾„</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> ${PATH}</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c">#...</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="å®¹å™¨åè°ƒ">å®¹å™¨åè°ƒ</h3>
<p>ä½¿ç”¨Docker-composeæ¥åè°ƒå„ä¸ªå®¹å™¨çš„å…³ç³».</p>
<ul>
<li>æ•°æ®åº“å®¹å™¨</li>
<li>rediså®¹å™¨</li>
<li>ç½‘ç«™åç«¯å®¹å™¨</li>
<li>è¯„æµ‹å™¨å®¹å™¨</li>
<li>è¯„æµ‹ä»£ç†å®¹å™¨</li>
<li>nginxå®¹å™¨</li>
</ul>
<p>é™åˆ¶è¯„æµ‹å™¨å®¹å™¨çš„èµ„æºæ¶ˆè€—çš„ä¾‹å­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yml" data-lang="yml"><span class="k">deploy</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">resources</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="k">limits</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="k">cpus</span><span class="p">:</span><span class="w"> </span><span class="cp">&amp;#039;0.50&amp;#039;</span><span class="w">
</span><span class="w">      </span><span class="k">memory</span><span class="p">:</span><span class="w"> </span>1024M<span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="ç½‘ç»œ">ç½‘ç»œ</h3>
<p>...å­¦æ ¡ç½‘å…³çš„ç™»å½•çŠ¶æ€æ ¹æœ¬æ²¡æ³•ç»´æŒ,å¡æ­».</p>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[FZU 2204]Seven</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/fzu-2204seven/" />
            <id>https://blog.kanari.moe/code/fzu-2204seven/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-10T10:53:02+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[nä¸ªæœ‰æ ‡å·çš„çƒå›´æˆä¸€ä¸ªåœˆã€‚æ¯ä¸ªçƒæœ‰ä¸¤ç§é¢œè‰²å¯ä»¥é€‰æ‹©é»‘æˆ–ç™½æŸ“è‰²ã€‚é—®æœ‰å¤šå°‘ç§æ–¹æ¡ˆä½¿å¾—æ²¡æœ‰â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>nä¸ªæœ‰æ ‡å·çš„çƒå›´æˆä¸€ä¸ªåœˆã€‚æ¯ä¸ªçƒæœ‰ä¸¤ç§é¢œè‰²å¯ä»¥é€‰æ‹©é»‘æˆ–ç™½æŸ“è‰²ã€‚é—®æœ‰å¤šå°‘ç§æ–¹æ¡ˆä½¿å¾—æ²¡æœ‰å‡ºç°è¿ç»­ç™½çƒ7ä¸ªæˆ–è¿ç»­é»‘çƒ7ä¸ªã€‚</p>
<p>å¯¹æ–¹æ¡ˆæ•°mod 2015ï¼Œçƒæœ€å¤šæœ‰100000ä¸ªã€‚</p>
<h1 id="åˆ†æ">åˆ†æ</h1>
<p>è€ƒè™‘å¯¹äºéç¯çŠ¶çƒçš„ç­”æ¡ˆè®¡ç®—ï¼Œå¯ä»¥è®¾$sum(i,k)$è¡¨ç¤ºç¬¬iä¸ªçƒä¸ºkè‰²æ—¶çš„æ–¹æ¡ˆæ•°ã€‚å…¶è®¡ç®—éå¸¸æ˜¾ç„¶</p>
<div>$$
sum(i,k)=\sum_{1\leq j \leq 6}{sum(i-j,1-k)}
$$</div>
<p>æ¥ä¸‹æ¥è€ƒè™‘æ”¶å°¾ç›¸æ¥åéœ€è¦æ’é™¤çš„æƒ…å†µï¼Œå³æ”¶å°¾åŒè‰²çƒé•¿åº¦ç›¸åŠ è¶…è¿‡6çš„æƒ…å†µï¼Œè¿™å¯ä»¥ç›´æ¥æšä¸¾ã€‚</p>
<p>é¦–å–iä¸ªæœ«å–jä¸ªåŒè‰²ï¼Œä»ç­”æ¡ˆä¸­åˆ é™¤æ­¤æ—¶å‰©ä¸‹çƒçš„æ–¹æ¡ˆæ•°ï¼Œæ³¨æ„å‰©ä¸‹çš„çƒçš„é¦–æœ«çƒé¢œè‰²<strong>ä¸èƒ½</strong>å’Œå·²ç»æšä¸¾çš„é¢œè‰²åŒè‰²ã€‚é‰´äºè¿™ç§è¦æ±‚ï¼Œæˆ‘ä»¬é€€å›åˆ°sumçš„é€’æ¨å…¬å¼å¤„ï¼Œå†³å®šsumçš„è¾¹ç•Œæ¡ä»¶ä¸ºé¦–ä¸ªçƒå›ºå®šä¸ºé»‘è‰²ï¼Œè¿™æ ·å°±èƒ½å¾ˆæ–¹ä¾¿çš„ç¡®å®šçƒçš„é¢œè‰²ï¼Œä¸”æ ¹æ®å¯¹ç§°æ€§ç­”æ¡ˆå¯ä»¥ç›´æ¥x2å¾—åˆ°ã€‚</p>
<p>é¢˜å°±åšå®Œäº†ã€‚</p>
<h1 id="ä»£ç ">ä»£ç </h1>
<blockquote>
<p>æ·¦ï¼Œä¸ºä»€ä¹ˆå½“æ—¶æ²¡å†™ã€‚</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">P</span><span class="o">=</span><span class="mi">2015</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">sum</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="n">sum</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">100000</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="p">(</span><span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
            <span class="p">(</span><span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">sum</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">sum</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="p">(</span><span class="n">sum</span><span class="p">[</span><span class="n">nlen</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">sum</span><span class="p">[</span><span class="n">nlen</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">nlen</span><span class="o">&gt;=</span><span class="mi">7</span><span class="p">)</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">7</span> <span class="o">&amp;&amp;</span> <span class="n">nlen</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>
                        <span class="n">ans</span><span class="o">=</span><span class="p">(</span><span class="n">ans</span><span class="o">-</span><span class="n">sum</span><span class="p">[</span><span class="n">nlen</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;Case #&#34;</span><span class="o">&lt;&lt;++</span><span class="n">cnt</span><span class="o">&lt;&lt;</span><span class="s">&#34;: &#34;</span><span class="o">&lt;&lt;</span><span class="p">((</span><span class="n">ans</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="o">+</span><span class="mi">2015</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[HDU6638] Snowy Smile</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/hdu6638-snowy-smile/" />
            <id>https://blog.kanari.moe/code/hdu6638-snowy-smile/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-07T20:45:09+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>There are n pirate chests buried in Byteland, labeled by 1,2,â€¦,n. The i-th chest's location is (xi,yi), and its value is wi, wi can be negative since the pirate can add some poisonous gases into the chest. When you open the i-th pirate chest, you will get wi value.</p>
<p>You want to make money from these pirate chests. You can select a rectangle, the sides of which are all paralleled to the axes, and then all the chests inside it or on its border will be opened. Note that you must open all the chests within that range regardless of their values are positive or negative. But you can choose a rectangle with nothing in it to get a zero sum.</p>
<p>Please write a program to find the best rectangle with maximum total value.</p>
<p>The first line of the input contains an integer T(1â‰¤Tâ‰¤100), denoting the number of test cases.</p>
<p>In each test case, there is one integer n(1â‰¤nâ‰¤2000) in the first line, denoting the number of pirate chests.</p>
<p>For the next n lines, each line contains three integers xi,yi,wi(âˆ’109â‰¤xi,yi,wiâ‰¤109), denoting each pirate chest.</p>
<p>It is guaranteed that âˆ‘nâ‰¤10000.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¦–å…ˆï¼Œæˆ‘æ²¡åšå‡ºæ¥ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>There are n pirate chests buried in Byteland, labeled by 1,2,â€¦,n. The i-th chest's location is (xi,yi), and its value is wi, wi can be negative since the pirate can add some poisonous gases into the chest. When you open the i-th pirate chest, you will get wi value.</p>
<p>You want to make money from these pirate chests. You can select a rectangle, the sides of which are all paralleled to the axes, and then all the chests inside it or on its border will be opened. Note that you must open all the chests within that range regardless of their values are positive or negative. But you can choose a rectangle with nothing in it to get a zero sum.</p>
<p>Please write a program to find the best rectangle with maximum total value.</p>
<p>The first line of the input contains an integer T(1â‰¤Tâ‰¤100), denoting the number of test cases.</p>
<p>In each test case, there is one integer n(1â‰¤nâ‰¤2000) in the first line, denoting the number of pirate chests.</p>
<p>For the next n lines, each line contains three integers xi,yi,wi(âˆ’109â‰¤xi,yi,wiâ‰¤109), denoting each pirate chest.</p>
<p>It is guaranteed that âˆ‘nâ‰¤10000.</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>é¦–å…ˆï¼Œæˆ‘æ²¡åšå‡ºæ¥ã€‚</p>
<p>è¿™é“é¢˜å®é™…ä¸Šå°±æ˜¯åœ¨è¦æ±‚ä½ ç”¨å°äº$O(N^3)$çš„å¤æ‚åº¦æ±‚å‡ºæœ€å¤§å’Œå­çŸ©é˜µã€‚æ³¨æ„åˆ°è¯¥é¢˜çš„ç‚¹<strong>ç¨€ç–</strong>ï¼Œæ‰€ä»¥ä»¥ç‚¹ä¸ºè€ƒè™‘å¯¹è±¡ã€‚</p>
<p>ä¸‰æ–¹çš„åšæ³•ï¼Œæšä¸¾çŸ©é˜µçš„ä¸Šè¾¹ç•Œå’Œä¸‹è¾¹ç•Œï¼Œç»´æŠ¤çºµå‘ä¸Šçš„å’Œï¼Œæ±‚æœ€å¤§å­—æ®µå’Œã€‚å½“ä»¥ç‚¹è€ƒè™‘æ—¶ï¼Œä¸Šä¸‹è¾¹ç•Œå°±å¯ä»¥ç›´æ¥ç”±<strong>æ’åºå</strong>çš„ç‚¹å†³å®šã€‚ä¹‹åï¼Œä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤æœ€å¤§å­æ®µå’Œã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">400010</span><span class="p">;</span>

<span class="n">ll</span> <span class="n">d_sub</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">d_pre</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">d_suf</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">d_sum</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="n">n</span><span class="o">=++</span><span class="n">idx</span><span class="p">;</span>
    <span class="n">d_sum</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">d_sub</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">d_pre</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">d_suf</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">==</span><span class="n">r</span><span class="p">){</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">);</span>
    <span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
    <span class="c1">//combine data
</span><span class="c1"></span><span class="p">}</span>
<span class="kt">void</span> <span class="nf">collect</span><span class="p">(</span><span class="kt">int</span> <span class="n">node</span><span class="p">){</span>
    <span class="n">d_sum</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">d_sum</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]]</span><span class="o">+</span><span class="n">d_sum</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]];</span>

    <span class="n">d_pre</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">d_pre</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]],</span><span class="n">d_sum</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]]</span><span class="o">+</span><span class="n">d_pre</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]]);</span>
    <span class="n">d_suf</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">d_suf</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]],</span><span class="n">d_sum</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]]</span><span class="o">+</span><span class="n">d_suf</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]]);</span>

    <span class="n">d_sub</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="n">d_sub</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]],</span><span class="n">d_sub</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]]),</span><span class="n">d_suf</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]]</span><span class="o">+</span><span class="n">d_pre</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]]);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">node</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="c1">//only single point to modify
</span><span class="c1"></span>        <span class="n">d_sub</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">d_sub</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">;</span>
        <span class="n">d_pre</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">d_pre</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">;</span>
        <span class="n">d_suf</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">d_suf</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">;</span>
        <span class="n">d_sum</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]);</span>

    <span class="n">collect</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">root</span><span class="p">;</span>
<span class="n">ll</span> <span class="nf">query_all</span><span class="p">(){</span>
    <span class="k">return</span> <span class="n">d_sub</span><span class="p">[</span><span class="n">root</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="nc">Chest</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Chest</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="k">return</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">other</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">other</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">chests</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">refy</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
        <span class="n">refy</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">Chest</span> <span class="o">&amp;</span><span class="n">chest</span><span class="o">=</span><span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">chest</span><span class="p">.</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">chest</span><span class="p">.</span><span class="n">y</span><span class="o">&gt;&gt;</span><span class="n">chest</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
            <span class="n">refy</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">chest</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">sort</span><span class="p">(</span><span class="n">chests</span><span class="p">,</span><span class="n">chests</span><span class="o">+</span><span class="n">nlen</span><span class="p">);</span>

        <span class="n">sort</span><span class="p">(</span><span class="n">refy</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">refy</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
        <span class="k">auto</span> <span class="n">refyend</span><span class="o">=</span><span class="n">unique</span><span class="p">(</span><span class="n">refy</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">refy</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
        <span class="kt">int</span> <span class="n">maxy</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">refy</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">refyend</span><span class="p">,</span><span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">refy</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">maxy</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">maxy</span><span class="p">,</span><span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">lastx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">lastx</span><span class="o">==</span><span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">lastx</span><span class="o">=</span><span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
            <span class="c1">//cout&lt;&lt;&#34;start from &#34;&lt;&lt;lastx&lt;&lt;endl;
</span><span class="c1"></span>
            <span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxy</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">nextx</span><span class="o">=</span><span class="n">chests</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">nlen</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span><span class="p">(</span><span class="n">chests</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">x</span><span class="o">!=</span><span class="n">nextx</span><span class="p">){</span>
                    <span class="n">nextx</span><span class="o">=</span><span class="n">chests</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
                    <span class="n">ans</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">query_all</span><span class="p">());</span>
                <span class="p">}</span>
                <span class="n">modify</span><span class="p">(</span><span class="n">chests</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">v</span><span class="p">,</span><span class="n">chests</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span><span class="p">,</span><span class="n">chests</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">maxy</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">ans</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">query_all</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">max</span><span class="p">(</span><span class="mi">0ll</span><span class="p">,</span><span class="n">ans</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">è«é˜Ÿç®—æ³•</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/mo-s-algorithm/" />
            <id>https://blog.kanari.moe/study/mo-s-algorithm/</id>
            <updated>2020-04-09T21:33:36+08:00</updated>
            <published>2019-08-03T13:47:41+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>å¯¹äºå¯ä»¥ç¦»çº¿çš„åŒºé—´è¯¢é—®é—®é¢˜ï¼Œè«é˜Ÿç®—æ³•æå‡ºäº†ä¸€ç§å¯ä»¥åœ¨$O(n\sqrt n)$(æ— ä¿®æ”¹)ï¼Œ$n^{5/3}$(å¸¦ä¿®æ”¹)å†…å¾—å‡ºç­”æ¡ˆçš„æ–¹æ³•ã€‚</p>
<p>ä¸»è¦çš„æ€è·¯æ˜¯å¯¹è¯¢é—®ç¦»çº¿å¹¶åˆ†å—ï¼Œåˆ©ç”¨åœ¨2ä¸ªåŒºé—´é—´ç­”æ¡ˆçš„<strong>å¿«é€Ÿè½¬ç§»</strong>ï¼ˆå¦‚æœæ— æ³•æ‰¾åˆ°å¿«é€Ÿè½¬ç§»çš„æ–¹æ³•ï¼Œå°±æ²¡æ³•ç”¨äº†ï¼‰é™ä½å¤æ‚åº¦ã€‚</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>å¯¹äºå¯ä»¥ç¦»çº¿çš„åŒºé—´è¯¢é—®é—®é¢˜ï¼Œè«é˜Ÿç®—æ³•æå‡ºäº†ä¸€ç§å¯ä»¥åœ¨$O(n\sqrt n)$(æ— ä¿®æ”¹)ï¼Œ$n^{5/3}$(å¸¦ä¿®æ”¹)å†…å¾—å‡ºç­”æ¡ˆçš„æ–¹æ³•ã€‚</p>
<p>ä¸»è¦çš„æ€è·¯æ˜¯å¯¹è¯¢é—®ç¦»çº¿å¹¶åˆ†å—ï¼Œåˆ©ç”¨åœ¨2ä¸ªåŒºé—´é—´ç­”æ¡ˆçš„<strong>å¿«é€Ÿè½¬ç§»</strong>ï¼ˆå¦‚æœæ— æ³•æ‰¾åˆ°å¿«é€Ÿè½¬ç§»çš„æ–¹æ³•ï¼Œå°±æ²¡æ³•ç”¨äº†ï¼‰é™ä½å¤æ‚åº¦ã€‚</p>
<h2 id="æ— ä¿®æ”¹è«é˜Ÿ">æ— ä¿®æ”¹è«é˜Ÿ</h2>
<p>ä»¥$B=\sqrt{n}$ï¼ŒæŒ‰ç…§$(l/B,r)$å¯¹è¯¢é—®æ’åºã€‚</p>
<p>ä¹‹åæšä¸¾æ¯ä¸€ä¸ªè¯¢é—®ï¼Œå°†ç­”æ¡ˆåœ¨ç›¸é‚»è¯¢é—®åŒºé—´é—´æš´åŠ›çš„+1-1è½¬ç§»ã€‚</p>
<h3 id="problem-å°yçš„è¢œå­">Problem: å°Yçš„è¢œå­</h3>
<p>æ²¡æœ‰åœ¨é’ˆå¯¹å“ªä¸ªäººã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªç”Ÿæ´»æ•£æ¼«çš„äººï¼Œå°Zæ¯å¤©æ—©ä¸Šéƒ½è¦è€—è´¹å¾ˆä¹…ä»ä¸€å †äº”é¢œå…­è‰²çš„è¢œå­ä¸­æ‰¾å‡ºä¸€åŒæ¥ç©¿ã€‚ç»ˆäºæœ‰ä¸€å¤©ï¼Œå°Zå†ä¹Ÿæ— æ³•å¿å—è¿™æ¼äººçš„æ‰¾è¢œå­è¿‡ç¨‹ï¼Œäºæ˜¯ä»–å†³å®šå¬å¤©ç”±å‘½â€¦â€¦</p>
<p>å…·ä½“æ¥è¯´ï¼Œå°ZæŠŠè¿™Nåªè¢œå­ä»1åˆ°Nç¼–å·ï¼Œç„¶åä»ç¼–å·Låˆ°R(L å°½ç®¡å°Zå¹¶ä¸åœ¨æ„ä¸¤åªè¢œå­æ˜¯ä¸æ˜¯å®Œæ•´çš„ä¸€åŒï¼Œç”šè‡³ä¸åœ¨æ„ä¸¤åªè¢œå­æ˜¯å¦ä¸€å·¦ä¸€å³ï¼Œä»–å´å¾ˆåœ¨æ„è¢œå­çš„é¢œè‰²ï¼Œæ¯•ç«Ÿç©¿ä¸¤åªä¸åŒè‰²çš„è¢œå­ä¼šå¾ˆå°´å°¬ã€‚</p>
<p>ä½ çš„ä»»åŠ¡ä¾¿æ˜¯å‘Šè¯‰å°Zï¼Œä»–æœ‰å¤šå¤§çš„æ¦‚ç‡æŠ½åˆ°ä¸¤åªé¢œè‰²ç›¸åŒçš„è¢œå­ã€‚å½“ç„¶ï¼Œå°Zå¸Œæœ›è¿™ä¸ªæ¦‚ç‡å°½é‡é«˜ï¼Œæ‰€ä»¥ä»–å¯èƒ½ä¼šè¯¢é—®å¤šä¸ª(L,R)ä»¥æ–¹ä¾¿è‡ªå·±é€‰æ‹©ã€‚</p>
<p>è¢œå­çš„æ•°é‡æœ€å¤šä¸º50000ï¼ˆæ˜¯çœŸçš„ğŸ‚ğŸºï¼‰</p>
<h4 id="åˆ†æ">åˆ†æ</h4>
<p>è¿™ä¼¼ä¹æ˜¯è«é˜Ÿçš„ä¾‹é¢˜ï¼ˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">50010</span><span class="p">,</span><span class="n">MAXQ</span><span class="o">=</span><span class="mi">50010</span><span class="p">;</span>

<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">){</span>
    <span class="k">return</span> <span class="o">!</span><span class="n">b</span><span class="o">?</span><span class="nl">a</span><span class="p">:</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">c2</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">block</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Q</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">ansu</span><span class="p">,</span><span class="n">ansd</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">/</span><span class="n">block</span><span class="o">!=</span><span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="o">/</span><span class="n">block</span><span class="p">)</span><span class="k">return</span> <span class="n">l</span><span class="o">/</span><span class="n">block</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="o">/</span><span class="n">block</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span><span class="n">qs</span><span class="p">[</span><span class="n">MAXQ</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">cnt</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">cup</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">cdown</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">remove</span><span class="p">(</span><span class="kt">int</span> <span class="n">ptr</span><span class="p">){</span>
    <span class="n">cup</span><span class="o">-=</span><span class="n">c2</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]);</span>
    <span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
    <span class="n">cdown</span><span class="o">--</span><span class="p">;</span>
    <span class="n">cup</span><span class="o">+=</span><span class="n">c2</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">ptr</span><span class="p">){</span>
    <span class="n">cup</span><span class="o">-=</span><span class="n">c2</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]);</span>
    <span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
    <span class="n">cdown</span><span class="o">++</span><span class="p">;</span>
    <span class="n">cup</span><span class="o">+=</span><span class="n">c2</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">ptr</span><span class="p">]]);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span><span class="n">qlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="o">&gt;&gt;</span><span class="n">qlen</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
    <span class="n">block</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nlen</span><span class="p">);</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span><span class="n">qs</span><span class="o">+</span><span class="n">qlen</span><span class="p">);</span>
    <span class="cm">/*
</span><span class="cm">    cout&lt;&lt;&#34;current queries:&#34;&lt;&lt;endl;
</span><span class="cm">    for(auto q:qs){
</span><span class="cm">        cout&lt;&lt;q.l&lt;&lt;&#34; &#34;&lt;&lt;q.r&lt;&lt;endl;
</span><span class="cm">    }
</span><span class="cm">    cout&lt;&lt;&#34;=====&#34;&lt;&lt;endl;
</span><span class="cm">*/</span>
    <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">Q</span> <span class="o">&amp;</span><span class="n">q</span><span class="o">=</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">l</span><span class="o">==</span><span class="n">q</span><span class="p">.</span><span class="n">r</span><span class="p">){</span>
            <span class="n">q</span><span class="p">.</span><span class="n">ansu</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">q</span><span class="p">.</span><span class="n">ansd</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">l</span><span class="o">&lt;</span><span class="n">l</span><span class="p">)</span><span class="n">add</span><span class="p">(</span><span class="o">--</span><span class="n">l</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">&lt;</span><span class="n">q</span><span class="p">.</span><span class="n">r</span><span class="p">)</span><span class="n">add</span><span class="p">(</span><span class="o">++</span><span class="n">r</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">q</span><span class="p">.</span><span class="n">l</span><span class="p">)</span><span class="n">remove</span><span class="p">(</span><span class="n">l</span><span class="o">++</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">r</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">remove</span><span class="p">(</span><span class="n">r</span><span class="o">--</span><span class="p">);</span>

        <span class="n">q</span><span class="p">.</span><span class="n">ansu</span><span class="o">=</span><span class="n">cup</span><span class="p">;</span>
        <span class="n">q</span><span class="p">.</span><span class="n">ansd</span><span class="o">=</span><span class="n">cdown</span><span class="p">;</span>
        <span class="c1">//cout&lt;&lt;cup/c2(cdown)&lt;&lt;endl;
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span><span class="n">qs</span><span class="o">+</span><span class="n">qlen</span><span class="p">,[](</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
            <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">i</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">i</span><span class="p">;</span>
            <span class="p">});</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ansd</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
            <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;0/1&#34;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">ll</span> <span class="n">u</span><span class="o">=</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ansu</span><span class="p">;</span>
        <span class="n">ll</span> <span class="n">d</span><span class="o">=</span><span class="n">c2</span><span class="p">(</span><span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ansd</span><span class="p">);</span>
        <span class="n">ll</span> <span class="n">g</span><span class="o">=</span><span class="n">gcd</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">d</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">g</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="n">u</span><span class="o">/=</span><span class="n">g</span><span class="p">,</span><span class="n">d</span><span class="o">/=</span><span class="n">g</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">u</span><span class="o">&lt;&lt;</span><span class="s">&#34;/&#34;</span><span class="o">&lt;&lt;</span><span class="n">d</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="å¸¦ä¿®æ”¹è«é˜Ÿ">å¸¦ä¿®æ”¹è«é˜Ÿ</h2>
<blockquote>
<p>ä¸€åˆ‡éƒ½æ˜¯çŸ³xé—¨çš„é€‰æ‹©ï¼</p>
</blockquote>
<p>å°†ä¿®æ”¹æ“ä½œå¹³é“ºåœ¨æ—¶é—´çº¿ä¸Šï¼Œè®¡ç®—æ¯æ¬¡è¯¢é—®æ‰€å¤„çš„æ—¶é—´ç‚¹ï¼Œä»¥$B=\sqrt{n}$ï¼ŒæŒ‰ç…§$(l/B,r/B,time)$å¯¹è¯¢é—®æ’åºã€‚</p>
<p>ä¹‹åæšä¸¾æ¯ä¸€ä¸ªè¯¢é—®ï¼Œå°†ç­”æ¡ˆåœ¨ä¸åŒæ—¶é—´çº¿é—´æš´åŠ›+1-1è·³è½¬ï¼Œå†æš´åŠ›åœ¨ç›¸é‚»è¯¢é—®çš„åŒºé—´é—´+1-1è½¬ç§»ã€‚</p>
<p><del>å¬èµ·æ¥æœ‰ç‚¹ä¸­äºŒçš„æ„æ€ã€‚</del></p>
<h3 id="problem-game">Problem: Game</h3>
<p>Again Alice and Bob is playing a game with stones. There are N piles of stones labelled from 1 to N, the i th pile has ai stones.</p>
<p>First Alice will choose piles of stones with consecutive labels, whose leftmost is labelled with L and the rightmost one is R. After, Bob will choose another consecutive piles labelled from l to r (Lâ‰¤lâ‰¤râ‰¤R). Then they're going to play game within these piles.</p>
<p>Here's the rules of the game: Alice takes first and the two will take turn to make a move: choose one pile with nonegetive stones and take at least one stone and at most all away. One who cant make a move will lose.</p>
<p>Bob thinks this game is not so intersting because Alice always take first. So they add a new rule, which is that Bob can swap the number of two adjacent piles' stones whenever he want before a new round. That is to say, if the i th and i+1 pile have ai and ai+1 stones respectively, after this swapping there will be ai+1 and ai.</p>
<p>Before today's game with Bob, Alice wants to know, if both they play game optimally when she choose the piles from L to R, there are how many pairs (l, r) chosed by Bob that will make Alice <em>win</em>.</p>
<h4 id="åˆ†æ-1">åˆ†æ</h4>
<p>nimæ¸¸æˆè¾“èµ¢å°±æ˜¯çœ‹å¼‚æˆ–å’Œï¼Œå¼‚æˆ–å’Œå¯ä»¥çœ‹å‰ç¼€å¼‚æˆ–å’Œå†…æœ‰å¤šå°‘ä¸ªå€¼ç›¸åŒçš„ç‚¹ã€‚æ‰€ä»¥å®ƒå°±æ˜¯åœ¨é—®ä¸€ä¸ªåŒºé—´é‡Œæœ‰å¤šå°‘ä¸ªç›¸åŒç‚¹å¯¹ã€‚</p>
<p>å¸¦å•ç‚¹ä¿®æ”¹çš„åŒºé—´ç‚¹å¯¹è®¡æ•°ã€‚</p>
<h4 id="ä»£ç ">ä»£ç </h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdio&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">100010</span><span class="p">,</span><span class="n">MAXQ</span><span class="o">=</span><span class="mi">100010</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXPOS</span><span class="o">=</span><span class="mf">2e6</span><span class="o">+</span><span class="mi">11</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span><span class="n">qlen</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">game</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">pre</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">modified</span><span class="p">[</span><span class="n">MAXQ</span><span class="p">],</span><span class="n">midx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">belong</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">block</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Q</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tick</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Q</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span><span class="p">{</span>
 <span class="c1">//       if(l/block!=b.l/block)return l/block&lt;b.l/block;
</span><span class="c1"></span>   <span class="c1">//     if(r/block!=b.r/block)return r/block&lt;b.r/block;
</span><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="n">belong</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">!=</span><span class="n">belong</span><span class="p">[</span><span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">belong</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">&lt;</span><span class="n">belong</span><span class="p">[</span><span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">belong</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">!=</span><span class="n">belong</span><span class="p">[</span><span class="n">b</span><span class="p">.</span><span class="n">r</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">belong</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">&lt;</span><span class="n">belong</span><span class="p">[</span><span class="n">b</span><span class="p">.</span><span class="n">r</span><span class="p">];</span>
        <span class="k">return</span>  <span class="n">tick</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">tick</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span><span class="n">q</span><span class="p">[</span><span class="n">MAXQ</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">qidx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">cache</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">cnt</span><span class="p">[</span><span class="n">MAXPOS</span><span class="p">];</span>

<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
    <span class="kt">int</span> <span class="o">&amp;</span><span class="n">c</span><span class="o">=</span><span class="n">cnt</span><span class="p">[</span><span class="n">pre</span><span class="p">[</span><span class="n">pos</span><span class="p">]];</span>
    <span class="n">cache</span><span class="o">-=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">c</span><span class="o">++</span><span class="p">;</span>
    <span class="n">cache</span><span class="o">+=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">rm</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
    <span class="kt">int</span> <span class="o">&amp;</span><span class="n">c</span><span class="o">=</span><span class="n">cnt</span><span class="p">[</span><span class="n">pre</span><span class="p">[</span><span class="n">pos</span><span class="p">]];</span>
    <span class="n">cache</span><span class="o">-=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">c</span><span class="o">--</span><span class="p">;</span>
    <span class="n">cache</span><span class="o">+=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">curt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">jumpup</span><span class="p">(</span><span class="kt">int</span> <span class="n">tim</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">tim</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pos</span><span class="o">=</span><span class="n">modified</span><span class="p">[</span><span class="n">tim</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="n">game</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">b</span><span class="o">=</span><span class="n">game</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">swap</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span><span class="n">game</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">pos</span> <span class="o">&amp;&amp;</span> <span class="n">pos</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="n">rm</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">pre</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">^=</span><span class="n">a</span><span class="p">;</span>
    <span class="n">pre</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">^=</span><span class="n">b</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">pos</span> <span class="o">&amp;&amp;</span> <span class="n">pos</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">){</span>
        <span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">jumpdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">tim</span><span class="p">){</span>
    <span class="n">jumpup</span><span class="p">(</span><span class="n">tim</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">ll</span> <span class="n">qans</span><span class="p">[</span><span class="n">MAXQ</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">//freopen(&#34;00.in&#34;,&#34;r&#34;,stdin);
</span><span class="c1"></span>    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">nlen</span><span class="p">,</span><span class="o">&amp;</span><span class="n">qlen</span><span class="p">)){</span>
        <span class="n">block</span><span class="o">=</span><span class="n">pow</span><span class="p">(</span><span class="n">nlen</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="n">belong</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">block</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">pre</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

        <span class="n">qidx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">midx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">qlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">opt</span><span class="p">;</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
                <span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
                <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">l</span><span class="p">,</span><span class="o">&amp;</span><span class="n">r</span><span class="p">);</span>
                <span class="n">q</span><span class="p">[</span><span class="n">qidx</span><span class="p">].</span><span class="n">i</span><span class="o">=</span><span class="n">qidx</span><span class="p">;</span>
                <span class="n">q</span><span class="p">[</span><span class="n">qidx</span><span class="p">].</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">;</span>
                <span class="n">q</span><span class="p">[</span><span class="n">qidx</span><span class="p">].</span><span class="n">l</span><span class="o">--</span><span class="p">;</span>
                <span class="n">q</span><span class="p">[</span><span class="n">qidx</span><span class="p">].</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">;</span>
                <span class="n">q</span><span class="p">[</span><span class="n">qidx</span><span class="p">].</span><span class="n">tick</span><span class="o">=</span><span class="n">midx</span><span class="p">;</span>
                <span class="n">qidx</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
                <span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">modified</span><span class="p">[</span><span class="o">++</span><span class="n">midx</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">sort</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">+</span><span class="n">qidx</span><span class="p">);</span>

        <span class="n">memset</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">cnt</span><span class="p">));</span>
        <span class="n">cache</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">l</span><span class="o">=</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">curt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qidx</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
                <span class="n">qans</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">while</span><span class="p">(</span><span class="n">curt</span><span class="o">&lt;</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">tick</span><span class="p">)</span><span class="n">jumpup</span><span class="p">(</span><span class="o">++</span><span class="n">curt</span><span class="p">);</span>
            <span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">tick</span><span class="o">&lt;</span><span class="n">curt</span><span class="p">)</span><span class="n">jumpdown</span><span class="p">(</span><span class="n">curt</span><span class="o">--</span><span class="p">);</span>

            <span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="o">&lt;</span><span class="n">l</span><span class="p">)</span><span class="n">add</span><span class="p">(</span><span class="o">--</span><span class="n">l</span><span class="p">);</span>
            <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">&lt;</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">)</span><span class="n">add</span><span class="p">(</span><span class="o">++</span><span class="n">r</span><span class="p">);</span>
            <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="p">)</span><span class="n">rm</span><span class="p">(</span><span class="n">l</span><span class="o">++</span><span class="p">);</span>
            <span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">rm</span><span class="p">(</span><span class="n">r</span><span class="o">--</span><span class="p">);</span>
 
            <span class="c1">//qans[q[i].i]=cache;
</span><span class="c1"></span>            <span class="n">ll</span> <span class="n">len</span><span class="o">=</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">qans</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">len</span><span class="o">*</span><span class="p">(</span><span class="n">len</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">cache</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">qidx</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">qans</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="æ³¨æ„">æ³¨æ„</h2>
<ul>
<li>å…³äºè®°å½•å½“å‰é—®é¢˜çš„åŒºé—´çš„å¼€é—­é—®é¢˜ï¼Œéœ€è¦è°¨æ…å®‰æ’ã€‚</li>
<li>åœ¨ç¡®è®¤äº†åŒºé—´å¼€é—­åï¼Œå…³äºæœ€åˆå§‹çš„çŠ¶æ€ï¼Œéœ€è¦è°¨æ…å®‰æ’ã€‚</li>
</ul>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Distribution of Books</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/distribution-of-books/" />
            <id>https://blog.kanari.moe/code/distribution-of-books/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-01T15:15:47+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[zz6d likes reading very much, so he bought a lot of books. One day, zz6d brought n books to a classroom in school. The books of zz6d is so popular that K students in the classroom want to borrow his books toâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>zz6d likes reading very much, so he bought a lot of books. One day, zz6d brought n books to a classroom in school. The books of zz6d is so popular that K students in the classroom want to borrow his books to read. Every book of zz6d has a number i (1&lt;=i&lt;=n). Every student in the classroom wants to get a continuous number books. Every book has a pleasure value, which can be 0 or even negative (causing discomfort). Now zz6d needs to distribute these books to K students. The pleasure value of each student is defined as the sum of the pleasure values of all the books he obtains.Zz6d didn't want his classmates to be too happy, so he wanted to minimize the maximum pleasure of the K classmates. zz6d can hide some last numbered books and not distribute them,which means he can just split the first x books into k parts and ignore the rest books, every part is consecutive and no two parts intersect with each other.However,every classmate must get at least one book.Now he wonders how small can the maximum pleasure of the K classmates be.</p>
<p>1&lt;=T&lt;=10</p>
<p>1&lt;=n&lt;=2*105</p>
<p>1&lt;=k&lt;=n</p>
<p>-109&lt;=ai&lt;=109</p>
<h1 id="åˆ†æ">åˆ†æ</h1>
<p>æœ€å¤§å€¼æœ€å°ï¼Œè€ƒè™‘äºŒåˆ†ç­”æ¡ˆã€‚æ€è€ƒé¢˜ç›®æ˜¯å¦å…·æœ‰å•è°ƒæ€§ï¼šå½“æœ€å¤§å€¼æå¤§æ—¶ï¼Œä¹¦å¯ä»¥éšä¾¿åˆ†ï¼Œå½“æœ€å¤§å€¼æå°æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°æ— æ³•å‡‘é½çš„çŠ¶å†µï¼Œç›®æµ‹æ»¡è¶³ã€‚</p>
<p>é¢˜ç›®è¦æ±‚åˆ†ä¹¦æ—¶å¿…é¡»è¿ç»­åˆ†ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥åšã€‚å‡è®¾äºŒåˆ†çš„ç­”æ¡ˆä¸ºlim</p>
<div>$$f(i)=\max \{ f(j) | \sum_{k=j+1}^i a_k \leq lim  \}+1$$</div>
<p>å°†æ±‚å’Œæ”¹ä¸ºå‰ç¼€å’Œï¼Œ$pre(i)$ã€‚</p>
<div>$$f(i)=\max \{ f(j) | pre(i)-pre(j-1) \leq lim  \}+1$$</div>
<p>åŠ¨æ€è§„åˆ’çš„å¤æ‚åº¦ä¸º$O(n^2)$ï¼Œå¤ªæ…¢ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p>
<p>æ¯æ¬¡è½¬ç§»éƒ½ä»å…ˆå‰å·²ç»å‡ºç°çš„æ»¡è¶³è¦æ±‚çš„fä¸­è½¬ç§»ã€‚é™åˆ¶æ¡ä»¶è½¬ä¸€ä¸‹ï¼Œå°±æ˜¯</p>
<div>$$pre(i)-lim \leq pre(?)$$</div>
<ul>
<li>å½“æœ‰2ä¸ªfå¯¹åº”çš„å‰ç¼€å’Œç›¸åŒï¼Œæˆ‘ä»¬é€‰æ‹©æ›´å¤§çš„é‚£ä¸ª</li>
</ul>
<p>æ‰€ä»¥å¯ä»¥ç›´æ¥ç»´æŠ¤å·²ç»å‡ºç°çš„æ¯ç§å‰ç¼€å’Œæ‰€å¯¹åº”çš„æœ€å¤§fã€‚å¯ä»¥ç¦»æ•£åŒ–åä½¿ç”¨æƒå€¼çº¿æ®µæ ‘ã€‚å¤æ‚åº¦å˜ä¸º$O(n\lg n)$</p>
<p>æ€»å¤æ‚åº¦ä¸º$O(n\lg n \lg n)$ã€‚</p>
<h1 id="ä»£ç ">ä»£ç </h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">900010</span><span class="p">;</span>

<span class="n">ll</span> <span class="n">dat</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">lc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">n</span><span class="p">)</span><span class="n">n</span><span class="o">=++</span><span class="n">idx</span><span class="p">;</span>
    <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=-</span><span class="mh">0x3f3f3f3f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;=</span><span class="n">r</span><span class="p">)</span><span class="k">return</span> <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>

    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">build</span><span class="p">(</span><span class="n">lc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">),</span><span class="n">build</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">dat</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">collectchild</span><span class="p">(</span><span class="kt">int</span> <span class="n">node</span><span class="p">){</span>
    <span class="n">dat</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]],</span><span class="n">dat</span><span class="p">[</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]]);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">query_n</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">node</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">L</span> <span class="o">&amp;&amp;</span> <span class="n">R</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">)</span><span class="k">return</span> <span class="n">dat</span><span class="p">[</span><span class="n">node</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">res</span><span class="o">=-</span><span class="mh">0x3f3f3f3f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query_n</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">query_n</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]));</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">modify</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">,</span><span class="kt">int</span> <span class="n">node</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&gt;=</span><span class="n">R</span><span class="p">){</span>
        <span class="n">dat</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">node</span><span class="p">],</span><span class="n">x</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">lc</span><span class="p">[</span><span class="n">node</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mid</span><span class="o">&lt;</span><span class="n">r</span><span class="p">)</span><span class="n">modify</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="n">node</span><span class="p">]);</span>
    <span class="n">collectchild</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="n">prefix</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">bprefix</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">num</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">nlen</span><span class="p">,</span><span class="n">sel</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">rlen</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">root</span><span class="p">;</span>
<span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">rlen</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">zero</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">bprefix</span><span class="p">,</span><span class="n">bprefix</span><span class="o">+</span><span class="n">rlen</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="n">bprefix</span><span class="p">;</span>
    <span class="n">modify</span><span class="p">(</span><span class="n">zero</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">rlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">start</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">bprefix</span><span class="p">,</span><span class="n">bprefix</span><span class="o">+</span><span class="n">rlen</span><span class="p">,</span><span class="n">bprefix</span><span class="p">[</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">bprefix</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">dp</span><span class="o">=</span><span class="n">query_n</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">rlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">rlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">root</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dp</span><span class="o">&gt;=</span><span class="n">sel</span><span class="p">)</span><span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="n">modify</span><span class="p">(</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">dp</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">rlen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">root</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">//debug
</span><span class="c1"></span>    <span class="cm">/*
</span><span class="cm">    int opt;
</span><span class="cm">    build(root,0,10-1);
</span><span class="cm">    while(cin&gt;&gt;opt){
</span><span class="cm">        if(opt==1){
</span><span class="cm">            int pos,x;cin&gt;&gt;pos&gt;&gt;x;
</span><span class="cm">            modify(pos,pos,x,0,10-1,root);
</span><span class="cm">        }else{
</span><span class="cm">            int l,r;cin&gt;&gt;l&gt;&gt;r;
</span><span class="cm">            cout&lt;&lt;query_n(l,r,0,10-1,root)&lt;&lt;endl;
</span><span class="cm">        }
</span><span class="cm">    }
</span><span class="cm">    */</span>

    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="o">&gt;&gt;</span><span class="n">sel</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">bprefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">bprefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">num</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="c1">//discrete
</span><span class="c1"></span>        <span class="n">sort</span><span class="p">(</span><span class="n">bprefix</span><span class="p">,</span><span class="n">bprefix</span><span class="o">+</span><span class="n">nlen</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">rlen</span><span class="o">=</span><span class="n">unique</span><span class="p">(</span><span class="n">bprefix</span><span class="p">,</span><span class="n">bprefix</span><span class="o">+</span><span class="n">nlen</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">bprefix</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">nlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">bprefix</span><span class="p">,</span><span class="n">bprefix</span><span class="o">+</span><span class="n">rlen</span><span class="p">,</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">bprefix</span><span class="p">;</span>

        


        <span class="c1">//binary
</span><span class="c1"></span>        <span class="n">ll</span> <span class="n">l</span><span class="o">=-</span><span class="mf">1e15</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mf">1e15</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">r</span><span class="p">){</span>
            <span class="n">ll</span> <span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">mid</span><span class="p">)){</span>
                <span class="n">r</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
            <span class="p">}</span><span class="k">else</span> <span class="n">l</span><span class="o">=</span><span class="n">mid</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">i</span><span class="o">=</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">check</span><span class="p">(</span><span class="n">i</span><span class="p">)){</span>
                <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å¤šç»„è¯¢é—®æ²¡æœ‰æ¸…ç†å¹²å‡€æ•°ç»„ï¼ŒWAäº†å¥½å‡ å‘ã€‚</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Fansblog</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/fansblog/" />
            <id>https://blog.kanari.moe/code/fansblog/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-08-01T15:15:00+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>Farmer John keeps a website called â€˜FansBlogâ€™ .Everyday , there are many people visited this blog.One day, he find the visits has reached P , which is a prime number.He thinks it is a interesting fact.And he remembers that the visits had reached another prime number.He try to find out the largest prime number Q ( Q &lt; P ) ,and get the answer of Q! Module P.But he is too busy to find out the answer. So he ask you for help. ( Q! is the product of all positive integers less than or equal to n: n! = n * (n-1) * (n-2) * (n-3) *â€¦ * 3 * 2 * 1 . For example, 4! = 4 * 3 * 2 * 1 = 24 )</p>
<p>First line contains an number T(1&lt;=T&lt;=10) indicating the number of testcases.
Then T line follows, each contains a positive prime number P (1e9â‰¤pâ‰¤1e14)</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>Farmer John keeps a website called â€˜FansBlogâ€™ .Everyday , there are many people visited this blog.One day, he find the visits has reached P , which is a prime number.He thinks it is a interesting fact.And he remembers that the visits had reached another prime number.He try to find out the largest prime number Q ( Q &lt; P ) ,and get the answer of Q! Module P.But he is too busy to find out the answer. So he ask you for help. ( Q! is the product of all positive integers less than or equal to n: n! = n * (n-1) * (n-2) * (n-3) *â€¦ * 3 * 2 * 1 . For example, 4! = 4 * 3 * 2 * 1 = 24 )</p>
<p>First line contains an number T(1&lt;=T&lt;=10) indicating the number of testcases.
Then T line follows, each contains a positive prime number P (1e9â‰¤pâ‰¤1e14)</p>
<h1 id="åˆ†æ">åˆ†æ</h1>
<p>è¿™é¢˜å¾—çŸ¥é“2ä¸ªç»“è®ºï¼Œç„¶è€Œæˆ‘éƒ½ä¸çŸ¥é“ã€‚</p>
<h2 id="å¨å°”é€Šå®šç†">å¨å°”é€Šå®šç†</h2>
<p>å½“Pä¸ºè´¨æ•°æ—¶ï¼Œ$(P-1)! \equiv -1 \pmod P$.</p>
<p>æ³¨æ„è¿™é‡Œ$!$æ˜¯é˜¶ä¹˜ï¼Œä¸æ˜¯å–åçš„æ„æ€ã€‚</p>
<h2 id="ç´ æ•°åˆ†å¸ƒ">ç´ æ•°åˆ†å¸ƒ</h2>
<p>å½“èŒƒå›´å˜å¤§æ—¶ï¼Œç´ æ•°çš„å‡ºç°é¢‘ç‡å¢é«˜ï¼Œå¯»æ‰¾ä¸€ç´ æ•°çš„ç›¸é‚»ç´ æ•°å¤æ‚åº¦é€æ¸è¶‹è¿‘äºçº¿æ€§ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¯»æ‰¾ç´ æ•°Pçš„å‰ä¸€ä¸ªç´ æ•°å¯ä»¥ç›´æ¥æš´åŠ›æ‰¾ã€‚æ‰¾åˆ°ä¹‹ååˆ©ç”¨$(P-1)! \equiv -1 \pmod P$å³å¯å¿«é€Ÿç”±$P-1$çš„é˜¶ä¹˜é€šè¿‡é€†å…ƒè½¬åˆ°$Q$çš„é˜¶ä¹˜ï¼Œè¿™é¢˜å°±åšå®Œäº†ã€‚</p>
<p>å› ä¸ºåœ¨è®¡ç®—é€†å…ƒæ—¶ä¼šçˆ†llï¼Œä½¿ç”¨å¿«é€Ÿä¹˜æ³•æ¥é¿å…ï¼Œå¤æ‚åº¦ç¬¦åˆè¦æ±‚ã€‚</p>
<h1 id="ä»£ç ">ä»£ç </h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">using</span> <span class="n">ll</span><span class="o">=</span><span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">qmul</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="n">ll</span> <span class="n">y</span><span class="p">,</span><span class="n">ll</span> <span class="n">q</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">y</span><span class="p">;</span><span class="n">y</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="p">(</span><span class="n">res</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">q</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>


<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">q</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">a</span><span class="p">;</span><span class="n">a</span><span class="p">;</span><span class="n">a</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">qmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">q</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">qmul</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">get_rev</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">,</span><span class="n">ll</span> <span class="n">q</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">qpow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="kt">bool</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="n">ll</span> <span class="nf">factor</span><span class="p">(</span><span class="n">ll</span> <span class="n">l</span><span class="p">,</span><span class="n">ll</span> <span class="n">r</span><span class="p">,</span><span class="n">ll</span> <span class="n">q</span><span class="p">){</span>
    <span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">ll</span> <span class="n">i</span><span class="o">=</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">res</span><span class="o">=</span><span class="n">qmul</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">q</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">kase</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">kase</span><span class="o">--</span><span class="p">){</span>
        <span class="n">ll</span> <span class="n">x</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="p">;</span>
        <span class="n">ll</span> <span class="n">prex</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">is_prime</span><span class="p">(</span><span class="n">prex</span><span class="p">))</span><span class="n">prex</span><span class="o">--</span><span class="p">;</span>

        <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="n">qmul</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">get_rev</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">prex</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">);</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">å’¸é±¼æ•°è®º</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/salt-fish-playing-number/" />
            <id>https://blog.kanari.moe/code/salt-fish-playing-number/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-07-22T15:59:05+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[ä¸€äº›ç»“è®º $N!$çš„è´¨å› æ•°åˆ†è§£ä¸­æŸè´¨æ•°çš„æŒ‡æ•°ä¸º$\sum_{r=1}^{\inf}n/â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="ä¸€äº›ç»“è®º">ä¸€äº›ç»“è®º</h2>
<ul>
<li>$N!$çš„è´¨å› æ•°åˆ†è§£ä¸­æŸè´¨æ•°çš„æŒ‡æ•°ä¸º$\sum_{r=1}^{\inf}n/p^r $</li>
<li>çº¦æ•°ä¸ªæ•°ä¸ºè´¨å› æ•°æŒ‡æ•°+1çš„ä¹˜ç§¯ï¼Œå’Œä¸ºè´¨å› æ•°æšä¸¾æŒ‡æ•°æ¬¡å’Œçš„ä¹˜ç§¯ã€‚</li>
<li>è´¹é©¬å°å®šç†è¦æ±‚pæ˜¯è´¨æ•°</li>
</ul>
<h2 id="æ¬§æ‹‰å‡½æ•°">æ¬§æ‹‰å‡½æ•°</h2>
<p>å°äºxä¸”ä¸å…¶äº’è´¨çš„æ•°çš„ä¸ªæ•°</p>
<div>$$
\phi(x)=x\prod_{k=1}^n(1-\frac{1}{p_k})
$$</div>
<ul>
<li>$phi(1)=1$</li>
<li>$phi(p)=p-1$,å½“pä¸ºè´¨æ•°</li>
<li>$phi(2n)=phi(n)$</li>
<li>$phi(phi(phi...))))=1$</li>
</ul>
<p>å¯¹äºä»»æ„ç§¯æ€§å‡½æ•°$f(xy)=f(x)f(y)$ï¼Œå¯ä»¥ç­›ã€‚æ¬§æ‹‰å‡½æ•°éå®Œå…¨ç§¯æ€§å‡½æ•°ã€‚</p>
<ul>
<li>$phi(xy)=phi(x)(y-1)$,å½“xä¸yäº’è´¨</li>
<li>$phi(xy)=phi(x)y$,å½“xä¸yä¸äº’è´¨</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">no</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
        <span class="n">p</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
        <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">cnt</span><span class="o">&amp;&amp;</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="n">no</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
            <span class="n">phi</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">phi</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="æ‰©å±•æ¬§å‡ é‡Œå¾—">æ‰©å±•æ¬§å‡ é‡Œå¾—</h2>
<ul>
<li>å­˜åœ¨xï¼Œyä½¿å¾—ax+by=gcdï¼ˆaï¼Œbï¼‰</li>
<li>æ±‚é€†å…ƒï¼Œè¦æ±‚xä¸æ¨¡æ•°äº’è´¨</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">exgcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">b</span><span class="p">){</span>
        <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">exgcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="o">%</span><span class="n">b</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
        <span class="n">y</span><span class="o">-=</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="é€’æ¨é€†å…ƒ">é€’æ¨é€†å…ƒ</h2>
<p>inv(i) = inv(mod % i) * (mod-mod/i) % mod;</p>
<ul>
<li>é˜¶ä¹˜çš„é€†å…ƒï¼šinv(i)=inv(i+1)*(i+1)</li>
</ul>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æ°´çš„åˆé›† 1</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/water-series/" />
            <id>https://blog.kanari.moe/code/water-series/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-07-22T15:59:04+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[é›†åˆæŒ‘é€‰ ä»ç»™å®šçš„Nä¸ªé›†åˆä¸­å„æŒ‘å‡ºä¸€ä¸ªæ•°å¹¶æ±‚å’Œï¼Œæ±‚å‡ºå‰$K$å¤§çš„$K$ä¸ªå’Œã€‚ è€ƒè™‘å¦‚ä½•ä»â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<h2 id="é›†åˆæŒ‘é€‰">é›†åˆæŒ‘é€‰</h2>
<p>ä»ç»™å®šçš„Nä¸ªé›†åˆä¸­å„æŒ‘å‡ºä¸€ä¸ªæ•°å¹¶æ±‚å’Œï¼Œæ±‚å‡ºå‰$K$å¤§çš„$K$ä¸ªå’Œã€‚</p>
<p>è€ƒè™‘å¦‚ä½•ä»2ä¸ªé›†åˆ$A$,$B$ä¸­é€‰å‡ºå‰$K$å¤§ã€‚é™åºæ’åºå$a_1$å’Œ$b_1$æ˜¾ç„¶æ˜¯æœ€å¤§ï¼Œç¬¬äºŒå¤§åˆ™æ˜¯$(a_1,b_2)$æˆ–è€…$(a_2,b_1)$ã€‚ä¸å¦¨ä»¥$(a_1,b_2)$æ¥è®²ï¼Œé‚£ä¹ˆç¬¬ä¸‰å¤§ç«äº‰è€…é™¤$(a_2,b_1)$è¿˜æœ‰$(a_1,b_3)$ï¼Œ$(a_2,b_3)$â€¦â€¦æ¯å¯¹ç»„åˆéƒ½èƒ½æ‰¾åˆ°ç›´æ¥å°äºå®ƒçš„2ä¸ªç»„åˆï¼Œè€Œè¿™ç§åç»§å…³ç³»æ˜¾ç„¶å–éäº†æ‰€æœ‰ç»„åˆã€‚ä»…éœ€è¦å‰Kå¤§çš„æˆ‘ä»¬æŒ‰éœ€æ‰©å±•è¿™ä¸€æ£µæ ‘å³å¯ã€‚2ä¸ªé›†åˆçš„å‰Kå¤§å¯ä¸ç¬¬3ä¸ªé›†åˆæ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œä»è€Œå¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚å®é™…ç¼–å†™æ—¶ï¼ŒæŒ‰ç…§ä¸€å®šé¡ºåºé™åˆ¶æ‰©å±•æ–¹å‘æ¥ä¿è¯æ¯ä¸ªæ–¹æ¡ˆä»…è®¿é—®ä¸€æ¬¡ï¼Œä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤ï¼Œå¤æ‚åº¦ä¸º$O(\sum^N{K\log n_k}) \leq O(KN)$</p>
<h2 id="lisä¼˜åŒ–">LISä¼˜åŒ–</h2>
<div>$$f(i)=max\{f(j)| j < i, a(j) < a(i) \}+1$$</div>
<p>å¯ä»¥å‘ç°ï¼Œä¸€æ—¦æœ‰$a(k) &lt; a(j), f(k) \geq f(j)$ï¼Œjè¿™ä¸ªä½ç½®å°±æ²¡æœ‰ç”¨äº†ã€‚æŒ‰ç…§è¯¥è§„å¾‹ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆè®°å½•ï¼Œä»¥é•¿åº¦å•è°ƒï¼ˆåˆ™æ•°å­—aç»“å°¾çš„LISè‡ªç„¶å•è°ƒï¼‰ã€‚æ­¤åè½¬ç§»</p>
]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">[BUPT WARMUP|CF] çç å¥¶èŒ¶</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/bupt-warmupcf-milktea/" />
            <id>https://blog.kanari.moe/code/bupt-warmupcf-milktea/</id>
            <updated>2020-04-08T20:49:53+08:00</updated>
            <published>2019-07-20T17:12:40+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>ç»™å‡ºä¸€ä¸ª$N \times N$çš„éè´Ÿæ•´æ•°çŸ©é˜µï¼Œè¦æ±‚æ‰¾åˆ°ä¸€æ¡ä»å·¦ä¸Šè§’æ•°å­—åˆ°å³ä¸‹è§’æ•°å­—çš„è·¯çº¿ï¼Œä¸”</p>
<ul>
<li>åªèƒ½å‘å³æˆ–è€…ä¸‹èµ°ã€‚</li>
<li>å°†ç»è¿‡æ•°å­—ç›¸ä¹˜åå¾—åˆ°çš„ç»“æœï¼Œä½¿å…¶æœ«å°¾çš„â€œ0â€æœ€å°‘ã€‚</li>
</ul>
<div>$$
N \leq 1000
$$</div>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ç»™å‡ºä¸€ä¸ª$N \times N$çš„éè´Ÿæ•´æ•°çŸ©é˜µï¼Œè¦æ±‚æ‰¾åˆ°ä¸€æ¡ä»å·¦ä¸Šè§’æ•°å­—åˆ°å³ä¸‹è§’æ•°å­—çš„è·¯çº¿ï¼Œä¸”</p>
<ul>
<li>åªèƒ½å‘å³æˆ–è€…ä¸‹èµ°ã€‚</li>
<li>å°†ç»è¿‡æ•°å­—ç›¸ä¹˜åå¾—åˆ°çš„ç»“æœï¼Œä½¿å…¶æœ«å°¾çš„â€œ0â€æœ€å°‘ã€‚</li>
</ul>
<div>$$
N \leq 1000
$$</div>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>å¤§æ¦‚æ˜¯å› ä¸ºæœ«å°¾çš„0é•¿å¾—åƒçç ã€‚</p>
<p>æ€è€ƒ0æ˜¯æ€ä¹ˆå‡ºç°çš„ï¼Œå¯ä»¥å‘ç°ç»“æœä¸­å› æ•°10çš„æŒ‡æ•°è¶Šå°è¶Šå¥½ï¼Œå³ï¼Œä½¿å¾—ç»è¿‡çš„è·¯ä¸Šå‡‘å‡ºçš„å› æ•°10æœ€å°‘å³å¯ã€‚10çš„è´¨å› æ•°åˆ†è§£ä¸º$2 \times 5$ï¼Œä»¥çŸ©é˜µä¸­æ¯ä¸ªæ•°æ‰€å«å› æ•°2å’Œ5çš„æ•°ç›®åˆ†åˆ«DPä¸€éæ±‚è·¯å¾„ï¼Œå†åœ¨ä¸¤æ¬¡DPçš„ç»“æœä¸­å–å°ã€‚</p>
<p>ä¸€ä¸ªç‰¹æ®Šæƒ…å†µæ˜¯æ•°å­—é‡Œæœ‰0ï¼Œé‚£ä¹ˆç»è¿‡0çš„è·¯çš„æœ«å°¾0ä¸€å®šæ˜¯1ä¸ªâ€¦â€¦ä¸€å¼€å§‹è„‘è¢‹æŠ½äº†ä»¥ä¸ºæ˜¯0ä¸ªã€‚å¦‚æœå…¶ä»–æƒ…å†µçš„è·¯å¾„æœ«å°¾0éƒ½å¤šäº1ä¸ªçš„è¯ï¼Œå°±ç‰¹åˆ¤èµ°0ã€‚</p>
<h2 id="ä»£ç ">ä»£ç </h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">1010</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">game</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">num</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">cal</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">fac</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="o">%</span><span class="n">fac</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
        <span class="n">x</span><span class="o">/=</span><span class="n">fac</span><span class="p">;</span>
        <span class="n">res</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">dp</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">from</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">dodp</span><span class="p">(</span><span class="kt">int</span> <span class="n">fac</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mh">0x3f3f3f3f</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]){</span>
                <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">num</span><span class="p">[</span><span class="n">fac</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">string</span> <span class="nf">genpath</span><span class="p">(){</span>
    <span class="n">string</span> <span class="n">res</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="n">n</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="n">i</span><span class="o">!=</span><span class="mi">1</span> <span class="o">||</span> <span class="n">j</span><span class="o">!=</span><span class="mi">1</span> <span class="p">;</span><span class="n">p</span><span class="o">=</span><span class="n">from</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="o">==</span><span class="mi">2</span><span class="p">){</span>
            <span class="n">res</span><span class="o">+=</span><span class="s">&#34;D&#34;</span><span class="p">;</span>
            <span class="n">i</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">res</span><span class="o">+=</span><span class="s">&#34;R&#34;</span><span class="p">;</span>
            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">reverse</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">res</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">haszero</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">zeroi</span><span class="p">,</span><span class="n">zeroj</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">haszero</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">zeroi</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">zeroj</span><span class="o">=</span><span class="n">j</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">cal</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="mi">2</span><span class="p">);</span>
            <span class="n">num</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">cal</span><span class="p">(</span><span class="n">game</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="mi">5</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="mh">0x7f7f7f7f</span><span class="p">;</span>
    <span class="n">dodp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">string</span> <span class="n">P</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="o">&gt;</span><span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]){</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">];</span>
        <span class="n">P</span><span class="o">=</span><span class="n">genpath</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">dodp</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="o">&gt;</span><span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]){</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">];</span>
        <span class="n">P</span><span class="o">=</span><span class="n">genpath</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="n">haszero</span> <span class="o">&amp;&amp;</span> <span class="n">ans</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">){</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">zeroi</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;D&#34;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">zeroj</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;R&#34;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">zeroi</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;D&#34;</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">zeroj</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;R&#34;</span><span class="p">;</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">P</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                        
                            
                            
                            
                                <category scheme="https://blog.kanari.moe/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" term="åŠ¨æ€è§„åˆ’" label="åŠ¨æ€è§„åˆ’" />
                            
                        
                    
                
            
        </entry>
    
        <entry>
            <title type="text">Colorful Tree</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/code/colorful-tree/" />
            <id>https://blog.kanari.moe/code/colorful-tree/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-07-12T14:04:50+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[There is a tree having n nodes, the i-th node of which has a type of color, denoted by an integer $c_i$ The path between every two nodes is unique, of which we define the value is the number of distinct typesâ€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>There is a tree having n nodes, the i-th node of which has a type of color, denoted by an integer $c_i$</p>
<p>The path between every two nodes is unique, of which we define the value is the number of distinct types of colors appearing on it.</p>
<p>Calculate the sum of values of all possible paths, $\frac{n(n-1)}{2}$ in total, between two different nodes on the tree.</p>
<h2 id="è¾“å…¥èŒƒå›´">è¾“å…¥èŒƒå›´</h2>
<p>å¤šç»„æ•°æ®,çº¦50;èŠ‚ç‚¹æ•°$2 \times 10^5$.</p>
<h1 id="åˆ†æ">åˆ†æ</h1>
<p>æ²¡æƒ³å‡ºæ¥è¯¥æ€ä¹ˆåš.ç»Ÿè®¡è·¯å¾„é¢œè‰²çš„ç­”æ¡ˆæ²¡æœ‰ä»€ä¹ˆåˆå¹¶çš„å¥½æ–¹æ³•,åŒæ—¶ä¹Ÿä¸èƒ½æŒ‰ç…§æ¯ç§é¢œè‰²å•ç‹¬è€ƒè™‘.</p>
<p>åæ¥ç»è¿‡dalaoç‚¹æ‹¨,è¯¥é¢˜ä¸­çš„&quot;ç»Ÿè®¡ä¸€æ¡è·¯å¾„ä¸Šé¢œè‰²ç§ç±»&quot;çš„è¦æ±‚å¯ä»¥è½¬åŒ–ä¸ºæ±‚å…¶<strong>åé¢</strong>&quot;æ²¡æœ‰æŸç§é¢œè‰²çš„è·¯å¾„æœ‰å¤šå°‘ç§&quot;.</p>
<p>å¦‚æ­¤,å¯¹äºæ¯ä¸€ç§é¢œè‰²å°±å¯ä»¥ä½¿ç”¨$n(n-1)/2-size$æ¥æ±‚å…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®äº†.So,æ¥è§£å†³è¿™ä¸ªé—®é¢˜.</p>
<p>åŸå›¾æ˜¯ä¸€æ£µæ ‘,å¦‚æœæŸç‚¹$N$ä¸ºé¢œè‰²$c$,é‚£ä¹ˆç»è¿‡$N$çš„å­æ ‘ä»»æ„ç‚¹è·¨è¶Š$N$çš„è·¯å¾„éƒ½æœ‰è¯¥é¢œè‰².æ‰€æœ‰ä¸åŒ…æ‹¬è¯¥é¢œè‰²$c$çš„è·¯å¾„åª<strong>èƒ½</strong>å‡ºç°åœ¨ä»¥$N$ä¸ºåˆ‡ç‚¹çš„å…¶ä»–2éƒ¨åˆ†.è€ƒè™‘å…¶ä¸­ä¸€ä¸ªéƒ¨åˆ†,ä»»æ„é€‰ä¸­å…¶ä¸­2ä¸ªèŠ‚ç‚¹å³å¯æ„å»ºä¸€æ¡è·¯å¾„,ä½†è¿˜æ˜¯å¿…é¡»æ»¡è¶³åˆšåˆšçš„æ¡ä»¶(ä¸èƒ½è·¨è¶Šé¢œè‰²$c$çš„èŠ‚ç‚¹).ä»¥dfsé€’å½’è¿›å»å³å¯.</p>
<p>è€ƒè™‘èƒ½å¦é€’å½’åˆå¹¶å·²æœ‰ç­”æ¡ˆ.èƒ½å¤Ÿå¾—åˆ°çš„æ•°æ®æœ‰<em>å­èŠ‚ç‚¹ä¸­2éƒ¨åˆ†çš„èŠ‚ç‚¹æ•°ç›®</em>,æ˜¾ç„¶èƒ½å¤Ÿåˆå¹¶å‡ºä»¥å½“å‰èŠ‚ç‚¹ä¸ºç•Œåˆ’åˆ†çš„2éƒ¨åˆ†ä¸­çš„ä¸€éƒ¨åˆ†,è‡ªç„¶å¯ä»¥åœ¨é€’å½’è¿”å›åæ¨å‡ºå¦ä¸€éƒ¨åˆ†.</p>
<h1 id="ä»£ç ">ä»£ç </h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXV</span><span class="o">=</span><span class="mi">200010</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">adde</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">v</span><span class="p">){</span>
    <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">color</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">sz</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">gsz</span><span class="p">;</span>
<span class="n">ll</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">fa</span><span class="p">){</span>
    <span class="n">gsz</span><span class="o">++</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">v</span><span class="p">:</span><span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">]){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="o">==</span><span class="n">fa</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">ll</span> <span class="n">b_gsz</span><span class="o">=</span><span class="n">gsz</span><span class="p">;</span>
        <span class="n">ll</span> <span class="n">b_sz</span><span class="o">=</span><span class="n">sz</span><span class="p">[</span><span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]];</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>

        <span class="n">ll</span> <span class="n">d</span><span class="o">=</span><span class="p">(</span><span class="n">gsz</span><span class="o">-</span><span class="n">b_gsz</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span><span class="o">-</span><span class="n">b_sz</span><span class="p">);</span>
        <span class="n">res</span><span class="o">+=</span><span class="n">d</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span><span class="o">+=</span><span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sz</span><span class="p">[</span><span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">flag</span><span class="p">[</span><span class="n">MAXV</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">kase</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">sz</span><span class="p">));</span>
        <span class="n">gsz</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

        <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">discol</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">flag</span><span class="p">[</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="n">discol</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">u</span><span class="o">&gt;&gt;</span><span class="n">v</span><span class="p">;</span>
            <span class="n">adde</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">);</span>
            <span class="n">adde</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kt">int</span> <span class="n">disnum</span><span class="o">=</span><span class="n">discol</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
        <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">disnum</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">i</span><span class="p">:</span><span class="n">discol</span><span class="p">){</span>
            <span class="n">ll</span> <span class="n">t</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="n">sz</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">ans</span><span class="o">-=</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;Case #&#34;</span><span class="o">&lt;&lt;++</span><span class="n">kase</span><span class="o">&lt;&lt;</span><span class="s">&#34;: &#34;</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="o">-</span><span class="n">res</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/code/" term="code" label="code" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/study/fast-fourier-transform/" />
            <id>https://blog.kanari.moe/study/fast-fourier-transform/</id>
            <updated>2020-04-08T10:10:27+08:00</updated>
            <published>2019-07-12T14:03:22+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<blockquote>
<p>å†™ä»£ç æ˜¯ä¸å¯èƒ½å†™ä»£ç çš„,ä»Šä¸‹åˆæ˜¯ä¸æƒ³å†™ä»£ç çš„.ä¸æƒ³å†™ä»£ç ,åˆä¸æƒ³å’¸é±¼,å°±åªèƒ½é å­¦ç‚¹æ–°ä¸œè¥¿æ¥å‡è£…è‡ªå·±åœ¨å·¥ä½œçš„æ ·å­,å¿ƒé‡Œæ‰èƒ½å¥½å—äº›.</p>
<blockquote>
<p>çªƒæ ¼ç æ‹‰</p>
</blockquote>
</blockquote>
<p>å‡ ä¹å¯ä»¥è‚¯å®š,ä¸‹é¢çš„å†…å®¹è‚¯å®šä¼šå‡ºé”….</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<blockquote>
<p>å†™ä»£ç æ˜¯ä¸å¯èƒ½å†™ä»£ç çš„,ä»Šä¸‹åˆæ˜¯ä¸æƒ³å†™ä»£ç çš„.ä¸æƒ³å†™ä»£ç ,åˆä¸æƒ³å’¸é±¼,å°±åªèƒ½é å­¦ç‚¹æ–°ä¸œè¥¿æ¥å‡è£…è‡ªå·±åœ¨å·¥ä½œçš„æ ·å­,å¿ƒé‡Œæ‰èƒ½å¥½å—äº›.</p>
<blockquote>
<p>çªƒæ ¼ç æ‹‰</p>
</blockquote>
</blockquote>
<p>å‡ ä¹å¯ä»¥è‚¯å®š,ä¸‹é¢çš„å†…å®¹è‚¯å®šä¼šå‡ºé”….</p>
<h2 id="å‚…é‡Œå¶å˜æ¢çš„å®é™…æ„ä¹‰">å‚…é‡Œå¶å˜æ¢çš„å®é™…æ„ä¹‰</h2>
<h3 id="ä»ç”µå‹è¯´èµ·">ä»ç”µå‹è¯´èµ·</h3>
<p>è¢«æ¨¡ç”µæŠ˜ç£¨çš„åŒå­¦éƒ½çŸ¥é“,æœ‰ç§ä¸œè¥¿å«åšå‚…é‡Œå¶çº§æ•°,å¯ä»¥å°†æˆå‘¨æœŸæ€§å˜åŒ–çš„ç”µå‹åˆ†è§£ä¸ºæ•°ä¸ªä¸‰è§’å‡½æ•°æ³¢çš„å åŠ .</p>
<p>åœ¨è¿™é‡Œ,æˆ‘ä»¬æå‡ºå¦ä¸€ä¸ªé—®é¢˜,å¦‚æœä¸çŸ¥é“å‘¨æœŸ,è¯¥å¦‚ä½•å°†è¿™äº›å åŠ åœ¨ä¸€èµ·çš„ä¿¡å·æ‹†åˆ†ä¸ºå•çº¯çš„ä¸‰è§’æ³¢?</p>
<blockquote>
<p>ä¸‰è§’æ³¢å åŠ å›¾è±¡å‘¨æœŸå¹¶ä¸é‚£ä¹ˆæ˜¾ç„¶,ä¹Ÿè®¸ä½ å¯ä»¥è¯•ä¸€è¯•.</p>
</blockquote>
<h3 id="ä¸€ç§ç¼ ç»•æœº">ä¸€ç§ç¼ ç»•æœº</h3>
<p>æœ‰ä¸€ç§å¥‡ç‰¹çš„æ–¹æ³•,æˆ‘ä»¬å°†ä¸€æ®µ<code>æ—¶åŸŸå›¾è±¡</code>åœ¨ç¬›å¡å°”åæ ‡ç³»ä¸Šä»¥åŸç‚¹ä¸ºåœ†å¿ƒ<strong>ç»•</strong>èµ·æ¥,ä¸€åœˆä¸€åœˆç¼ èµ·æ¥,ç„¶åè°ƒæ•´æºå›¾è±¡ç¼ ç»•çš„é€Ÿç‡(å‡ ç§’ä¸€åœˆ),è§‚å¯Ÿæ•´ä¸ªå›¾å½¢çš„<strong>è´¨å¿ƒ</strong>å˜åŒ–.</p>
<p>è¿™ä¸ªè´¨å¿ƒä¼šéšç€å›¾è±¡ç¼ ç»•çš„é¢‘ç‡è€Œå‘ç”Ÿä½ç§».å–è´¨å¿ƒçš„xåæ ‡ä¸ºyè½´,ä»¥ç¼ ç»•çš„é¢‘ç‡ä¸ºæ¨ªè½´,ä½œå‡ºå›¾è±¡<code>B</code>.åœ¨è¿™ä¸ªå›¾è±¡ä¸Š,ä¼šè§‚æµ‹åˆ°ä¸€ä¸ªç°è±¡:(å‡è®¾æˆ‘ä»¬å·²çŸ¥åŸå›¾åƒçš„åˆ†è§£ä¸‰è§’æ³¢é¢‘ç‡)å½“ç¼ ç»•é¢‘ç‡æ¥è¿‘æŸä¸ªæºä¸‰è§’æ³¢çš„é¢‘ç‡æ—¶,ç¼ ç»•å›¾è±¡å‡ºç°<strong>é‡åˆ</strong>,è´¨å¿ƒç›¸å¯¹åŸç‚¹å‡ºç°è¾ƒå¤§ä½ç§»,å›¾è±¡å‡ºç°ä¸€ä¸ª<strong>å³°å€¼</strong>.</p>
<p>ç»§ç»­è°ƒæ•´ç¼ ç»•é¢‘ç‡,å³°å€¼æ¶ˆå¤±,å›¾è±¡å›å½’åˆ°å°èŒƒå›´æ³¢åŠ¨.</p>
<p>é€šè¿‡è§‚å¯Ÿå›¾è±¡<code>B</code>,å¯ä»¥è®¤ä¸º,å‡ºç°å³°å€¼çš„é¢‘ç‡å¯¹åº”ç€ä¸€ä¸ªé¢‘ç‡çš„æºä¸‰è§’æ³¢.å¦‚æ­¤,å°±å°†å åŠ å›¾è±¡è¿˜åŸäº†å›å».</p>
<h2 id="å‚…é‡Œå¶å˜æ¢çš„æ•°å­¦å®ç°">å‚…é‡Œå¶å˜æ¢çš„æ•°å­¦å®ç°</h2>
<p>ç°åœ¨,è€ƒè™‘å¦‚ä½•é€šè¿‡çš„æ•°å­¦çš„æ–¹æ³•æ¥å®ç°è¿™ä¸ªç¼ ç»•.</p>
<h3 id="å¦‚ä½•ç¼ ç»•">å¦‚ä½•ç¼ ç»•</h3>
<p>å°†$g(t)$çš„å›¾è±¡ç¼ ç»•åˆ°åœ†ä¸Šå¬èµ·æ¥æŒºå¥‡æ€ªçš„,æœ‰è¿™æ ·çš„æ•°å­¦æ–¹æ³•å—.</p>
<p>æœ‰ä¸€ä¸ªä¸œè¥¿,å«åš$y=e^{ix}$.å½“å…¶å›¾è±¡ç”»åœ¨å¤å¹³é¢æ—¶,å°±å‡ºç°äº†æœ‰è¶£çš„äº‹æƒ…:ä¸€ä¸ªåœ†.å¯¹è¿™ä¸ªå…¬å¼åšä¸€äº›åŠ å·¥.</p>
<div>$$
y=g(t)e^{-2\pi i ft}
$$</div>
<p>å¦‚æ­¤,å°±èƒ½å¤Ÿå°†$g(t)$ä»¥$f$é¢‘ç‡ç¼ ç»•.</p>
<h3 id="å…³äºè´¨å¿ƒ">å…³äºè´¨å¿ƒ</h3>
<p>ä¸Šæ–‡æˆ‘ä»¬å–è´¨å¿ƒçš„xåæ ‡ä½œå›¾,ç°åœ¨éœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹.</p>
<p>å®é™…ä¸Š,æˆ‘ä»¬å…³å¿ƒçš„æ˜¯è´¨å¿ƒç›¸å¯¹äºåŸç‚¹çš„åç§»<strong>è·ç¦»</strong>.åŒæ ·,ä»¥å¤å¹³é¢çš„æ–¹å¼æ¥è¡¨ç¤ºè´¨å¿ƒä½ç½®å°±èƒ½å¤ŸåŒæ—¶ä¿ç•™xå’Œyåæ ‡ä¿¡æ¯.</p>
<p>å…³äºå¦‚ä½•æ±‚å–è´¨å¿ƒ,å…¶å®ä¹Ÿå¾ˆç›´è§‚.é€‰å–ç¼ ç»•å›¾è±¡ä¸Šçš„æ•°ä¸ªç‚¹,å–å¹³å‡,å°±æ˜¯è´¨å¿ƒçš„å¤§çº¦ä½ç½®.å½“ç‚¹çš„æ•°ç›®è¾¾åˆ°æé™,æ±‚å’Œå…¬å¼åŒ–ä¸ºç§¯åˆ†,æ‰€æ±‚å³ä¸ºè´¨å¿ƒ.</p>
<div>$$
\hat g(f)=\frac{1}{t_2-t_1} \int_{t_1}^{t_2}{g(t)e^{-2\pi i ft}}
$$</div>
<h3 id="heading">?</h3>
<p>ç›®å‰ä¸ºæ­¢,è¿™å‡ ä¹å·²ç»æ˜¯å‚…é‡Œå¶å˜æ¢äº†.åœ¨æ•°å­¦åº”ç”¨æ—¶,å‚…é‡Œå¶å˜æ¢ä¼šå»æ‰å–å‡å€¼,å³</p>
<div>$$
\hat g(f)=\int_{t_1}^{t_2}{g(t)e^{-2\pi i ft}}
$$</div>
<p>ä¹Ÿå°±æ˜¯è¯´,å–æ ·çš„æ—¶åŸŸä¿¡å·è¶Šé•¿,è¯¥è´¨å¿ƒçš„åç§»å€¾å‘è¶Šå¤§,è¿™å’Œæˆ‘ä»¬æƒ³è¦çš„æ•ˆæœä¸€è‡´.</p>
<p>è¿™å°±æ˜¯å‚…é‡Œå¶å˜æ¢,å®ç°äº†<code>æ—¶åŸŸä¿¡å·</code>åˆ°<code>é¢‘åŸŸä¿¡å·</code>çš„è½¬æ¢.</p>
<p>æ­¤å¤–,è¿˜æœ‰æ–¹æ³•å°†é¢‘åŸŸä¿¡å·å†æ¬¡é€†å˜æ¢ä¸ºæ—¶åŸŸä¿¡å·çš„æ–¹æ³•.</p>
<h2 id="åº”ç”¨">åº”ç”¨</h2>
<p>å‚…é‡Œå¶å˜æ¢åœ¨å¾ˆå¤šé¢†åŸŸéƒ½æœ‰é‡è¦ä½œç”¨.åªè¦é—®é¢˜èƒ½è½¬æ¢ä¸ºæ—¶åŸŸé¢‘åŸŸä¹‹é—´çš„å˜åŒ–,å°±æœ‰å‚…é‡Œå¶å˜æ¢çš„ç”¨æ­¦ä¹‹å¤„.</p>
<p>æ¯”å¦‚,åœ¨éŸ³é¢‘å¤„ç†è½¯ä»¶ä¸­,å¸¸å¸¸æœ‰ä¸€ä¸ªåŠŸèƒ½å«åš<code>æ¶ˆé™¤äººå£°</code>.åŸºäºå‚…é‡Œå¶å˜æ¢æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ª(è‡³å°‘ç†è®ºä¸Šæœ‰ç”¨)çš„ç®—æ³•.</p>
<p>é¦–å…ˆ,ä»»ä½•å£°éŸ³éƒ½æ˜¯ç›¸åº”é¢‘ç‡çš„æ³¢å¯¹æ°”å‹å˜åŒ–å¼•èµ·çš„,ä¹Ÿå°±æ˜¯ä¸åŒ<strong>é¢‘ç‡</strong>çš„æ³¢åœ¨<strong>æ—¶é—´</strong>ä¸Šå åŠ åœ¨ä¸€èµ·,äº§ç”Ÿäº†å£°éŸ³.å°†æºæ³¢ä½¿ç”¨å‚…é‡Œå¶å˜æ¢æ‹†åˆ†åˆ°å¤šä¸ªä¸‰è§’æ³¢ä¸Šå».<strong>åˆ é™¤äººå£°æ‰€åœ¨çš„é¢‘åŸŸ</strong>,å†å°†é¢‘åŸŸä¿¡å·é€†å˜æ¢ä¸ºæ—¶åŸŸä¿¡å·.äººå£°ä¾¿æ¶ˆå¤±äº†.</p>
<h2 id="ç¦»æ•£å‚…é‡Œå¶å˜æ¢">ç¦»æ•£å‚…é‡Œå¶å˜æ¢</h2>
<p>è¿ç»­æ„ä¹‰ä¸‹çš„å‚…é‡Œå¶å˜æ¢å…ˆåˆ°æ­¤ä¸ºæ­¢.åœ¨è®¡ç®—æœºä¸­æ‰€å¤„ç†çš„æ•°æ®ä¸€èˆ¬éƒ½æ˜¯ç¦»æ•£çš„.æˆ‘ä»¬éœ€è¦çš„æ˜¯ç¦»æ•£å‚…é‡Œå¶å˜æ¢.</p>
<p>ç¦»æ•£æ„ä¹‰ä¸‹çš„æ—¶åŸŸä¿¡å·å’Œé¢‘åŸŸä¿¡å·å°±éƒ½å˜æˆäº†ç‚¹é›†.å½“ä»è¿ç»­å‘ç¦»æ•£è¿‡æ¸¡æ—¶,å¯ä»¥è¿™æ ·æ€è€ƒ:</p>
<blockquote>
<p>åœ¨è¿ç»­çš„å›¾è±¡ä¸Šä»¥ä¸€å®šé—´éš”<strong>å–æ ·</strong>å¾—åˆ°ç¦»æ•£ç‚¹é›†.ä½¿ç”¨è¯¥ç‚¹é›†è¿›è¡Œå‚…é‡Œå¶å˜æ¢.</p>
</blockquote>
<p>è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸€å¼€å§‹é‡‡å–çš„è´¨å¿ƒæ±‚è§£æ–¹æ³•,åªä¸è¿‡,è¿™æ¬¡æˆ‘ä»¬ä»ç¼ ç»•æ—¶å°±å–æ ·.(è´¨ç‚¹ä¾ç„¶æ˜¯çœŸæ­£çš„è´¨ç‚¹)
å¯¹äºç‚¹é›†$g(0\leq n &lt; N)$,å®ƒçš„å‚…é‡Œå¶å˜åŒ–å°±æ˜¯</p>
<div>$$
\hat g(k)=\sum_{n=0}^{N-1}g(n)e^{-i\frac {2\pi}{N}nk}
$$</div>
<p>ç®€å•ç²—æš´.</p>
<h2 id="å¿«é€Ÿå‚…é‡Œå¶å˜æ¢">å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</h2>
<p>åœ¨äº†è§£äº†å…³äºå‚…é‡Œå¶å˜æ¢çš„ä¸€ç³»åˆ—èƒŒæ™¯ä¸ä¸€ä¸ªåº”ç”¨å,æˆ‘ä»¬å†å›æ¥è§£å†³ä¸€äº›é‡è¦çš„é—®é¢˜.</p>
<p>æ ¹æ®å‚…é‡Œå¶å˜æ¢çš„å…¬å¼å®šä¹‰</p>
<div>$$
\hat g(k)=\sum_{n=0}^{N-1}g(n)e^{-i\frac {2\pi}{N}nk}
$$</div>
<p>å…¶æœ´ç´ ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(N^2)$ è¿™ä¸ªå¤æ‚åº¦è¿˜ä¸å¤Ÿä¼˜ç§€.ä¸€ç§å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ç®—æ³•åˆ©ç”¨$e^{ix}$çš„æ€§è´¨,å°†å¤æ‚åº¦é™ä½åˆ°äº†$O(N\lg N)$.</p>
<h3 id="å•ä½æ ¹">å•ä½æ ¹</h3>
<p>ç»™$e^{ix}$ä¸ªåå­—.</p>
<p>åœ¨æ•°å­¦ä¸Š, $n$æ¬¡<strong>å•ä½æ ¹</strong>æ˜¯ $n$æ¬¡å¹‚ä¸º1çš„å¤æ•°.å®ƒä»¬ä½äºå¤å¹³é¢çš„å•ä½åœ†ä¸Š,æ„æˆæ­£nè¾¹å½¢çš„é¡¶ç‚¹,å…¶ä¸­ä¸€ä¸ªé¡¶ç‚¹æ˜¯1.</p>
<p>è®°</p>
<div>$$
\omega_{n,k}=-e^{i\frac{2\pi}{n}k}
$$</div>
<p>å…¶å‡ ä½•æ„ä¹‰ä¸ºå•ä½åœ†ä¸Šçš„nç­‰åˆ†ç‚¹çš„é¡ºæ—¶é’ˆç¬¬kä¸ª.</p>
<blockquote>
<p>ä¸€èˆ¬æ¥è¯´,å•ä½æ ¹å–é€†æ—¶é’ˆ,ä¸è¿‡è¿™é‡Œä¸ºäº†æ–¹ä¾¿,å–é¡ºæ—¶é’ˆ.</p>
</blockquote>
<p>å¦‚åŒä¸‰è§’å‡½æ•°ä¸€æ ·,å•ä½æ ¹å­˜åœ¨ä¸€äº›æ˜¾ç„¶çš„å®šç†.</p>
<p>**æŠ˜åŠ:**$\omega_{2n,2k}=\omega_{n,k}$</p>
<p>**åŒ–ç®€:**$\omega_{n,k+\frac 2n}=-\omega_{n,k}$</p>
<h4 id="ä¿®æ”¹å…¬å¼">ä¿®æ”¹å…¬å¼</h4>
<p>æ¥çœ‹åŸæœ¬çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢å…¬å¼</p>
<div>$$
\hat g(k)=\sum_{n=0}^{N-1}g(n)e^{-i\frac {2\pi}{N}nk}
$$</div>
<p>ä½¿ç”¨å•ä½æ ¹æ¥æ›¿æ¢ä¸€ä¸‹</p>
<div>$$
\hat g(k)=\sum_{n=0}^{N-1}\omega_{N,nk} g(n)
$$</div>
<p>æŒ‰ç…§<del>ç¥</del>åŒ–ç®€å…¬å¼çš„æŒ‡å¼•,å°†æ±‚å’Œå…¬å¼æŒ‰ç…§å•ä½æ ¹å¥‡å¶æ‹†åˆ†ä¸º2éƒ¨åˆ†.</p>
<div>$$
\begin{aligned}
\hat g(k) &= \sum_{n=0}^{N-1}\omega_{N,nk} g(n) \\
&= \sum_{0 \leq n < N}\omega_{N,nk} g(n) \\
&= \sum_{0 \leq 2n < N}\omega_{N,2nk} g(2n) + \sum_{0 \leq 2n+1 < N}\omega_{N,(2n+1)k} g(2n+1) \\
&=\sum_{0 \leq 2n < N}\omega_{N,2nk} g(2n) + \sum_{0 \leq 2n+1 < N}\omega_{N,2nk+k} g(2n+1) \\
&=\sum_{0 \leq 2n < N}\omega_{\frac N2,nk} g(2n) + \omega_{N,k}\sum_{0 \leq 2n+1 < N}\omega_{\frac N2,nk} g(2n+1) \\\\
&=\hat g_{even}(k)+\omega_{N,k} \hat g_{odd}(k)
\end{aligned}
$$</div>
<p>æ³¨æ„åˆ°ä¸ç®¡æ˜¯$\hat g_{even}(k)$è¿˜æ˜¯$\hat g_{even}(k)$,å®ƒä»¬éƒ½ä»¥$N/2$ä¸ºå‘¨æœŸ.æ¥ä¸‹æ¥,åº”ç”¨åŒ–ç®€å®šç†</p>
<div>$$
\hat g(k+\frac N2)=\hat g_{even}(k)-\omega_{N,k} \hat g_{odd}(k)
$$</div>
<p>å°†è¿™2ä¸ªå¼å­æ”¾åœ¨ä¸€èµ·</p>
<div>$$
\hat g(k)=\hat g_{even}(k)+\omega_{N,k} \hat g_{odd}(k) \\
\hat g(k+\frac N2)=\hat g_{even}(k)-\omega_{N,k} \hat g_{odd}(k)
$$</div>
<p>å½“kå–éåŸé—®é¢˜è§„æ¨¡çš„ä¸€åŠæ—¶,å¯ä»¥ç›´æ¥ç”±ç¬¬äºŒä¸ªå¼å­å¾—åˆ°å¦ä¸€åŠ.é—®é¢˜çš„è§„æ¨¡å‡åŠ.é€’å½’æ±‚è§£,æœ€ç»ˆçš„å¤æ‚åº¦å°±é™åˆ°äº†$O(N \lg N)$.</p>
<p>è¿™å°±æ˜¯<code>Cooley-Turkey</code>å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ç®—æ³•.</p>
<h2 id="å¿«é€Ÿä¹˜æ³•">å¿«é€Ÿä¹˜æ³•</h2>
<p>å®šä¹‰å¤šé¡¹å¼$A(x)=\sum_k a_kx^{k+1}$,$B(x)$åŒç†,æ±‚è§£$C(x)=A(x)B(x)$.</p>
<p>å¾ˆå®¹æ˜“çœ‹å‡º,æœ´ç´ ç®—æ³•çš„å¤æ‚åº¦ä¸º$O(N^2)$.</p>
<p>ç°åœ¨,æ¥çœ‹å¦‚ä½•ä½¿ç”¨FFTå¿«é€Ÿè®¡ç®—.</p>
<h3 id="ç‚¹å€¼è¡¨ç¤º">ç‚¹å€¼è¡¨ç¤º</h3>
<blockquote>
<p>å¯¹äºä¸€ä¸ªæ¬¡æ•°ä¸º$n-1$çš„å¤šé¡¹å¼,å…¶å›¾è±¡ä¸Šäº’ä¸ç›¸åŒçš„$n$ä¸ªç‚¹å¯ä»¥å”¯ä¸€ç¡®å®šè¯¥å¤šé¡¹å¼.
...
å¦‚åŒç¡®å®šæ··åˆåœ¨ä¸€èµ·çš„å‡ ä¸ªæ³¢ä¸€æ ·.</p>
</blockquote>
<p>è‡³äºä¸ºä»€ä¹ˆæ˜¯å¯¹çš„,å¤§å¯åœ¨Googleä¸Šæœç´¢ä¸€ç•ª.</p>
<p>å–$x$ä¸ºæ•°ä¸ªå•ä½æ ¹,åœ¨$A(x)$å’Œ$B(x)$ä¸Šåˆ©ç”¨å•ä½æ ¹çš„æ€§è´¨å¾—åˆ°$A$å’Œ$B$çš„ç‚¹å€¼è¡¨ç¤º,å°†ç‚¹å€¼ç›¸ä¹˜å¾—åˆ°$C$çš„ç‚¹å€¼è¡¨ç¤º.ä¹‹å,å°†$C$çš„ç‚¹å€¼è¡¨ç¤ºå†è½¬æ¢ä¸ºç³»æ•°è¡¨ç¤º.</p>
<p>å—¯?FFTåœ¨å“ª?</p>
<p>å…¶å®åœ¨è¿™é‡Œ,</p>
<div>$$
\hat g(\omega)=A(\omega)=\sum_{n}\omega A[x^{n+1}]
$$</div>
<h3 id="ç¦»æ•£å·ç§¯">ç¦»æ•£å·ç§¯</h3>
<p>æœ‰ä¸€ç§<strong>æ•°å­¦è¿ç®—</strong>,å«åš<strong>å·ç§¯</strong>.ç°åœ¨åªè®¨è®ºå®ƒçš„ç¦»æ•£æƒ…å†µ.</p>
<div>$$
(f * g)(n)=\sum_{\tau=-\inf}^{inf}f(\tau)g(n-\tau)
$$</div>
<p>è¿™ç©æ„çš„æ„ä¹‰...å®åœ¨æ˜¯ä¸æ€ä¹ˆæ˜æ˜¾.ä¸è¿‡å¥½åœ¨æˆ‘ä»¬åªæ˜¯æƒ³ç®—ä¸ªå¤šé¡¹å¼ä¹˜æ³•,ä¹Ÿå°±æ˜¯æŠŠå¤šé¡¹å¼çš„<strong>ç³»æ•°</strong>ç®—æ¥ç®—å»:</p>
<p>$C[x^n]$ è¡¨ç¤ºå¤šé¡¹å¼$C$ä¸­$x^n$é¡¹çš„ç³»æ•°.</p>
<div>$$
C[x^{n}]=\sum_{\tau=0}^{n}A[x^\tau]B[x^{n-\tau}]
$$</div>
<p>å—¯?</p>
<p>å¦‚æœæˆ‘ä»¬è®¾å¤šé¡¹å¼ä¸­ä¸å­˜åœ¨çš„é¡¹çš„ç³»æ•°ä¸º0çš„è¯.</p>
<div>$$
C[x^{n}]=\sum_{\tau=-\inf}^{\inf}A[x^\tau]B[x^{n-\tau}]
$$</div>
<p>å“ˆ,</p>
<div>$$
C[x^n]=(A*B)[x^n]
$$</div>
### å·ç§¯å®šç†
å·ç§¯å®šç†æŒ‡å‡º:
<blockquote>
<p>ä¸€ä¸ªåŸŸä¸­çš„å·ç§¯å¯¹åº”äºå¦ä¸€ä¸ªåŸŸä¸­çš„ä¹˜ç§¯.</p>
</blockquote>
<p>è¿™æ„å‘³ç€,ä¸Šé¢è¿™ä¸ªè®¡ç®—(å·ç§¯)å¯¹åº”ç€å¦ä¸€ä¸ªåŸŸé‡Œçš„ä¹˜ç§¯.ä¹Ÿå°±æ˜¯</p>
<div>$$
F(C[x^n])=F(A[x^n]) \cdot F(B[x^n])
$$</div>
<p>è¿™ä¾¿æ˜¯æ·±å±‚åŸç†.å¯¹Aå’ŒBçš„å–æ ·(é¢‘åŸŸ)ç§°ä¸ºAå’ŒBçš„ç‚¹å€¼è¡¨ç¤º,æœ€ç»ˆä»¥ä¹˜ç§¯çš„æ–¹å¼å¾—åˆ°äº†Cçš„ç‚¹å€¼è¡¨ç¤º(é¢‘åŸŸ).ç”¨FFTæ¥è®¡ç®—ä¹˜æ³•çš„è¯´æ³•æ˜¯å¯¹çš„.</p>
<h2 id="å‚…é‡Œå¶é€†å˜æ¢">å‚…é‡Œå¶é€†å˜æ¢</h2>
<p>å¦‚ä½•ä»ä¸€ä¸ªé¢‘åŸŸä¿¡å·å†å¾—åˆ°æ—¶åŸŸä¿¡å·?</p>
<div>$$
g(n)=\frac 1N\sum_{k=0}^{N-1}e^{i\frac{2\pi}{N}nk} \hat g(k)
$$</div>
<blockquote>
<p>æ³¨æ„:æ­¤å¤„çš„1/Nä¸ä¸Šé¢çš„å˜æ¢æ˜¯ç›¸åŒ¹é…çš„.</p>
</blockquote>
<p>è¿™ä¸ªå¼å­å¯ä»¥ç†è§£æˆå¯¹å˜æ¢åçš„å¼å­å†å˜æ¢,æ„å‘³ç€å®ƒåŒæ ·å¯ä»¥ç”¨å˜æ¢æ—¶çš„æ€æƒ³æ¥åŠ é€Ÿ.</p>
<h2 id="fftçš„cå®ç°">FFTçš„C++å®ç°</h2>
<p>ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„é—®é¢˜å°±æ˜¯,å¯¹äºå•ä½æ ¹çš„è¿ç®—æ¶‰åŠåˆ°äº†ç²¾åº¦çš„é—®é¢˜.ä½†ç›®å‰è¿˜ä¸éœ€è¦è®¨è®º.</p>
<h3 id="ç¿»è½¬æ“ä½œ">ç¿»è½¬æ“ä½œ</h3>
<p>å¯ä»¥è§‚å¯Ÿåˆ°,æŒ‰ç…§ä¸Šé¢çš„ç®—æ³•å®ç°,æˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡é€’å½’æŒ‰ç…§å¥‡å’Œå¶å°†å–æ ·åˆ†ç»„.ä¸”æ¯æ¬¡é€’å½’éƒ½ä¼šåˆ†ç»„.æ¯æ¬¡åˆ†ç»„éƒ½ä¼šæ¶‰åŠåˆ°æ•°ç»„çš„å¤åˆ¶,å¸¸æ•°è¾ƒå¤§.</p>
<p>è§‚å¯Ÿåˆ†ç»„æ“ä½œä¸­ä¸‹æ ‡çš„å˜åŒ–.</p>
<pre><code>(è¡¨ç¤ºä¸‹æ ‡)
0 1 2 3 4 5 6 7
0 2 4 6 | 1 3 5 7
0 4 | 2 6 | 1 5 | 3 7
</code></pre><p>å°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶</p>
<pre><code>000 001 010 011 100 101 110 111
000 100 010 110 001 101 011 111
</code></pre><p>å¯ä»¥å‘ç°,æœ€ç»ˆçš„åˆ†ç»„ç»“æœå°±æ˜¯å°†åŸä¸‹æ ‡äºŒè¿›åˆ¶ç¿»è½¬.æ‰€ä»¥å¯ä»¥ç›´æ¥ä¸€æ¬¡å®Œæˆåˆ†ç»„.</p>
<p>æ³¨æ„,<strong>è¿™è¦æ±‚å–æ ·ä¸º2çš„å¹‚æ¬¡</strong>.</p>
<h3 id="è´è¶æ“ä½œ">ğŸ¦‹è´è¶æ“ä½œ</h3>
<p>è§£å†³äº†é€’å½’ä¸­ç”±é¡¶è‡³åº•çš„åˆ†ç»„å,æ¥ä¸‹æ¥ä¼˜åŒ–å­é—®é¢˜åˆå¹¶æ—¶çš„æ•°ç»„å¤åˆ¶.</p>
<p>è§‚å¯ŸåŸæ¥çš„åˆå¹¶å¼å­</p>
<div>$$
\hat g(k)=\hat g_{even}(k)+\omega_{N,k} \hat g_{odd}(k) \\
\hat g(k+\frac N2)=\hat g_{even}(k)-\omega_{N,k} \hat g_{odd}(k)
$$</div>
<p>æŒ‰ç…§ç®—æ³•ä¸­çš„å®ç°æ–¹æ³•,å…¶ä¸º</p>
<div>$$
\hat g(k)=\hat g(k)+\omega_{N,k} \hat g(k+\frac N2) \\
\hat g(k+\frac N2)=\hat g(k)-\omega_{N,k} \hat g(k+\frac N2)
$$</div>
<p>æƒ³è¦çœç•¥æ•°ç»„å¤åˆ¶,è¿›è¡ŒåŸåœ°åˆå¹¶,é—®é¢˜å‡ºåœ¨æ–°æ•°å€¼å¤ªæ—©åœ°æ›¿æ¢æ‰äº†æˆ‘ä»¬éœ€è¦çš„æ•°å€¼.</p>
<p>å–è¾…åŠ©å˜é‡,ä¿®æ”¹åŸå¼</p>
<div>$$
t=\omega_{N,k} \hat g(k+\frac N2)\\
\hat g(k+\frac N2)=\hat g(k)-t\\
\hat g(k)=\hat g(k)+t
$$</div>
<p>è¿™ä¸ªæ“ä½œè¢«ç§°ä¸º&quot;è´è¶æ“ä½œ&quot;,åå­—å¾ˆæœ‰æ„æ€.</p>
<h3 id="ä»£ç ">ä»£ç </h3>
<p>åœ¨è¿™æ®µä»£ç ä¸­åŒæ—¶å»æ‰äº†é€’å½’.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">const</span> <span class="kt">double</span> <span class="n">PI</span><span class="o">=</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="kr">inline</span> <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">gomega</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span><span class="kt">bool</span> <span class="n">rev</span><span class="o">=</span><span class="nb">false</span><span class="p">){</span>
    <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">rev</span><span class="p">)</span><span class="k">return</span> <span class="n">conj</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">FFT</span><span class="p">{</span>
    <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">omega</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">omegaI</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

    <span class="n">FFT</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">gomega</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
            <span class="n">omegaI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">gomega</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">transform</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="k">const</span> <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">omega</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="n">j</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
            <span class="c1">//äºŒè¿›åˆ¶æ¢ä½
</span><span class="c1"></span>            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">;(</span><span class="n">j</span><span class="o">^=</span><span class="n">l</span><span class="p">)</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">l</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">m</span><span class="o">=</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">p</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">p</span><span class="o">!=</span><span class="n">a</span><span class="o">+</span><span class="n">n</span><span class="p">;</span><span class="n">p</span><span class="o">+=</span><span class="n">l</span><span class="p">){</span>
                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="c1">//è´è¶æ“ä½œ
</span><span class="c1"></span>                    <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">t</span><span class="o">=</span><span class="n">omega</span><span class="p">[</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">];</span>
                    <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">;</span>
                    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">t</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">dft</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">omega</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">idft</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">omegaI</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/=</span><span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæƒ³è¦å®ç°å¿«é€Ÿä¹˜æ³•,åªè¦å°†2ä¸ªå¤šé¡¹å¼çš„ç³»æ•°å‡½æ•°ä¼ å…¥è¿›è¡Œå˜æ¢,å˜æ¢ç»“æœç›¸ä¹˜å¹¶é€†å˜æ¢å³å¯.</p>
<h2 id="åº”ç”¨-1">åº”ç”¨</h2>
<h3 id="å¿«é€Ÿä¹˜æ³•-1">å¿«é€Ÿä¹˜æ³•</h3>
<p>æŒ‡å¿«é€Ÿå¤§æ•°ä¹˜æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;complex&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span><span class="o">=</span><span class="mi">300000</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">PI</span><span class="o">=</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="kr">inline</span> <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">gomega</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span><span class="kt">bool</span> <span class="n">rev</span><span class="o">=</span><span class="nb">false</span><span class="p">){</span>
    <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">));</span>
    <span class="k">if</span><span class="p">(</span><span class="n">rev</span><span class="p">)</span><span class="k">return</span> <span class="n">conj</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">struct</span> <span class="nc">FFT</span><span class="p">{</span>
    <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">omega</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="n">omegaI</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>

    <span class="n">FFT</span><span class="p">(){</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">gomega</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
            <span class="n">omegaI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">gomega</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">transform</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="k">const</span> <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">omega</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="n">j</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
            <span class="c1">//äºŒè¿›åˆ¶æ¢ä½
</span><span class="c1"></span>            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">;(</span><span class="n">j</span><span class="o">^=</span><span class="n">l</span><span class="p">)</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">l</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">l</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">m</span><span class="o">=</span><span class="n">l</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">for</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">p</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">p</span><span class="o">!=</span><span class="n">a</span><span class="o">+</span><span class="n">n</span><span class="p">;</span><span class="n">p</span><span class="o">+=</span><span class="n">l</span><span class="p">){</span>
                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
                    <span class="c1">//è´è¶æ“ä½œ
</span><span class="c1"></span>                    <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">t</span><span class="o">=</span><span class="n">omega</span><span class="p">[</span><span class="n">n</span><span class="o">/</span><span class="n">l</span><span class="o">*</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">];</span>
                    <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">;</span>
                    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">t</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">dft</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">omega</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="nf">idft</span><span class="p">(</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">omegaI</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/=</span><span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">MAXN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">ans</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
<span class="n">FFT</span> <span class="n">fft</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>

    <span class="kt">int</span> <span class="n">nlen</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">nlen</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="c1">//æ ¹æ®åŸç†ï¼Œnå¿…é¡»å–å¤§äº2nlençš„æ•°ï¼Œæ‰èƒ½æ»¡è¶³å–æ ·è¦æ±‚å’Œåè½¬æ“ä½œè¦æ±‚
</span><span class="c1"></span>    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">*</span><span class="n">nlen</span><span class="p">)</span><span class="n">n</span><span class="o">*=</span><span class="mi">2</span><span class="p">;</span>
    <span class="n">fft</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>


    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">string</span> <span class="n">inp</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">inp</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="n">inp</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">inp</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">j</span><span class="o">++</span><span class="p">,</span><span class="n">k</span><span class="o">--</span><span class="p">){</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="err">#</span><span class="mo">03</span><span class="mi">9</span><span class="p">;,</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">fft</span><span class="p">.</span><span class="n">dft</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
    <span class="n">fft</span><span class="p">.</span><span class="n">idft</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">n</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">reslen</span><span class="o">=</span><span class="n">nlen</span><span class="o">+</span><span class="n">nlen</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">reslen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">,</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">floor</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">()</span><span class="o">+</span><span class="mf">0.5</span><span class="p">);</span>
    <span class="cm">/*
</span><span class="cm">    for(int i=0;i&lt;reslen;i++)cout&lt;&lt;ans[i]&lt;&lt;&#34; &#34;;
</span><span class="cm">    cout&lt;&lt;endl;
</span><span class="cm">    */</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">MAXN</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">ptr</span><span class="o">=</span><span class="n">MAXN</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">ptr</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="n">ptr</span><span class="o">--</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">ptr</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">;</span><span class="n">ptr</span><span class="o">--</span><span class="p">)</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">[</span><span class="n">ptr</span><span class="p">];</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/study/" term="study" label="study" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
        <entry>
            <title type="text">æˆ‘æŠŠå¿«æ’å†™é”™äº†?</title>
            <link rel="alternate" type="text/html" href="https://blog.kanari.moe/gossip/do-i-write-qsort-right/" />
            <id>https://blog.kanari.moe/gossip/do-i-write-qsort-right/</id>
            <updated>2020-04-08T10:09:42+08:00</updated>
            <published>2019-07-12T14:02:52+08:00</published>
            <author>
                    <name>Kanari</name>
                    <uri>https://blog.kanari.moe/</uri>
                    <email>secret@a.b</email>
                    </author>
            
    
    <summary type="html"><![CDATA[<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n\lg n)$çš„ã€‚ç„¶è€Œå› ä¸ºæˆ‘å¤ªèœï¼Œå†™å‡ºæ¥çš„å¿«é€Ÿæ’åºä¸€ä¸å°å¿ƒå°±æˆäº†$O(n^2)$...</p>â€¦â€¦]]></summary>
            
                <content type="html"><![CDATA[<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(n\lg n)$çš„ã€‚ç„¶è€Œå› ä¸ºæˆ‘å¤ªèœï¼Œå†™å‡ºæ¥çš„å¿«é€Ÿæ’åºä¸€ä¸å°å¿ƒå°±æˆäº†$O(n^2)$...</p>
<h2 id="è¿™ä¸ªè¾£é¸¡é—®é¢˜">è¿™ä¸ªè¾£é¸¡é—®é¢˜</h2>
<p>è¿™ä¸ªåº”è¯¥éƒ½çŸ¥é“ï¼Œå½“å¾…æ’åºæ•°ç»„å·²ç»æœ‰åºæ—¶ï¼Œå›ºå®šé€‰æ‹©æŸä¸€ä¸ªä½ç½®çš„æ•°å­—å½“å“¨å…µçš„å¿«æ’ä¼šå˜æˆ$O(n^2)$ã€‚ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯éšæœºé€‰æ‹©å“¨å…µï¼Œæˆ–è€…å¹²è„†å°†è¾“å…¥çš„æ•°ç»„æ‰“ä¹±åå†æ’åºã€‚</p>
<p>ç„¶è€Œï¼Œå¦‚æœè¾“å…¥çš„æ•°ç»„æ•°å­—å…¨éƒ¨ç›¸åŒå‘¢ï¼Ÿ</p>
<p>å½“ç„¶è¿™åœ¨å®é™…ä¸­å¾ˆå°‘è§ï¼Œä½†æ˜¯åœ¨å®ç°çš„æ—¶å€™å°±è¦å°å¿ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€å®ç°çš„å¿«æ’å¿…é¡»å¯¹äºç›¸åŒæ•°å­—ä¹Ÿäº¤æ¢ä½ç½®ï¼Œå¦åˆ™å°±ä¼šé€€åŒ–ä¸º$O(n^2)$ã€‚</p>
<p>æ¯”å¦‚è¯´ï¼Œè¿™ä¸ª</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp">    <span class="kt">void</span> <span class="nf">quicksort</span><span class="p">(</span><span class="kt">int</span> <span class="n">left</span><span class="p">,</span><span class="kt">int</span> <span class="n">right</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">temp</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">left</span><span class="o">&gt;</span><span class="n">right</span><span class="p">)</span>
       <span class="k">return</span><span class="p">;</span>

    <span class="n">temp</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">left</span><span class="p">];</span> <span class="c1">//tempä¸­å­˜çš„å°±æ˜¯åŸºå‡†æ•°
</span><span class="c1"></span>    <span class="n">i</span><span class="o">=</span><span class="n">left</span><span class="p">;</span>
    <span class="n">j</span><span class="o">=</span><span class="n">right</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span><span class="o">!=</span><span class="n">j</span><span class="p">)</span>
    <span class="p">{</span>
       <span class="c1">//é¡ºåºå¾ˆé‡è¦ï¼Œè¦å…ˆä»å³è¾¹å¼€å§‹æ‰¾
</span><span class="c1"></span>       <span class="k">while</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">temp</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">)</span>
    <span class="n">j</span><span class="o">--</span><span class="p">;</span>
       <span class="c1">//å†æ‰¾å³è¾¹çš„
</span><span class="c1"></span>       <span class="k">while</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">temp</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">)</span>
    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
       <span class="c1">//äº¤æ¢ä¸¤ä¸ªæ•°åœ¨æ•°ç»„ä¸­çš„ä½ç½®
</span><span class="c1"></span>       <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">)</span>
       <span class="p">{</span>
    <span class="n">t</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">t</span><span class="p">;</span>
       <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">//æœ€ç»ˆå°†åŸºå‡†æ•°å½’ä½
</span><span class="c1"></span>    <span class="n">a</span><span class="p">[</span><span class="n">left</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">temp</span><span class="p">;</span>

    <span class="n">quicksort</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="c1">//ç»§ç»­å¤„ç†å·¦è¾¹çš„ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹
</span><span class="c1"></span>    <span class="n">quicksort</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">right</span><span class="p">);</span><span class="c1">//ç»§ç»­å¤„ç†å³è¾¹çš„ ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹
</span><span class="c1"></span>    <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿˜æœ‰è¿™ä¸ªï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="nf">quick_sort</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">[],</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span>
    <span class="p">{</span>
		<span class="c1">//Swap(s[l], s[(l + r) / 2]); //å°†ä¸­é—´çš„è¿™ä¸ªæ•°å’Œç¬¬ä¸€ä¸ªæ•°äº¤æ¢ å‚è§æ³¨1
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">r</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">];</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// ä»å³å‘å·¦æ‰¾ç¬¬ä¸€ä¸ªå°äºxçš„æ•°
</span><span class="c1"></span>				<span class="n">j</span><span class="o">--</span><span class="p">;</span>  
            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span> 
				<span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
			
            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// ä»å·¦å‘å³æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºxçš„æ•°
</span><span class="c1"></span>				<span class="n">i</span><span class="o">++</span><span class="p">;</span>  
            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span> 
				<span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">quick_sort</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// é€’å½’è°ƒç”¨ 
</span><span class="c1"></span>        <span class="n">quick_sort</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>å®ƒä»¬éƒ½ä¼šè·³è¿‡ç›¸åŒçš„æ•°å­—ï¼Œæ¯æ¬¡æ’åºåå“¨å…µæ€»ä¼šåœ¨è¾¹ç•Œä¸Šï¼Œå¯¼è‡´ç®—æ³•åŠ£åŒ–åˆ°$O(n^2)$ã€‚</p>
<p>å¤§æ¦‚å°±æ˜¯è¿™å›äº‹ï¼Œæ²¡åˆ«çš„äº†ã€‚è¿™ç§æƒ…å†µå½“ç„¶æœ‰æ”¹è¿›çš„å¿«é€Ÿæ’åºå¯ä»¥ç›´æ¥é¿å…è¿™ç§ç½•è§çš„æƒ…å†µï¼Œåœ¨ä¸å¤§å¹…åº¦æ”¹åŠ¨ç®—æ³•çš„å‰æä¸‹ï¼Œå°±è¦å¯¹ç›¸åŒçš„å…ƒç´ ä¹Ÿè¿›è¡Œæ¢ä½æ‰å¯ä»¥ï¼Œå³ä½¿ä¼šå¢åŠ äº¤æ¢æ¬¡æ•°ã€‚</p>]]></content>
            
            
            
                
                
                
                    
                    
                    
                        
                            <category scheme="https://blog.kanari.moe/gossip/" term="gossip" label="gossip" />
                        
                    
                
            
            
            
                
                    
                
            
        </entry>
    
</feed>
